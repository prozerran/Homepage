<pre style='color:#000020;background:#f6f8ff;'><span style='color:#200080; font-weight:bold; '>package</span><span style='color:#004a43; '> com</span><span style='color:#308080; '>.</span><span style='color:#004a43; '>sp</span><span style='color:#308080; '>.</span><span style='color:#004a43; '>app</span><span style='color:#406080; '>;</span>

<span style='color:#200080; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#308080; '>.</span><span style='color:#004a43; '>sql</span><span style='color:#308080; '>.</span><span style='color:#200080; font-weight:bold; '>*</span><span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>import</span><span style='color:#004a43; '> java</span><span style='color:#308080; '>.</span><span style='color:#004a43; '>text</span><span style='color:#308080; '>.</span><span style='color:#004a43; '>ParseException</span><span style='color:#406080; '>;</span>

<span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> DBImporter <span style='color:#406080; '>{</span>	
	
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>Connection</span> conn <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>	
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>PreparedStatement</span> ps_s <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>	<span style='color:#595979; '>// chartdata_second [5s]</span>
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>PreparedStatement</span> ps_t <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>	<span style='color:#595979; '>// chartdata_ticker</span>
	
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>String</span> driver <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>String</span> url <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>String</span> user <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#6679aa; font-weight:bold; '>String</span> pass <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
    
    DBImporter<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
    	<span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>    		
    		<span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>driver <span style='color:#308080; '>=</span> SPConfig<span style='color:#308080; '>.</span>getInstance<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>GetProperty<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"spring.datasource.driver"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    		<span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>url <span style='color:#308080; '>=</span> SPConfig<span style='color:#308080; '>.</span>getInstance<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>GetProperty<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"spring.datasource.url"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    		<span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>user <span style='color:#308080; '>=</span> SPConfig<span style='color:#308080; '>.</span>getInstance<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>GetProperty<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"spring.datasource.username"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    		<span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>pass <span style='color:#308080; '>=</span> SPConfig<span style='color:#308080; '>.</span>getInstance<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>GetProperty<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"spring.datasource.password"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>     		
    		
			<span style='color:#6679aa; font-weight:bold; '>Class</span><span style='color:#308080; '>.</span>forName<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>driver<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>ClassNotFoundException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>	   	    	   
    <span style='color:#406080; '>}</span>
	
	<span style='color:#7779bb; '>boolean</span> Connect<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
		<span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>									
			<span style='color:#6679aa; font-weight:bold; '>DriverManager</span><span style='color:#308080; '>.</span>setLoginTimeout<span style='color:#308080; '>(</span><span style='color:#008c00; '>10</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>			
			conn <span style='color:#308080; '>=</span> <span style='color:#6679aa; font-weight:bold; '>DriverManager</span><span style='color:#308080; '>.</span>getConnection<span style='color:#308080; '>(</span>url<span style='color:#308080; '>,</span> user<span style='color:#308080; '>,</span> pass<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>					
			<span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>PrepareStatements<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>SQLException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>		
		<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span>conn <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> <span style='color:#308080; '>?</span> <span style='color:#200080; font-weight:bold; '>true</span> <span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	<span style='color:#406080; '>}</span>
	
	<span style='color:#7779bb; '>boolean</span> IsConnected<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>		
		<span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>
			<span style='color:#200080; font-weight:bold; '>return</span> conn<span style='color:#308080; '>.</span>isValid<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>SQLException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>
		<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
	<span style='color:#406080; '>}</span>
	
	<span style='color:#7779bb; '>boolean</span> Close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
		<span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>			
			ps_s<span style='color:#308080; '>.</span>close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			ps_t<span style='color:#308080; '>.</span>close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			
			conn<span style='color:#308080; '>.</span>close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>SQLException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>
		<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
	<span style='color:#406080; '>}</span>
	
	<span style='color:#595979; '>// prepare statement separately before inserts for efficiency</span>
	<span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#7779bb; '>void</span> PrepareStatements<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>throws</span> <span style='color:#6679aa; font-weight:bold; '>SQLException</span> <span style='color:#406080; '>{</span>
    	<span style='color:#595979; '>// prepare chartdata sql</span>
        <span style='color:#6679aa; font-weight:bold; '>String</span> sql_c <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>"REPLACE INTO chartdata_second "</span>
      		<span style='color:#308080; '>+</span> <span style='color:#1060b6; '>" (rec_id, mkt_datetime, prod_code, open, high, low, close, prev_close, qty, turnover, instmnt_code) "</span>
      		<span style='color:#308080; '>+</span> <span style='color:#1060b6; '>" VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"</span><span style='color:#406080; '>;</span>        
        ps_s <span style='color:#308080; '>=</span> conn<span style='color:#308080; '>.</span>prepareStatement<span style='color:#308080; '>(</span>sql_c<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> 
        
        <span style='color:#595979; '>// prepare ticker sql</span>
        <span style='color:#6679aa; font-weight:bold; '>String</span> sql_t <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>"REPLACE INTO chartdata_ticker (rec_id, mkt_datetime, prod_code, price, qty, deal_src, side) "</span>
        	<span style='color:#308080; '>+</span> <span style='color:#1060b6; '>" VALUES (?, ?, ?, ?, ?, ?, ?)"</span><span style='color:#406080; '>;</span>
	 	ps_t <span style='color:#308080; '>=</span> conn<span style='color:#308080; '>.</span>prepareStatement<span style='color:#308080; '>(</span>sql_t<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> 		 	
	<span style='color:#406080; '>}</span>
	
	<span style='color:#7779bb; '>boolean</span> InsertTickerData<span style='color:#308080; '>(</span><span style='color:#7779bb; '>long</span> rec_id<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> date<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> time<span style='color:#308080; '>,</span> <span style='color:#6679aa; font-weight:bold; '>String</span> prodcode<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>double</span> price<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> qty<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> deal_src<span style='color:#308080; '>,</span> <span style='color:#6679aa; font-weight:bold; '>String</span> side<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>		     
      <span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>       	     	      	     
          <span style='color:#595979; '>// prepare statement	      </span>
	      ps_t<span style='color:#308080; '>.</span>clearParameters<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setLong<span style='color:#308080; '>(</span><span style='color:#008c00; '>1</span><span style='color:#308080; '>,</span> rec_id<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setTimestamp<span style='color:#308080; '>(</span><span style='color:#008c00; '>2</span><span style='color:#308080; '>,</span> SPCommon<span style='color:#308080; '>.</span>GetTimeStamp<span style='color:#308080; '>(</span>date<span style='color:#308080; '>,</span> time<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setString<span style='color:#308080; '>(</span><span style='color:#008c00; '>3</span><span style='color:#308080; '>,</span> prodcode<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>     
	      ps_t<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>4</span><span style='color:#308080; '>,</span> price<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setInt<span style='color:#308080; '>(</span><span style='color:#008c00; '>5</span><span style='color:#308080; '>,</span> qty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setInt<span style='color:#308080; '>(</span><span style='color:#008c00; '>6</span><span style='color:#308080; '>,</span> deal_src<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>setString<span style='color:#308080; '>(</span><span style='color:#008c00; '>7</span><span style='color:#308080; '>,</span> side<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_t<span style='color:#308080; '>.</span>execute<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      	      
	      <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>	      
	      
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>SQLException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>			
			<span style='color:#6679aa; font-weight:bold; '>String</span> msg <span style='color:#308080; '>=</span> e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>			
			<span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>msg<span style='color:#308080; '>.</span>contains<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"Duplicate entry"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>				
				<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>msg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>ParseException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>
	<span style='color:#406080; '>}</span>	
	
	<span style='color:#7779bb; '>boolean</span> InsertChartSecond<span style='color:#308080; '>(</span><span style='color:#7779bb; '>long</span> rec_id<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> date<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> time<span style='color:#308080; '>,</span> <span style='color:#6679aa; font-weight:bold; '>String</span> prodcode<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>double</span> open<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>double</span> high<span style='color:#308080; '>,</span> 
			<span style='color:#7779bb; '>double</span> low<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>double</span> close<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>double</span> prev_close<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>int</span> qty<span style='color:#308080; '>,</span> <span style='color:#7779bb; '>long</span> turnover<span style='color:#308080; '>,</span> <span style='color:#6679aa; font-weight:bold; '>String</span> instmnt_code<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>			           
      <span style='color:#200080; font-weight:bold; '>try</span> <span style='color:#406080; '>{</span>   
          <span style='color:#595979; '>// prepare statement	   </span>
    	  ps_s<span style='color:#308080; '>.</span>clearParameters<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    	  ps_s<span style='color:#308080; '>.</span>setLong<span style='color:#308080; '>(</span><span style='color:#008c00; '>1</span><span style='color:#308080; '>,</span> rec_id<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>    	  
    	  ps_s<span style='color:#308080; '>.</span>setTimestamp<span style='color:#308080; '>(</span><span style='color:#008c00; '>2</span><span style='color:#308080; '>,</span> SPCommon<span style='color:#308080; '>.</span>GetTimeStamp<span style='color:#308080; '>(</span>date<span style='color:#308080; '>,</span> time<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    	  ps_s<span style='color:#308080; '>.</span>setString<span style='color:#308080; '>(</span><span style='color:#008c00; '>3</span><span style='color:#308080; '>,</span> prodcode<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>     
    	  ps_s<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>4</span><span style='color:#308080; '>,</span> open<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    	  ps_s<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>5</span><span style='color:#308080; '>,</span> high<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
    	  ps_s<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>6</span><span style='color:#308080; '>,</span> low<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_s<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>7</span><span style='color:#308080; '>,</span> close<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_s<span style='color:#308080; '>.</span>setDouble<span style='color:#308080; '>(</span><span style='color:#008c00; '>8</span><span style='color:#308080; '>,</span> prev_close<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>	     	     
	      ps_s<span style='color:#308080; '>.</span>setInt<span style='color:#308080; '>(</span><span style='color:#008c00; '>9</span><span style='color:#308080; '>,</span> qty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_s<span style='color:#308080; '>.</span>setLong<span style='color:#308080; '>(</span><span style='color:#008c00; '>10</span><span style='color:#308080; '>,</span> turnover<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      ps_s<span style='color:#308080; '>.</span>setString<span style='color:#308080; '>(</span><span style='color:#008c00; '>11</span><span style='color:#308080; '>,</span> instmnt_code<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>   	      
	      ps_s<span style='color:#308080; '>.</span>execute<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
	      
	      <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>	      
	      
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>SQLException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>			
			<span style='color:#6679aa; font-weight:bold; '>String</span> msg <span style='color:#308080; '>=</span> e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>			
			<span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>msg<span style='color:#308080; '>.</span>contains<span style='color:#308080; '>(</span><span style='color:#1060b6; '>"Duplicate entry"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>				
				<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>msg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span> <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span><span style='color:#6679aa; font-weight:bold; '>ParseException</span> e<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span>
			<span style='color:#6679aa; font-weight:bold; '>System</span><span style='color:#308080; '>.</span>err<span style='color:#308080; '>.</span>println<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>getMessage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
			<span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
		<span style='color:#406080; '>}</span>
	<span style='color:#406080; '>}</span>
<span style='color:#406080; '>}</span>

</pre>
<!--Created using ToHtml.com on 2021-06-08 06:45:36 UTC -->