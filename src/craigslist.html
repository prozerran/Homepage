<pre style='color:#000000;background:#f1f0f0;'><span style='color:#c34e00; '>#!</span><span style='color:#007997; '>/bin/ksh</span>
<span style='color:#c34e00; '>#</span>
<span style='color:#c34e00; '># CLPOST is a ksh script that performs various Craigslist posting functions.</span>
<span style='color:#c34e00; '># Minimally, it can add or remove postings from the Craigslist website at</span>
<span style='color:#c34e00; '># </span><span style='color:#5555dd; '>http://www.craigslist.org/</span><span style='color:#c34e00; '>. This script is created to automate the proccess</span>
<span style='color:#c34e00; '># and makes life easier for Craigslist postings.</span>
<span style='color:#c34e00; '>#</span>
<span style='color:#c34e00; '># IDEAL STEPS TO POST ON CRAIGSLIST</span>
<span style='color:#c34e00; '># 1. Post the messages using the interface  @ </span><span style='color:#5555dd; '>http://name.domain.org/cl/</span>
<span style='color:#c34e00; '># 2. When CL email arrive, use the command: $ clpost -a</span>
<span style='color:#c34e00; '># 3. Check that posts have been published : $ clpost -p</span>
<span style='color:#c34e00; '># 4. Finally, remove the postings from CL : $ clpost -d</span>
<span style='color:#c34e00; '># 5. Repeat.</span>
<span style='color:#c34e00; '>#</span>
<span style='color:#c34e00; '># Copyright (c) Yee Hsu 2004. All rights reserved.</span>
<span style='color:#c34e00; '># ===========================================================================</span>

<span style='color:#c34e00; '># some global variables</span>
CLURL<span style='color:#806030; '>=</span><span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org</span><span style='color:#e60000; '>"</span>                       <span style='color:#c34e00; '># Craigslist URL</span>
TEMP<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#40015a; '>/tmp</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.tmp_cle"</span>                                    <span style='color:#c34e00; '># temporary CL file</span>
CLE<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL/cl_url</span><span style='color:#e60000; '>"</span>                               <span style='color:#c34e00; '># temporary CL file</span>
RESUME<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/private/Job/resume.htm</span><span style='color:#e60000; '>"</span>                   <span style='color:#c34e00; '># resume path</span>
PHPPROG<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL/EHTML/htmlemail.php</span><span style='color:#e60000; '>"</span>              <span style='color:#c34e00; '># PHP program path</span>
FROM<span style='color:#806030; '>=</span><span style='color:#e60000; '>"name@domain.org"</span>                                  <span style='color:#c34e00; '># reply address</span>

<span style='color:#c34e00; '># HEADER</span>
<span style='color:#c34e00; '># header displays the header information</span>
<span style='color:#c34e00; '># ===========================================================================</span>

header<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
        <span style='color:#40015a; '>/usr/bin/clear</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"CLPOST is a script to perform various Craigslist posting functions.</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"This script is compatible with the site </span><span style='color:#e60000; '>$CLURL</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"Copyright (c) Yee Hsu 2004. All rights reserved.</span><span style='color:#0f6900; '>\n</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># USAGE</span>
<span style='color:#c34e00; '># usage displays the usage information to the user</span>
<span style='color:#c34e00; '># ===========================================================================</span>

usage<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
        header<span style='color:#806030; '>;</span>         <span style='color:#c34e00; '># display header information</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"Usage: clpost [-option]</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;options></span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>-a</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>add and publish the CL posts</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>-p</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>display posts that is published</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>-d</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>delete all CL posts</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>-m</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>logs CL metrics in XML</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>-r</span><span style='color:#0f6900; '>\t</span><span style='color:#e60000; '>auto send resumes to CL job postings</span><span style='color:#0f6900; '>\n</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># ADDPOST</span>
<span style='color:#c34e00; '># addpost is a function that adds and publishes the postings from Craigslist.</span>
<span style='color:#c34e00; '># ===========================================================================</span>

addpost<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
TEMP1<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.cl_tmp1"</span>                           <span style='color:#c34e00; '># temporary CL file</span>
TEMP2<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.cl_tmp2"</span>                           <span style='color:#c34e00; '># temporary CL file</span>

header<span style='color:#806030; '>;</span>         <span style='color:#c34e00; '># display header information</span>
grep <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLURL</span><span style='color:#e60000; '>"</span> <span style='color:#40015a; '>/mail</span><span style='color:#40015a; '>/</span>$USER <span style='color:#e34adc; '>|</span> grep <span style='color:#44aadd; '>-v</span> <span style='color:#e60000; '>"&lt;br>"</span> <span style='color:#e34adc; '>></span> $TEMP1     <span style='color:#c34e00; '># extract posting URLs</span>

<span style='color:#c34e00; '># Test that file exist and size > 0</span>
<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ ! </span><span style='color:#806030; '>-</span><span style='color:#e60000; '>s "$TEMP1" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>
        <span style='color:#40015a; '>/bin/rm</span> <span style='color:#44aadd; '>-f</span> $TEMP1
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"No CL postings needed to be added."</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

<span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#bb7977; font-weight:bold; '>read</span> LINE
<span style='color:#400000; font-weight:bold; '>do</span>
        <span style='color:#c34e00; '># Compose the Craigslist URL Query String</span>
        URL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$LINE</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#e60000; background:#ffffe8; '>'{print $1}'</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># URL</span>
        POSTINGID<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$URL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#40015a; background:#ffffe8; '>/</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $6}'</span><span style='color:#000000; background:#ffffe8; '>`</span>    <span style='color:#c34e00; '># posting ID</span>
        CHECK<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$URL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#40015a; background:#ffffe8; '>/</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $7}'</span><span style='color:#000000; background:#ffffe8; '>`</span>        <span style='color:#c34e00; '># check ID</span>

        <span style='color:#c34e00; '># Concatenate the URL string and perform a HTTP GET request</span>
        <span style='color:#c34e00; '># The result is the post will be added to Craigslist</span>
        POSTURL<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLURL</span><span style='color:#40015a; '>/cgi-bin/smp</span><span style='color:#e60000; '>?</span><span style='color:#e60000; '>postingID</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>$POSTINGID</span><span style='color:#e60000; '>&amp;</span><span style='color:#e60000; '>check</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>$CHECK</span><span style='color:#e60000; '>&amp;</span><span style='color:#e60000; '>button</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>publish"</span>
        <span style='color:#40015a; '>/usr/pkg/bin/wget</span> -q <span style='color:#44aadd; '>-O</span> $TEMP <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$POSTURL</span><span style='color:#e60000; '>"</span>        <span style='color:#c34e00; '># CL HIT</span>

        <span style='color:#c34e00; '># The result above returns a *.html page, now extract the subject</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>grep</span><span style='color:#e60000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#e60000; background:#ffffe8; '>&lt;h2></span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$TEMP</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># select the subject line</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#e60000; '>"${SUBJECT#????????????}"</span>       <span style='color:#c34e00; '># shift >> 12</span>
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"POSTED: </span><span style='color:#e60000; '>$SUBJECT</span><span style='color:#e60000; '>"</span>            <span style='color:#c34e00; '># display subject</span>

        <span style='color:#40015a; '>/bin/cat</span> <span style='color:#40015a; '>/dev/null</span> <span style='color:#e34adc; '>></span> $TEMP              <span style='color:#c34e00; '># flush the temporary file</span>
<span style='color:#400000; font-weight:bold; '>done</span> <span style='color:#e34adc; '>&lt;</span> $TEMP1

<span style='color:#40015a; '>/bin/cat</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLE</span><span style='color:#e60000; '>"</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$TEMP1</span><span style='color:#e60000; '>"</span> <span style='color:#e34adc; '>></span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$TEMP2</span><span style='color:#e60000; '>"</span>             <span style='color:#c34e00; '># concatenate the CL files</span>
<span style='color:#40015a; '>/bin/mv</span> <span style='color:#44aadd; '>-f</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$TEMP2</span><span style='color:#e60000; '>"</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLE</span><span style='color:#e60000; '>"</span>                      <span style='color:#c34e00; '># rename it back</span>
<span style='color:#40015a; '>/bin/rm</span> <span style='color:#44aadd; '>-f</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$TEMP1</span><span style='color:#e60000; '>"</span>                             <span style='color:#c34e00; '># remove temporary CL file</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># DISPOST</span>
<span style='color:#c34e00; '># dispost is a function that display the postings from Craigslist.</span>
<span style='color:#c34e00; '># ===========================================================================</span>

dispost<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
header<span style='color:#806030; '>;</span>         <span style='color:#c34e00; '># display header information</span>

<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ ! </span><span style='color:#806030; '>-</span><span style='color:#e60000; '>s "$CLE" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>             <span style='color:#c34e00; '># Test that file exist and size > 0</span>
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"No posting on Craigslist at this time."</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

<span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#bb7977; font-weight:bold; '>read</span> LINE
<span style='color:#400000; font-weight:bold; '>do</span>
        <span style='color:#c34e00; '># Get the URL of the post and perform an HTTP GET request</span>
        URL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$LINE</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#e60000; background:#ffffe8; '>'{print $1}'</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># URL</span>
        <span style='color:#40015a; '>/usr/pkg/bin/wget</span> -q <span style='color:#44aadd; '>-O</span> $TEMP <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$URL</span><span style='color:#e60000; '>"</span>            <span style='color:#c34e00; '># CL HIT</span>

        <span style='color:#c34e00; '># The result above returns a *.html page, now extract the subject</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>grep</span><span style='color:#e60000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#e60000; background:#ffffe8; '>&lt;h2></span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$TEMP</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># select the subject line</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#e60000; '>"${SUBJECT#????????????}"</span>       <span style='color:#c34e00; '># shift >> 12</span>
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"PUBLISHED: </span><span style='color:#e60000; '>$SUBJECT</span><span style='color:#e60000; '>"</span>         <span style='color:#c34e00; '># display subject</span>

        <span style='color:#40015a; '>/bin/cat</span> <span style='color:#40015a; '>/dev/null</span> <span style='color:#e34adc; '>></span> $TEMP      <span style='color:#c34e00; '># flush the temporary file</span>
<span style='color:#400000; font-weight:bold; '>done</span> <span style='color:#e34adc; '>&lt;</span> $CLE
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># RMPOST</span>
<span style='color:#c34e00; '># rmpost is a function that removes the postings from Craigslist.</span>
<span style='color:#c34e00; '># ===========================================================================</span>

rmpost<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
header<span style='color:#806030; '>;</span>         <span style='color:#c34e00; '># display header information</span>

<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ ! </span><span style='color:#806030; '>-</span><span style='color:#e60000; '>s "$CLE" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>             <span style='color:#c34e00; '># Test that file exist and size > 0</span>
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"All CL postings have been removed."</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

<span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#bb7977; font-weight:bold; '>read</span> LINE
<span style='color:#400000; font-weight:bold; '>do</span>
        <span style='color:#c34e00; '># Compose the Craigslist URL Query String</span>
        URL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$LINE</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#e60000; background:#ffffe8; '>'{print $1}'</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># URL</span>
        POSTINGID<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$URL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#40015a; background:#ffffe8; '>/</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $6}'</span><span style='color:#000000; background:#ffffe8; '>`</span>    <span style='color:#c34e00; '># posting ID</span>
        CHECK<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$URL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#40015a; background:#ffffe8; '>/</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $7}'</span><span style='color:#000000; background:#ffffe8; '>`</span>        <span style='color:#c34e00; '># check ID</span>

        <span style='color:#c34e00; '># Concatenate the URL string and perform a HTTP GET request</span>
        <span style='color:#c34e00; '># The result is the post will be removed from Craigslist</span>
        POSTURL<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLURL</span><span style='color:#40015a; '>/cgi-bin/smp</span><span style='color:#e60000; '>?</span><span style='color:#e60000; '>postingID</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>$POSTINGID</span><span style='color:#e60000; '>&amp;</span><span style='color:#e60000; '>check</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>$CHECK</span><span style='color:#e60000; '>&amp;</span><span style='color:#e60000; '>button</span><span style='color:#806030; '>=</span><span style='color:#e60000; '>delete"</span>
        <span style='color:#40015a; '>/usr/pkg/bin/wget</span> -q <span style='color:#44aadd; '>-O</span> $TEMP <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$POSTURL</span><span style='color:#e60000; '>"</span>        <span style='color:#c34e00; '># CL HIT</span>

        <span style='color:#c34e00; '># The result above returns a *.html page, now extract the subject</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>grep</span><span style='color:#e60000; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#e60000; background:#ffffe8; '>Your posting</span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$TEMP</span><span style='color:#000000; background:#ffffe8; '>`</span>             <span style='color:#c34e00; '># extract title</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$SUBJECT</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#0f6900; background:#ffffe8; '>\"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $2}'</span><span style='color:#000000; background:#ffffe8; '>`</span> <span style='color:#c34e00; '># extract subject</span>
        <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"DELETED: </span><span style='color:#e60000; '>$SUBJECT</span><span style='color:#e60000; '>"</span>                   <span style='color:#c34e00; '># display subject</span>

        <span style='color:#40015a; '>/bin/cat</span> <span style='color:#40015a; '>/dev/null</span> <span style='color:#e34adc; '>></span> $TEMP              <span style='color:#c34e00; '># flush the temporary file</span>
<span style='color:#400000; font-weight:bold; '>done</span> <span style='color:#e34adc; '>&lt;</span> $CLE

<span style='color:#40015a; '>/bin/cat</span> <span style='color:#40015a; '>/dev/null</span> <span style='color:#e34adc; '>></span> $CLE                       <span style='color:#c34e00; '># flush the local CL URL file</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># CLMETRICS</span>
<span style='color:#c34e00; '># clmetrics reads the web server log files and extracts information on</span>
<span style='color:#c34e00; '># Craigslist hits and visits. The information is stored in an XML file</span>
<span style='color:#c34e00; '># which would be presented using an XSL document.</span>
<span style='color:#c34e00; '># This function should be called once a day and preferably automated by</span>
<span style='color:#c34e00; '># a cron job. The results can be seen @ </span><span style='color:#5555dd; '>http://yeehsu.freeshell.org/cl/</span>
<span style='color:#c34e00; '># ===========================================================================</span>

clmetrics<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
CLLOGDATE<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL/cldate.log</span><span style='color:#e60000; '>"</span>             <span style='color:#c34e00; '># serves as a LOCK file</span>
CLLOGTEMP<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL/cltemp.log</span><span style='color:#e60000; '>"</span>             <span style='color:#c34e00; '># temporary XML file</span>
CLXMLFILE<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/public_html/cl/clmetrics.xml</span><span style='color:#e60000; '>"</span>  <span style='color:#c34e00; '># public XML file</span>
ACCESSLOG<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#40015a; '>/sys/httplogs/ukato-accesslog.o</span><span style='color:#e60000; '>"</span>     <span style='color:#c34e00; '># web server access log</span>
DATE<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`date </span><span style='color:#e60000; background:#ffffe8; '>'+%m/%d/%y'</span><span style='color:#000000; background:#ffffe8; '>`</span>                         <span style='color:#c34e00; '># return date in: "MM/DD/YY"</span>

<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ `cat $CLLOGDATE` = $DATE </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>        <span style='color:#c34e00; '># measure to make sure function</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>                                 <span style='color:#c34e00; '># is executed at most once</span>
<span style='color:#400000; font-weight:bold; '>fi</span>                                              <span style='color:#c34e00; '># a day by comparing lockfiles</span>

<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ ! </span><span style='color:#806030; '>-</span><span style='color:#e60000; '>f "$ACCESSLOG" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>               <span style='color:#c34e00; '># acccess log does not exist</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>                                 <span style='color:#c34e00; '># thus, exit</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

<span style='color:#c34e00; '># Access the logfiles and returns the HIT counts of the following pages/files.</span>
HITS01<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"normal.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS02<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"bald.gif"</span><span style='color:#000000; background:#ffffe8; '>    </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS03<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"gothic.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS04<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"date.gif"</span><span style='color:#000000; background:#ffffe8; '>    </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS05<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"friend.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS06<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"tvb.gif"</span><span style='color:#000000; background:#ffffe8; '>     </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS07<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"hiking.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS08<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"buylist.gif"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS09<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"sex.gif"</span><span style='color:#000000; background:#ffffe8; '>     </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS10<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"gfexp.gif"</span><span style='color:#000000; background:#ffffe8; '>   </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS11<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"resume.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS12<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"contract.gif"</span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>
HITS13<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`grep </span><span style='color:#000000; background:#ffffe8; '>$USER</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$ACCESSLOG</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"hacker.gif"</span><span style='color:#000000; background:#ffffe8; '>  </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l`</span>

<span style='color:#c34e00; '># Create an XML file to store the data of hit counts which will be presented</span>
<span style='color:#c34e00; '># with a corresponding XSL file. The results can be seen at the site:</span>
<span style='color:#c34e00; '># </span><span style='color:#5555dd; '>http://yeehsu.freeshell.org/cl/</span>
<span style='color:#c34e00; '># ############# BEGIN XML FILE                  ###########################</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;?xml </span><span style='color:#e60000; '>version</span><span style='color:#806030; '>=</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '>1.0</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '> </span><span style='color:#e60000; '>encoding</span><span style='color:#806030; '>=</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '>ISO-8859-1</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '>?></span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span> <span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;?xml-stylesheet </span><span style='color:#e60000; '>type</span><span style='color:#806030; '>=</span><span style='color:#0f6900; '>\"</span><span style='color:#40015a; '>text/xsl</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '> </span><span style='color:#e60000; '>href</span><span style='color:#806030; '>=</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '>clmetrics.xsl</span><span style='color:#0f6900; '>\"</span><span style='color:#e60000; '>?></span><span style='color:#0f6900; '>\n</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span> <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;clmetrics></span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>                 <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;record>"</span>                      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># REC element</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;date></span><span style='color:#e60000; '>$DATE</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/date</span><span style='color:#e60000; '>>"</span>            <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># date</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits01></span><span style='color:#e60000; '>$HITS01</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits01</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># all HITs</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits02></span><span style='color:#e60000; '>$HITS02</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits02</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits03></span><span style='color:#e60000; '>$HITS03</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits03</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits04></span><span style='color:#e60000; '>$HITS04</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits04</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits05></span><span style='color:#e60000; '>$HITS05</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits05</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits06></span><span style='color:#e60000; '>$HITS06</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits06</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits07></span><span style='color:#e60000; '>$HITS07</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits07</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits08></span><span style='color:#e60000; '>$HITS08</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits08</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits09></span><span style='color:#e60000; '>$HITS09</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits09</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits10></span><span style='color:#e60000; '>$HITS10</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits10</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits11></span><span style='color:#e60000; '>$HITS11</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits11</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits12></span><span style='color:#e60000; '>$HITS12</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits12</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;hits13></span><span style='color:#e60000; '>$HITS13</span><span style='color:#e60000; '>&lt;</span><span style='color:#40015a; '>/hits13</span><span style='color:#e60000; '>>"</span>      <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;</span><span style='color:#40015a; '>/record</span><span style='color:#e60000; '>></span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>                   <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># end REC</span>
<span style='color:#40015a; '>/usr/bin/grep</span>   <span style='color:#e60000; '>"&lt;record>"</span> $CLXMLFILE           <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># old records</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"&lt;</span><span style='color:#40015a; '>/clmetrics</span><span style='color:#e60000; '>></span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>                <span style='color:#e34adc; '>></span><span style='color:#e34adc; '>></span> $CLLOGTEMP   <span style='color:#c34e00; '># end XML file</span>

<span style='color:#40015a; '>/bin/mv</span> <span style='color:#44aadd; '>-f</span> $CLLOGTEMP $CLXMLFILE                <span style='color:#c34e00; '># replace temp XML to public</span>
<span style='color:#40015a; '>/bin/chmod</span> <span style='color:#c00000; '>0644</span> $CLXMLFILE                      <span style='color:#c34e00; '># give web access permission</span>
<span style='color:#40015a; '>/bin/echo</span> $DATE <span style='color:#e34adc; '>></span> $CLLOGDATE                    <span style='color:#c34e00; '># update lockfile</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># RESUME</span>
<span style='color:#c34e00; '># resume is a function that auto sends my resume to CL job postings.</span>
<span style='color:#c34e00; '># this function should be used SPARINGLY since i usually send resume manually</span>
<span style='color:#c34e00; '># this is the resume DRIVER</span>
<span style='color:#c34e00; '># ===========================================================================</span>

resume<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
header<span style='color:#806030; '>;</span>         <span style='color:#c34e00; '># display header information</span>

<span style='color:#c34e00; '># Precautious measure to prevent accidental spamming of resume.</span>
<span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"Are you sure you want to send resume to ALL Craigslist jobs?"</span>
<span style='color:#40015a; '>/bin/echo</span> <span style='color:#44aadd; '>-n</span> <span style='color:#e60000; '>"ANS (</span><span style='color:#40015a; '>y/n</span><span style='color:#e60000; '>): "</span>                      <span style='color:#c34e00; '># ask for confirmation</span>
<span style='color:#bb7977; font-weight:bold; '>read</span> INPUT                                      <span style='color:#c34e00; '># read user input</span>

<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ "$INPUT" != "y" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>                 <span style='color:#c34e00; '># conditional testing</span>
        <span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>Exit.</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>             <span style='color:#c34e00; '># exit program if no</span>
        <span style='color:#bb7977; font-weight:bold; '>return</span><span style='color:#806030; '>;</span>                                 <span style='color:#c34e00; '># otherwise send resumes out!</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

TEMP1<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.cl_tmp1"</span>                   <span style='color:#c34e00; '># temporary CL file</span>
TEMP2<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$HOME</span><span style='color:#40015a; '>/bin/CL</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>.cl_tmp2"</span>                   <span style='color:#c34e00; '># temporary CL file</span>

<span style='color:#c34e00; '># Arrays of CL jobs URL to auto send resume on</span>
<span style='color:#c34e00; '># Can add additional URLs by including more elements in the array</span>

<span style='color:#c34e00; '># For Software / QA / Programming jobs</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>1</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/sof</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>2</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/sof/index100.html</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>3</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/sof/index200.html</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>4</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/sof/index300.html</span><span style='color:#e60000; '>"</span>

<span style='color:#c34e00; '># For Web development / Design jobs</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>5</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/art</span><span style='color:#40015a; '>/</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>6</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/art/index100.html</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>7</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/art/index200.html</span><span style='color:#e60000; '>"</span>
CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>8</span><span style='color:#806030; '>]</span>=<span style='color:#e60000; '>"http:</span><span style='color:#40015a; '>/</span><span style='color:#40015a; '>/www.craigslist.org/art/index300.html</span><span style='color:#e60000; '>"</span>

<span style='color:#c34e00; '># loop through array and send resume on all CL job URLs</span>
<span style='color:#400000; font-weight:bold; '>for</span> CL_JOBS_URL <span style='color:#400000; font-weight:bold; '>in</span> ${CL_JOB<span style='color:#806030; '>[</span><span style='color:#e60000; '>@</span><span style='color:#806030; '>]</span>} <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>do</span>
        resumed<span style='color:#806030; '>;</span>                                <span style='color:#c34e00; '># send the email!</span>
<span style='color:#400000; font-weight:bold; '>done</span>

<span style='color:#40015a; '>/bin/rm</span> <span style='color:#44aadd; '>-f</span> $TEMP1                               <span style='color:#c34e00; '># remove temporary CL file</span>
<span style='color:#40015a; '>/bin/rm</span> <span style='color:#44aadd; '>-f</span> $TEMP2                               <span style='color:#c34e00; '># remove temporary CL file</span>
<span style='color:#806030; '>}</span>

<span style='color:#c34e00; '># RESUMED</span>
<span style='color:#c34e00; '># resumed is a function that auto sends my resume to CL job postings.</span>
<span style='color:#c34e00; '># this function should be used SPARINGLY since i usually send resume manually</span>
<span style='color:#c34e00; '># ===========================================================================</span>

resumed<span style='color:#806030; '>()</span> <span style='color:#806030; '>{</span>
<span style='color:#c34e00; '># download the job listings on CL</span>
<span style='color:#40015a; '>/usr/bin/printf</span> <span style='color:#e60000; '>"</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>URL: </span><span style='color:#e60000; '>$CL_JOBS_URL</span><span style='color:#0f6900; '>\n</span><span style='color:#e60000; '>"</span>
<span style='color:#40015a; '>/usr/pkg/bin/wget</span> -q <span style='color:#44aadd; '>-O</span> $TEMP1 <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CL_JOBS_URL</span><span style='color:#e60000; '>"</span>
<span style='color:#40015a; '>/bin/cat</span> $TEMP1 <span style='color:#e34adc; '>|</span> grep <span style='color:#e60000; '>"href"</span> <span style='color:#e34adc; '>|</span> grep <span style='color:#e60000; '>"nbsp"</span> <span style='color:#e34adc; '>|</span> grep <span style='color:#44aadd; '>-v</span> <span style='color:#e60000; '>"table"</span> <span style='color:#e34adc; '>></span> $TEMP2

<span style='color:#400000; font-weight:bold; '>while</span> <span style='color:#bb7977; font-weight:bold; '>read</span> LINE
<span style='color:#400000; font-weight:bold; '>do</span>
        <span style='color:#c34e00; '># extract the URL from the downloaded file</span>
        URL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$LINE</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#0f6900; background:#ffffe8; '>\"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $2}'</span><span style='color:#000000; background:#ffffe8; '>`</span>        <span style='color:#c34e00; '># GET href URL</span>
        URL<span style='color:#806030; '>=</span><span style='color:#e60000; '>"</span><span style='color:#e60000; '>$CLURL</span><span style='color:#e60000; '>$URL</span><span style='color:#e60000; '>"</span>                                <span style='color:#c34e00; '># concatenate CL URL</span>

        <span style='color:#c34e00; '># extract the job subject</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#e60000; '>"${LINE#??????????????????????????????????????????}"</span>    <span style='color:#c34e00; '># >> 43</span>
        SUBJECT<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$SUBJECT</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#0f6900; background:#ffffe8; '>\&lt;</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $1}'</span><span style='color:#000000; background:#ffffe8; '>`</span> <span style='color:#c34e00; '># select subject</span>

        <span style='color:#c34e00; '># extract the posted job email address</span>
        <span style='color:#40015a; '>/bin/cat</span> <span style='color:#40015a; '>/dev/null</span> <span style='color:#e34adc; '>></span> $TEMP1                     <span style='color:#c34e00; '># flush temporary file</span>
        <span style='color:#40015a; '>/usr/pkg/bin/wget</span> -q <span style='color:#44aadd; '>-O</span> $TEMP1 <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$URL</span><span style='color:#e60000; '>"</span>           <span style='color:#c34e00; '># GET job posting</span>
        EMAIL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`cat  </span><span style='color:#000000; background:#ffffe8; '>$TEMP1</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"&lt;hr>"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"Reply to"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep </span><span style='color:#e60000; background:#ffffe8; '>"mailto"</span><span style='color:#000000; background:#ffffe8; '>`</span>
        EMAIL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$EMAIL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#0f6900; background:#ffffe8; '>\"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $2}'</span><span style='color:#000000; background:#ffffe8; '>`</span>     <span style='color:#c34e00; '># get mailto URL</span>
        EMAIL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#000000; background:#ffffe8; '>$EMAIL</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk -F</span><span style='color:#0f6900; background:#ffffe8; '>\?</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>'{print $1}'</span><span style='color:#000000; background:#ffffe8; '>`</span>     <span style='color:#c34e00; '># strip QUERY_STRING</span>
        EMAIL<span style='color:#806030; '>=</span><span style='color:#e60000; '>"${EMAIL#???????}"</span>                        <span style='color:#c34e00; '># strip mailto string</span>
        EMAIL<span style='color:#806030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#000000; background:#ffffe8; '>$HOME</span><span style='color:#40015a; background:#ffffe8; '>/bin/CL/clemaildecoder</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e60000; background:#ffffe8; '>"</span><span style='color:#e60000; background:#ffffe8; '>$EMAIL</span><span style='color:#e60000; background:#ffffe8; '>"</span><span style='color:#000000; background:#ffffe8; '>`</span>    <span style='color:#c34e00; '># decode email addr</span>

        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ "$EMAIL" != "" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>                  <span style='color:#c34e00; '># email the resume!</span>
                <span style='color:#c34e00; '># Uncomment the next line of code to auto-send resumes out.</span>
                <span style='color:#c34e00; '># This is commented out to prevent accidental SPAMMING</span>
                <span style='color:#c34e00; '># /usr/bin/mail -s "$SUBJECT" "$EMAIL" &lt; "$RESUME"      # ASCII</span>
                <span style='color:#c34e00; '># /usr/pkg/bin/php "$PHPPROG" "$EMAIL" "$FROM" "$SUBJECT" "$RESUME"     # HTML EMAIL</span>
                <span style='color:#40015a; '>/bin/echo</span> <span style='color:#e60000; '>"RESUMED: </span><span style='color:#e60000; '>$SUBJECT</span><span style='color:#e60000; '>"</span>
        <span style='color:#400000; font-weight:bold; '>fi</span>
<span style='color:#400000; font-weight:bold; '>done</span> <span style='color:#e34adc; '>&lt;</span> $TEMP2
<span style='color:#806030; '>}</span>


<span style='color:#c34e00; '># MAIN</span>
<span style='color:#c34e00; '># this part is really where the script start executing.</span>
<span style='color:#c34e00; '># ===========================================================================</span>

<span style='color:#c34e00; '># make sure argument is not empty</span>
<span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>[</span><span style='color:#e60000; '>[ "$1" = "" </span><span style='color:#806030; '>]</span>] <span style='color:#806030; '>;</span> <span style='color:#400000; font-weight:bold; '>then</span>
        usage<span style='color:#806030; '>;</span>
        <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>
<span style='color:#400000; font-weight:bold; '>fi</span>

<span style='color:#c34e00; '># check script argument to determine which function to perform</span>
<span style='color:#400000; font-weight:bold; '>case</span> <span style='color:#e60000; '>"</span><span style='color:#e60000; '>$1</span><span style='color:#e60000; '>"</span> <span style='color:#400000; font-weight:bold; '>in</span>
        -a<span style='color:#e34adc; '>)</span> addpost<span style='color:#806030; '>;</span>    <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># add and publishes the CL posts</span>
        -p<span style='color:#e34adc; '>)</span> dispost<span style='color:#806030; '>;</span>    <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># display posts that is published</span>
        -d<span style='color:#e34adc; '>)</span> rmpost<span style='color:#806030; '>;</span>     <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># deletes the CL postings</span>
        -m<span style='color:#e34adc; '>)</span> clmetrics<span style='color:#806030; '>;</span>  <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># log CL hits/visits for metrics</span>
        -r<span style='color:#e34adc; '>)</span> resume<span style='color:#806030; '>;</span>     <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># auto send resumes to CL job postings</span>
         <span style='color:#806030; '>*</span><span style='color:#e34adc; '>)</span> usage<span style='color:#806030; '>;</span>      <span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#e34adc; '>;;</span>        <span style='color:#c34e00; '># usage information</span>
<span style='color:#400000; font-weight:bold; '>esac</span>

<span style='color:#40015a; '>/bin/rm</span> <span style='color:#44aadd; '>-f</span> $TEMP        <span style='color:#c34e00; '># delete the external CL temporary file</span>

<span style='color:#bb7977; font-weight:bold; '>exit</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span><span style='color:#806030; '>;</span>
</pre>