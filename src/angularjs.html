<pre style='color:#000000;background:#f1f0f0;'>angular<span style='color:#806030; '>.</span>module<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANGApp</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>controller<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>SearchCtrl</span><span style='color:#800000; '>"</span><span style='color:#806030; '>,</span> 
  <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>$scope<span style='color:#806030; '>,</span>$http<span style='color:#806030; '>,</span>$location<span style='color:#806030; '>,</span>ANGService<span style='color:#806030; '>,</span>Auth<span style='color:#806030; '>,</span>GlobalFuncService<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>

  <span style='color:#400000; font-weight:bold; '>var</span> searchTypeItems <span style='color:#806030; '>=</span> 
  <span style='color:#806030; '>{</span>
    <span style='color:#800000; '>'</span><span style='color:#e60000; '>cif</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span><span style='color:#806030; '>{</span>name<span style='color:#806030; '>:</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>#srcif</span><span style='color:#800000; '>'</span><span style='color:#806030; '>}</span><span style='color:#806030; '>]</span><span style='color:#806030; '>,</span>
    <span style='color:#800000; '>'</span><span style='color:#e60000; '>acct</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span><span style='color:#806030; '>{</span>name<span style='color:#806030; '>:</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>#sracct</span><span style='color:#800000; '>'</span><span style='color:#806030; '>}</span><span style='color:#806030; '>]</span><span style='color:#806030; '>,</span>
    <span style='color:#800000; '>'</span><span style='color:#e60000; '>time</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span><span style='color:#806030; '>{</span>name<span style='color:#806030; '>:</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>#srtime</span><span style='color:#800000; '>'</span><span style='color:#806030; '>}</span><span style='color:#806030; '>,</span><span style='color:#806030; '>{</span>name<span style='color:#806030; '>:</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>#srtimeprd</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span>
    <span style='color:#800000; '>"</span><span style='color:#e60000; '>columns</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span>
      <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>width</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>80px</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
      <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>width</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>120px</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
      <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>width</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>120px</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
      <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>width</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>120px</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
      <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>width</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>120px</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span>
      <span style='color:#806030; '>]</span>
    <span style='color:#806030; '>}</span><span style='color:#806030; '>]</span> 
  <span style='color:#806030; '>}</span><span style='color:#806030; '>;</span>

  <span style='color:#400000; font-weight:bold; '>var</span> g_fromview <span style='color:#806030; '>=</span> GlobalFuncService<span style='color:#806030; '>.</span>getCurrData<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>fromview<span style='color:#806030; '>;</span>  

  $scope<span style='color:#806030; '>.</span>state <span style='color:#806030; '>=</span><span style='color:#806030; '>{</span>dispsearch<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>}</span><span style='color:#806030; '>;</span>
  $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span> <span style='color:#806030; '>=</span><span style='color:#806030; '>{</span><span style='color:#806030; '>}</span><span style='color:#806030; '>;</span>
  $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>=</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>acct</span><span style='color:#800000; '>"</span><span style='color:#806030; '>;</span>
  <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>g_fromview<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    initSearch<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  $scope<span style='color:#806030; '>.</span>enableView<span style='color:#806030; '>=</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span> 

  $scope<span style='color:#806030; '>.</span>$watch<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>search.searchtype</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    $scope<span style='color:#806030; '>.</span>searchClear<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

  <span style='color:#c34e00; '>// hotkeys for #search page</span>
  <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>GlobalFuncService<span style='color:#806030; '>.</span>loadSearchKeys<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    $<span style='color:#806030; '>(</span>document<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>keydown<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>e<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
      <span style='color:#400000; font-weight:bold; '>var</span> page <span style='color:#806030; '>=</span> $location<span style='color:#806030; '>.</span>path<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>page <span style='color:#806030; '>==</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>/search</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        
          <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>e<span style='color:#806030; '>.</span>keyCode <span style='color:#806030; '>==</span> <span style='color:#c00000; '>13</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>  <span style='color:#c34e00; '>// Enter</span>
          document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>b_search</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span>
          <span style='color:#c34e00; '>/*</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if(e.altKey) {</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;switch (e.keyCode) {</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;case 76: // l</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Auth.logout();</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;window.location.href = "#/login";</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;          </span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}        </span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;*/</span>
          <span style='color:#400000; font-weight:bold; '>return</span><span style='color:#806030; '>;</span>
      <span style='color:#806030; '>}</span>
    <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>     
  <span style='color:#806030; '>}</span>

  <span style='color:#400000; font-weight:bold; '>function</span> initSearch<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>      
    <span style='color:#c34e00; '>// dynamically setup our select options list</span>
    <span style='color:#400000; font-weight:bold; '>var</span> acctprexlist <span style='color:#806030; '>=</span> Auth<span style='color:#806030; '>.</span>getAcctTypeList<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      <span style='color:#400000; font-weight:bold; '>var</span> sel <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>#searchacctprefix</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      sel<span style='color:#806030; '>.</span>empty<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $<span style='color:#806030; '>.</span>each<span style='color:#806030; '>(</span>acctprexlist<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>split</span><span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>,</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
          sel<span style='color:#806030; '>.</span>append<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>&lt;option value="</span><span style='color:#800000; '>'</span><span style='color:#806030; '>+</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>"></span><span style='color:#800000; '>'</span><span style='color:#806030; '>+</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>&lt;/option></span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>  

    <span style='color:#400000; font-weight:bold; '>var</span> selfirst <span style='color:#806030; '>=</span> document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>searchacctprefix</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>options<span style='color:#806030; '>[</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>]</span><span style='color:#806030; '>;</span>
    selfirst<span style='color:#806030; '>.</span>selected <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>  
    <span style='color:#c34e00; '>//selfirst[0].selectedIndex = 0;</span>
    <span style='color:#c34e00; '>//selfirst.find('option:eq(0)').prop('selected', true);  </span>
    <span style='color:#c34e00; '>//selfirst.val(selfirst.find('option').first().val());</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>hasMore<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>needInput<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>docid<span style='color:#806030; '>=</span><span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#806030; '>;</span>    
    $scope<span style='color:#806030; '>.</span>selected <span style='color:#806030; '>=</span> <span style='color:#806030; '>{</span> <span style='color:#c00000; '>1</span><span style='color:#806030; '>:</span><span style='color:#806030; '>{</span>row<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>,</span>index<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>,</span>itempacked<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
              <span style='color:#c00000; '>2</span><span style='color:#806030; '>:</span><span style='color:#806030; '>{</span>row<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>,</span>index<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>,</span>itempacked<span style='color:#806030; '>:</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>}</span><span style='color:#806030; '>}</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>enableView<span style='color:#806030; '>=</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>

    <span style='color:#c34e00; '>// don't clear if from view page, re-show the grid table</span>
    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>g_fromview<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>

      <span style='color:#400000; font-weight:bold; '>var</span> <span style='color:#400000; font-weight:bold; '>search</span> <span style='color:#806030; '>=</span> GlobalFuncService<span style='color:#806030; '>.</span>getCurrData<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>;</span>
      $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctname<span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctname<span style='color:#806030; '>;</span>
      $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>

      <span style='color:#400000; font-weight:bold; '>var</span> btnType <span style='color:#806030; '>=</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>b_</span><span style='color:#800000; '>'</span> <span style='color:#806030; '>+</span> <span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>;</span>
      document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span>btnType<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    <span style='color:#c34e00; '>// call twice! don't know why, but it is needed    </span>

      <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype <span style='color:#806030; '>==</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>acct</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        <span style='color:#400000; font-weight:bold; '>var</span> selidx <span style='color:#806030; '>=</span> document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>searchacctprefix</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>options<span style='color:#806030; '>[</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctprefixidx<span style='color:#806030; '>+</span><span style='color:#c00000; '>1</span><span style='color:#806030; '>]</span><span style='color:#806030; '>;</span>
        selidx<span style='color:#806030; '>.</span>selected <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>
      <span style='color:#806030; '>}</span>
      document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>b_search</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

      <span style='color:#c34e00; '>// clear from view flag so that user may change type</span>
      GlobalFuncService<span style='color:#806030; '>.</span>setCurrDataFromView<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      g_fromview <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>            
    <span style='color:#806030; '>}</span> <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#806030; '>{</span>
      document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>b_clear</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    <span style='color:#c34e00; '>// first call does nothing!        </span>
    <span style='color:#806030; '>}</span>
  <span style='color:#806030; '>}</span>  

  <span style='color:#c34e00; '>//build the search criteria on the fly</span>
  <span style='color:#400000; font-weight:bold; '>function</span> searchCriteria<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>return</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>randint=</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>+</span> Math<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>random</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#400000; font-weight:bold; '>function</span> pad<span style='color:#806030; '>(</span>num<span style='color:#806030; '>,</span> places<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>var</span> zero <span style='color:#806030; '>=</span> places <span style='color:#806030; '>-</span> num<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>toString</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>length</span> <span style='color:#806030; '>+</span> <span style='color:#c00000; '>1</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>return</span> Array<span style='color:#806030; '>(</span><span style='color:#806030; '>+</span><span style='color:#806030; '>(</span>zero <span style='color:#806030; '>></span> <span style='color:#c00000; '>0</span> <span style='color:#806030; '>&amp;&amp;</span> zero<span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>join</span><span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>0</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>+</span> num<span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#400000; font-weight:bold; '>function</span> searchSetUrl<span style='color:#806030; '>(</span>type<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>

    <span style='color:#400000; font-weight:bold; '>var</span> param1 <span style='color:#806030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>-1</span><span style='color:#800000; '>"</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>param1<span style='color:#806030; '>)</span> param1 <span style='color:#806030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>-1</span><span style='color:#800000; '>"</span><span style='color:#806030; '>;</span>

    <span style='color:#400000; font-weight:bold; '>var</span> stype <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>type <span style='color:#806030; '>==</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>#srtimeprd</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span>
    <span style='color:#806030; '>{</span>
      stype <span style='color:#806030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>srtimeprd</span><span style='color:#800000; '>"</span><span style='color:#806030; '>;</span> 

      <span style='color:#c34e00; '>// get current selected row</span>
        <span style='color:#400000; font-weight:bold; '>var</span> nRow <span style='color:#806030; '>=</span>  $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span><span style='color:#c00000; '>1</span><span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>row<span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>  
        <span style='color:#400000; font-weight:bold; '>var</span> searchtables<span style='color:#806030; '>=</span> searchTypeItems<span style='color:#806030; '>[</span>$scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>]</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>var</span> searchtype <span style='color:#806030; '>=</span> searchtables<span style='color:#806030; '>[</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>name<span style='color:#806030; '>;</span>              

        <span style='color:#c34e00; '>// get current selected cif#, acct#, etc</span>
      <span style='color:#400000; font-weight:bold; '>var</span> mytable <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>DataTable<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      param1 <span style='color:#806030; '>=</span> mytable<span style='color:#806030; '>.</span>data<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>[</span>nRow<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>d1<span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>

    <span style='color:#400000; font-weight:bold; '>var</span> search_url <span style='color:#806030; '>=</span> GlobalFuncService<span style='color:#806030; '>.</span>serviceUrl<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>/search/get/</span><span style='color:#800000; '>"</span>
      <span style='color:#806030; '>+</span> Auth<span style='color:#806030; '>.</span>getSessionId<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>/</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>+</span> stype <span style='color:#806030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>/</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>+</span> param1 <span style='color:#806030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>/</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>+</span> param2 <span style='color:#806030; '>+</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>/</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>+</span> param3<span style='color:#806030; '>;</span>        

    <span style='color:#c34e00; '>//console.log("Searching : " + search_url);</span>
    <span style='color:#400000; font-weight:bold; '>return</span> search_url<span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#400000; font-weight:bold; '>function</span> searchTarget<span style='color:#806030; '>(</span>searchobj<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>var</span> searchtype <span style='color:#806030; '>=</span> searchobj<span style='color:#806030; '>.</span>name<span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> columns <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    <span style='color:#c34e00; '>//alert('scrolly: ' +$(searchtype).data('scrolly'));</span>
    <span style='color:#400000; font-weight:bold; '>if</span><span style='color:#806030; '>(</span>searchobj<span style='color:#806030; '>.</span>columns<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
      columns <span style='color:#806030; '>=</span> searchobj<span style='color:#806030; '>.</span>columns<span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>show<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>_wrapper</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>show<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> step <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>data<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>step</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>row<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>SetView<span style='color:#806030; '>(</span>step<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span> $<span style='color:#806030; '>.</span>fn<span style='color:#806030; '>.</span>dataTable<span style='color:#806030; '>.</span>isDataTable<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span> <span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
      table <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>DataTable<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      table<span style='color:#806030; '>.</span>ajax<span style='color:#806030; '>.</span>url<span style='color:#806030; '>(</span>searchSetUrl<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>load<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      <span style='color:#c34e00; '>//table.ajax.reload();</span>
    <span style='color:#806030; '>}</span><span style='color:#400000; font-weight:bold; '>else</span><span style='color:#806030; '>{</span>
      table <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span>
      <span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>init.dt</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>click</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>tr</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
          $<span style='color:#806030; '>(</span> searchtype<span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '> tr.selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>removeClass<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span> $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index <span style='color:#806030; '>==</span> $<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span><span style='color:#400000; font-weight:bold; '>else</span><span style='color:#806030; '>{</span>
            $<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>addClass<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span>
        <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

        $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>dblclick</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>tr</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>  
          <span style='color:#400000; font-weight:bold; '>var</span> stype <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>;</span>
          <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>stype <span style='color:#806030; '>==</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>time</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span> 
            $scope<span style='color:#806030; '>.</span>selectTime<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>        
          <span style='color:#806030; '>}</span> <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>           
            $scope<span style='color:#806030; '>.</span>viewSignature<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>          
          <span style='color:#806030; '>}</span>      
        <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>        
      <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span>
      <span style='color:#806030; '>.</span>dataTable<span style='color:#806030; '>(</span> <span style='color:#806030; '>{</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>scrollY</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>data<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>scrolly</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>scrollX</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> columns<span style='color:#806030; '>==</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>?</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>:</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>columns</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>columns<span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>paging</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>   <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>        
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>searching</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>   <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>processing</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#0f4d75; '>true</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>serverSide</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>ajax</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>{</span>
          <span style='color:#c34e00; '>//"url":'data/demo' +searchtype.replace('#','')+'.txt',</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>url</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>searchSetUrl<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>,</span>      
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>type</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>GET</span><span style='color:#800000; '>"</span><span style='color:#806030; '>,</span>
          <span style='color:#c34e00; '>//"data":searchCriteria(),</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>beforeSend</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>inputerror<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>            
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>complete</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>resp<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>        
            <span style='color:#400000; font-weight:bold; '>var</span> obj <span style='color:#806030; '>=</span> resp<span style='color:#806030; '>.</span>responseJSON<span style='color:#806030; '>;</span>
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>hasMore <span style='color:#806030; '>=</span> obj<span style='color:#806030; '>.</span>hasMore<span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

            <span style='color:#400000; font-weight:bold; '>var</span> stype <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>stype <span style='color:#806030; '>==</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>time</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
              <span style='color:#c34e00; '>// if (obj.rows == 1 &amp;&amp; $scope.search.ignoreautoview == false) {</span>
              <span style='color:#c34e00; '>//   setTimeout(function() { </span>
                <span style='color:#c34e00; '>//     //$scope.selected[1].index=0;</span>
              <span style='color:#c34e00; '>//     $scope.selectTime();</span>
              <span style='color:#c34e00; '>//     document.getElementById("b_select").click();  </span>
              <span style='color:#c34e00; '>//   }, 500);              </span>
              <span style='color:#c34e00; '>// }</span>
            <span style='color:#806030; '>}</span>
            <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#806030; '>{</span>
              <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>obj<span style='color:#806030; '>.</span>rows <span style='color:#806030; '>==</span> <span style='color:#c00000; '>1</span> <span style='color:#806030; '>&amp;&amp;</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview <span style='color:#806030; '>==</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                <span style='color:#400000; font-weight:bold; '>setTimeout</span><span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>  
                    <span style='color:#c34e00; '>//$scope.selected[2].index=0;</span>
                    $scope<span style='color:#806030; '>.</span>viewSignature<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>                    
                  document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>b_search</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>              
                <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span> <span style='color:#c00000; '>500</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>              
              <span style='color:#806030; '>}</span>
            <span style='color:#806030; '>}</span>
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>error</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>resp<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>      
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>  
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>inputerror<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>                  
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>            
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
        <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>columns</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span>
          <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>data</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>d1</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>data</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>d2</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span>
        <span style='color:#806030; '>]</span><span style='color:#806030; '>,</span>                
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>fnCreatedRow</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span> nRow<span style='color:#806030; '>,</span> aData<span style='color:#806030; '>,</span> iDataIndex <span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                <span style='color:#c34e00; '>// Bold the grade for all 'A' grade browsers</span>
                $<span style='color:#806030; '>(</span>nRow<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span>iDataIndex<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
              <span style='color:#806030; '>}</span>
          <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#c34e00; '>// TODO... perhaps combine with searchTarget</span>
  <span style='color:#400000; font-weight:bold; '>function</span> searchTargetTime<span style='color:#806030; '>(</span>searchobj<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>var</span> searchtype <span style='color:#806030; '>=</span> searchobj<span style='color:#806030; '>.</span>name<span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> columns <span style='color:#806030; '>=</span> <span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    <span style='color:#c34e00; '>//alert('scrolly: ' +$(searchtype).data('scrolly'));</span>
    <span style='color:#400000; font-weight:bold; '>if</span><span style='color:#806030; '>(</span>searchobj<span style='color:#806030; '>.</span>columns<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
      columns <span style='color:#806030; '>=</span> searchobj<span style='color:#806030; '>.</span>columns<span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>show<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>_wrapper</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>show<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> step <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>data<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>step</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>row<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span>SetView<span style='color:#806030; '>(</span>step<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span> $<span style='color:#806030; '>.</span>fn<span style='color:#806030; '>.</span>dataTable<span style='color:#806030; '>.</span>isDataTable<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span> <span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
      table <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>DataTable<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      table<span style='color:#806030; '>.</span>ajax<span style='color:#806030; '>.</span>url<span style='color:#806030; '>(</span>searchSetUrl<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>load<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
      <span style='color:#c34e00; '>//table.ajax.reload();</span>
    <span style='color:#806030; '>}</span><span style='color:#400000; font-weight:bold; '>else</span><span style='color:#806030; '>{</span>
      table <span style='color:#806030; '>=</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span>
      <span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>init.dt</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>click</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>tr</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
          $<span style='color:#806030; '>(</span> searchtype<span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '> tr.selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>removeClass<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span> $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>step<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index <span style='color:#806030; '>==</span> $<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span><span style='color:#400000; font-weight:bold; '>else</span><span style='color:#806030; '>{</span>
            $<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>addClass<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>selected</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
            $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span>
        <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

        $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>on<span style='color:#806030; '>(</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>dblclick</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>tr</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span> <span style='color:#400000; font-weight:bold; '>function</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>          
          $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span> 
          $scope<span style='color:#806030; '>.</span>viewSignature<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          $scope<span style='color:#806030; '>.</span>SetSelected<span style='color:#806030; '>(</span>step<span style='color:#806030; '>,</span>$<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>this</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    
        <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>        
      <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span>
      <span style='color:#806030; '>.</span>dataTable<span style='color:#806030; '>(</span> <span style='color:#806030; '>{</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>scrollY</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>data<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>scrolly</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>scrollX</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> columns<span style='color:#806030; '>==</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>?</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>:</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>columns</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>columns<span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>paging</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>   <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>        
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>searching</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>   <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>processing</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#0f4d75; '>true</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>serverSide</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>ajax</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>{</span>
          <span style='color:#c34e00; '>//"url":'data/demo' +searchtype.replace('#','')+'.txt',</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>url</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span>searchSetUrl<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>,</span>      
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>type</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>GET</span><span style='color:#800000; '>"</span><span style='color:#806030; '>,</span>
          <span style='color:#c34e00; '>//"data":searchCriteria(),</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>beforeSend</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>inputerror<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>            
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>complete</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>resp<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>  
            <span style='color:#400000; font-weight:bold; '>var</span> obj <span style='color:#806030; '>=</span> resp<span style='color:#806030; '>.</span>responseJSON<span style='color:#806030; '>;</span>
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>  

            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>obj<span style='color:#806030; '>.</span>rows <span style='color:#806030; '>==</span> <span style='color:#c00000; '>1</span> <span style='color:#806030; '>&amp;&amp;</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview <span style='color:#806030; '>==</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
              <span style='color:#400000; font-weight:bold; '>setTimeout</span><span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>  
                  $scope<span style='color:#806030; '>.</span>viewSignature<span style='color:#806030; '>(</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>                    
                document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>b_select</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>click<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>              
              <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span> <span style='color:#c00000; '>500</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>              
            <span style='color:#806030; '>}</span>                    
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#800000; '>"</span><span style='color:#e60000; '>error</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>resp<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>      
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>processing<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>  
            $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>inputerror<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>                  
            <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span><span style='color:#806030; '>!</span>$scope<span style='color:#806030; '>.</span>$$phase<span style='color:#806030; '>)</span> $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>            
          <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>                        
        <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>columns</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#806030; '>[</span>
          <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>data</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>d1</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span><span style='color:#806030; '>,</span>
          <span style='color:#806030; '>{</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>data</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>d2</span><span style='color:#800000; '>"</span> <span style='color:#806030; '>}</span>
        <span style='color:#806030; '>]</span><span style='color:#806030; '>,</span>        
        <span style='color:#800000; '>"</span><span style='color:#e60000; '>fnCreatedRow</span><span style='color:#800000; '>"</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span> nRow<span style='color:#806030; '>,</span> aData<span style='color:#806030; '>,</span> iDataIndex <span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
                <span style='color:#c34e00; '>// Bold the grade for all 'A' grade browsers</span>
                $<span style='color:#806030; '>(</span>nRow<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>,</span>iDataIndex<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
              <span style='color:#806030; '>}</span>
          <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>
  <span style='color:#806030; '>}</span>  

  <span style='color:#400000; font-weight:bold; '>function</span> hideTarget<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>//console.log(searchtype);</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>+</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>_wrapper</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>hide<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $<span style='color:#806030; '>(</span>searchtype<span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>hide<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#400000; font-weight:bold; '>function</span> padNumFormatter<span style='color:#806030; '>(</span>inputnumber<span style='color:#806030; '>,</span>padding<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>var</span> number <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>parseInt</span><span style='color:#806030; '>(</span>inputnumber<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> strnum <span style='color:#806030; '>=</span> number<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>toString</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>

        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>strnum<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>length</span> <span style='color:#806030; '>></span> padding<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
      inputnumber <span style='color:#806030; '>=</span> strnum<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>substring</span><span style='color:#806030; '>(</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>,</span> padding<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>   
        <span style='color:#c34e00; '>/*</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;else {</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;inputnumber = pad(number, padding);  // pad 0's            </span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;*/</span>  
    <span style='color:#400000; font-weight:bold; '>return</span> inputnumber<span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  $scope<span style='color:#806030; '>.</span>cifNumChange<span style='color:#806030; '>=</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>cifnumber <span style='color:#806030; '>=</span> padNumFormatter<span style='color:#806030; '>(</span>$scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>cifnumber<span style='color:#806030; '>,</span> <span style='color:#c00000; '>10</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>    
  <span style='color:#806030; '>}</span>

  $scope<span style='color:#806030; '>.</span>acctPrefixChange<span style='color:#806030; '>=</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>var</span> idx <span style='color:#806030; '>=</span> document<span style='color:#806030; '>.</span>getElementById<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>searchacctprefix</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>selectedIndex<span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctprefixidx <span style='color:#806030; '>=</span> idx<span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>    
  <span style='color:#806030; '>}</span>

  $scope<span style='color:#806030; '>.</span>acctNumChange<span style='color:#806030; '>=</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>type<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    <span style='color:#400000; font-weight:bold; '>switch</span><span style='color:#806030; '>(</span>type<span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
      <span style='color:#400000; font-weight:bold; '>case</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>A</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>case</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>B</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span>
        $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctnumlen <span style='color:#806030; '>=</span> <span style='color:#c00000; '>12</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>break</span><span style='color:#806030; '>;</span>

      <span style='color:#400000; font-weight:bold; '>case</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>C</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>case</span> <span style='color:#800000; '>'</span><span style='color:#e60000; '>D</span><span style='color:#800000; '>'</span><span style='color:#806030; '>:</span> <span style='color:#400000; font-weight:bold; '>default</span><span style='color:#806030; '>:</span>
        $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctnumlen <span style='color:#806030; '>=</span> <span style='color:#c00000; '>12</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>break</span><span style='color:#806030; '>;</span>
    <span style='color:#806030; '>}</span>    
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctnumber <span style='color:#806030; '>=</span> padNumFormatter<span style='color:#806030; '>(</span>$scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctnumber<span style='color:#806030; '>,</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>acctnumlen<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>ignoreautoview<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>    
  <span style='color:#806030; '>}</span>
  
  $scope<span style='color:#806030; '>.</span>setSearchType<span style='color:#806030; '>=</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>type<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>  
    $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype <span style='color:#806030; '>=</span> type<span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  $scope<span style='color:#806030; '>.</span>SetView<span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>level<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>//console.log('SetView : ' +level)</span>
    $scope<span style='color:#806030; '>.</span>enableView<span style='color:#806030; '>=</span> level<span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>
  
  $scope<span style='color:#806030; '>.</span>SetSelected <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>level<span style='color:#806030; '>,</span>row<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>//console.log('SetSelected : ' +level + ":" + row)</span>
    $scope<span style='color:#806030; '>.</span>$apply<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>level<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>row<span style='color:#806030; '>=</span>row<span style='color:#806030; '>;</span>   
        <span style='color:#400000; font-weight:bold; '>if</span><span style='color:#806030; '>(</span>row<span style='color:#806030; '>!=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
          $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>level<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index<span style='color:#806030; '>=</span>row<span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#806030; '>}</span>
        <span style='color:#400000; font-weight:bold; '>else</span>
          $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>level<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>index<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>null</span><span style='color:#806030; '>;</span>            
    <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>
  
  $scope<span style='color:#806030; '>.</span>searchSignatures <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>// check valid session</span>
    ANGService<span style='color:#806030; '>.</span>isSessionValid<span style='color:#806030; '>(</span>Auth<span style='color:#806030; '>.</span>getSessionId<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>.</span>then<span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>result<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
      <span style='color:#400000; font-weight:bold; '>var</span> res <span style='color:#806030; '>=</span> result<span style='color:#806030; '>.</span>data<span style='color:#806030; '>.</span>IsSessionValidResult<span style='color:#806030; '>;</span>
      <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>res <span style='color:#806030; '>==</span> <span style='color:#800000; '>"</span><span style='color:#e60000; '>OK</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
        <span style='color:#c34e00; '>// search sig</span>
        $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>needInput<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>false</span><span style='color:#806030; '>;</span>
        $scope<span style='color:#806030; '>.</span>state<span style='color:#806030; '>.</span>dispsearch<span style='color:#806030; '>=</span><span style='color:#0f4d75; '>true</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>var</span> searchtables<span style='color:#806030; '>=</span> searchTypeItems<span style='color:#806030; '>[</span>stype<span style='color:#806030; '>]</span><span style='color:#806030; '>;</span>
        searchTarget<span style='color:#806030; '>(</span>searchtables<span style='color:#806030; '>[</span><span style='color:#c00000; '>0</span><span style='color:#806030; '>]</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>searchtables<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>length</span><span style='color:#806030; '>></span><span style='color:#c00000; '>1</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
          <span style='color:#400000; font-weight:bold; '>for</span> <span style='color:#806030; '>(</span><span style='color:#400000; font-weight:bold; '>var</span> i<span style='color:#806030; '>=</span><span style='color:#c00000; '>1</span><span style='color:#806030; '>;</span> i <span style='color:#806030; '>&lt;</span> searchtables<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>length</span><span style='color:#806030; '>;</span> i<span style='color:#806030; '>++</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
            hideTarget<span style='color:#806030; '>(</span>searchtables<span style='color:#806030; '>[</span>i<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>name<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
          <span style='color:#806030; '>}</span>
          <span style='color:#806030; '>}</span>
      <span style='color:#806030; '>}</span>
      <span style='color:#400000; font-weight:bold; '>else</span> <span style='color:#806030; '>{</span>
        <span style='color:#400000; font-weight:bold; '>alert</span><span style='color:#806030; '>(</span>GlobalFuncService<span style='color:#806030; '>.</span>getPopMessage<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>TIMEOUT_SESSION</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        $location<span style='color:#806030; '>.</span>path<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>login</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
        <span style='color:#400000; font-weight:bold; '>return</span><span style='color:#806030; '>;</span>      
      <span style='color:#806030; '>}</span>        
    <span style='color:#806030; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>

  <span style='color:#c34e00; '>/*</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;$scope.searchSignatures = function(){</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;$scope.state.dispsearch=true;</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;var searchtables= searchTypeItems[$scope.search.searchtype];</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;searchTarget(searchtables[0]);</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;if (searchtables.length>1){</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;for (var i=1; i &lt; searchtables.length; i++) {</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;hideTarget(searchtables[i].name);</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#c34e00; '>&#xa0;&#xa0;}  </span>
<span style='color:#c34e00; '>&#xa0;&#xa0;*/</span>
  
  $scope<span style='color:#806030; '>.</span>searchClear <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    initSearch<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>
  
  $scope<span style='color:#806030; '>.</span>selectTime <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>//console.log('selectTime begin');</span>
    searchTargetTime<span style='color:#806030; '>(</span>searchTypeItems<span style='color:#806030; '>[</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>time</span><span style='color:#800000; '>'</span><span style='color:#806030; '>]</span><span style='color:#806030; '>[</span><span style='color:#c00000; '>1</span><span style='color:#806030; '>]</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>
  
  $scope<span style='color:#806030; '>.</span>viewSignature <span style='color:#806030; '>=</span> <span style='color:#400000; font-weight:bold; '>function</span><span style='color:#806030; '>(</span>autozero<span style='color:#806030; '>)</span><span style='color:#806030; '>{</span>
    <span style='color:#c34e00; '>// get current selected row</span>
    <span style='color:#400000; font-weight:bold; '>var</span> level <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span>enableView<span style='color:#806030; '>;</span>
    <span style='color:#400000; font-weight:bold; '>var</span> nRow <span style='color:#806030; '>=</span> <span style='color:#c00000; '>0</span><span style='color:#806030; '>;</span>

    <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>autozero <span style='color:#806030; '>==</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
       nRow <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span>selected<span style='color:#806030; '>[</span>level<span style='color:#806030; '>]</span><span style='color:#806030; '>.</span>row<span style='color:#806030; '>.</span>attr<span style='color:#806030; '>(</span><span style='color:#800000; '>'</span><span style='color:#e60000; '>ANG-tindex</span><span style='color:#800000; '>'</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    
    <span style='color:#806030; '>}</span>      
    <span style='color:#400000; font-weight:bold; '>var</span> stype <span style='color:#806030; '>=</span> $scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>.</span>searchtype<span style='color:#806030; '>;</span>

    <span style='color:#806030; '>}</span>
    GlobalFuncService<span style='color:#806030; '>.</span>setCurrDataSearch<span style='color:#806030; '>(</span>$scope<span style='color:#806030; '>.</span><span style='color:#400000; font-weight:bold; '>search</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    
    GlobalFuncService<span style='color:#806030; '>.</span>setCurrData<span style='color:#806030; '>(</span>stype<span style='color:#806030; '>,</span> refnumb<span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
    $location<span style='color:#806030; '>.</span>path<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>view</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#806030; '>}</span>  

  <span style='color:#c34e00; '>//check if user logged in, if not, redirect to login page</span>
  <span style='color:#400000; font-weight:bold; '>var</span> isLoggedIn <span style='color:#806030; '>=</span> Auth<span style='color:#806030; '>.</span>isLoggedIn<span style='color:#806030; '>(</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
  <span style='color:#400000; font-weight:bold; '>if</span> <span style='color:#806030; '>(</span>isLoggedIn <span style='color:#806030; '>==</span> <span style='color:#0f4d75; '>false</span><span style='color:#806030; '>)</span> <span style='color:#806030; '>{</span>
    $location<span style='color:#806030; '>.</span>path<span style='color:#806030; '>(</span><span style='color:#800000; '>"</span><span style='color:#e60000; '>login</span><span style='color:#800000; '>"</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>    
  <span style='color:#806030; '>}</span>
<span style='color:#ffffff; background:#dd0000; font-weight:bold; font-style:italic; '>}</span><span style='color:#806030; '>)</span><span style='color:#806030; '>;</span>
</pre>