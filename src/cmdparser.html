<pre style='color:#000000;background:#ffffff;'><span style='color:#008000; '>//////////////////////////////////////////////////////////////////////////////</span>
<span style='color:#008000; '>//    Command Line Argument Parser</span>
<span style='color:#008000; '>//    ----------------------------</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Author: </span><span style='color:#7144c4; '>hotweird@hotmail.com</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Microsoft Public License (Ms-PL)</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    This license governs use of the accompanying software. If you use the software, you</span>
<span style='color:#008000; '>//    accept this license. If you do not accept the license, do not use the software.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    1. Definitions</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    The terms "reproduce," "reproduction," "derivative works," and "distribution" have the</span>
<span style='color:#008000; '>//    same meaning here as under U.S. copyright law.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    A "contribution" is the original software, or any additions or changes to the software.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    A "contributor" is any person that distributes its contribution under this license.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    "Licensed patents" are a contributor's patent claims that read directly on its contribution.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    2. Grant of Rights</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (A) Copyright Grant- Subject to the terms of this license, including the license conditions</span>
<span style='color:#008000; '>//        and limitations in section 3, each contributor grants you a non-exclusive, worldwide,</span>
<span style='color:#008000; '>//        royalty-free copyright license to reproduce its contribution, prepare derivative works</span>
<span style='color:#008000; '>//        of its contribution, and distribute its contribution or any derivative works that you create.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (B) Patent Grant- Subject to the terms of this license, including the license conditions and</span>
<span style='color:#008000; '>//        limitations in section 3, each contributor grants you a non-exclusive, worldwide,</span>
<span style='color:#008000; '>//        royalty-free license under its licensed patents to make, have made, use, sell, offer for</span>
<span style='color:#008000; '>//        sale, import, and/or otherwise dispose of its contribution in the software or derivative</span>
<span style='color:#008000; '>//        works of the contribution in the software.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    3. Conditions and Limitations</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (A) No Trademark License- This license does not grant you rights to use any contributors'</span>
<span style='color:#008000; '>//        name, logo, or trademarks.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (B) If you bring a patent claim against any contributor over patents that you claim are</span>
<span style='color:#008000; '>//        infringed by the software, your patent license from such contributor to the software ends</span>
<span style='color:#008000; '>//        automatically.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (C) If you distribute any portion of the software, you must retain all copyright, patent,</span>
<span style='color:#008000; '>//        trademark, and attribution notices that are present in the software.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (D) If you distribute any portion of the software in source code form, you may do so only under</span>
<span style='color:#008000; '>//        this license by including a complete copy of this license with your distribution. If you</span>
<span style='color:#008000; '>//        distribute any portion of the software in compiled or object code form, you may only do so</span>
<span style='color:#008000; '>//        under a license that complies with this license.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    (E) The software is licensed "as-is." You bear the risk of using it. The contributors give no</span>
<span style='color:#008000; '>//        express warranties, guarantees or conditions. You may have additional consumer rights under</span>
<span style='color:#008000; '>//        your local laws which this license cannot change. To the extent permitted under your local</span>
<span style='color:#008000; '>//        laws, the contributors exclude the implied warranties of merchantability, fitness for a</span>
<span style='color:#008000; '>//        particular purpose and non-infringement.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Usage</span>
<span style='color:#008000; '>//    -----</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Parsing command line arguments to a console application is a common problem. </span>
<span style='color:#008000; '>//    This library handles the common task of reading arguments from a command line </span>
<span style='color:#008000; '>//    and filling in the values in a type.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    To use this library, define a class whose fields represent the data that your </span>
<span style='color:#008000; '>//    application wants to receive from arguments on the command line. Then call </span>
<span style='color:#008000; '>//    CommandLine.ParseArguments() to fill the object with the data </span>
<span style='color:#008000; '>//    from the command line. Each field in the class defines a command line argument. </span>
<span style='color:#008000; '>//    The type of the field is used to validate the data read from the command line. </span>
<span style='color:#008000; '>//    The name of the field defines the name of the command line option.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    The parser can handle fields of the following types:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    - string</span>
<span style='color:#008000; '>//    - int</span>
<span style='color:#008000; '>//    - uint</span>
<span style='color:#008000; '>//    - bool</span>
<span style='color:#008000; '>//    - enum</span>
<span style='color:#008000; '>//    - array of the above type</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    For example, suppose you want to read in the argument list for wc (word count). </span>
<span style='color:#008000; '>//    wc takes three optional boolean arguments: -l, -w, and -c and a list of files.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    You could parse these arguments using the following code:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    class WCArguments</span>
<span style='color:#008000; '>//    {</span>
<span style='color:#008000; '>//        public bool lines;</span>
<span style='color:#008000; '>//        public bool words;</span>
<span style='color:#008000; '>//        public bool chars;</span>
<span style='color:#008000; '>//        public string[] files;</span>
<span style='color:#008000; '>//    }</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    class WC</span>
<span style='color:#008000; '>//    {</span>
<span style='color:#008000; '>//        static void Main(string[] args)</span>
<span style='color:#008000; '>//        {</span>
<span style='color:#008000; '>//            if (CommandLine.ParseArgumentsWithUsage(args, parsedArgs))</span>
<span style='color:#008000; '>//            {</span>
<span style='color:#008000; '>//            //     insert application code here</span>
<span style='color:#008000; '>//            }</span>
<span style='color:#008000; '>//        }</span>
<span style='color:#008000; '>//    }</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    So you could call this aplication with the following command line to count </span>
<span style='color:#008000; '>//    lines in the foo and bar files:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//        wc.exe /lines /files:foo /files:bar</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    The program will display the following usage message when bad command line </span>
<span style='color:#008000; '>//    arguments are used:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//        wc.exe -x</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Unrecognized command line argument '-x'</span>
<span style='color:#008000; '>//        /lines[+|-]                         short form /l</span>
<span style='color:#008000; '>//        /words[+|-]                         short form /w</span>
<span style='color:#008000; '>//        /chars[+|-]                         short form /c</span>
<span style='color:#008000; '>//        /files:&lt;string>                     short form /f</span>
<span style='color:#008000; '>//        @&lt;file>                             Read response file for more options</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    That was pretty easy. However, you realy want to omit the "/files:" for the </span>
<span style='color:#008000; '>//    list of files. The details of field parsing can be controled using custom </span>
<span style='color:#008000; '>//    attributes. The attributes which control parsing behaviour are:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    ArgumentAttribute </span>
<span style='color:#008000; '>//        - controls short name, long name, required, allow duplicates, default value</span>
<span style='color:#008000; '>//        and help text</span>
<span style='color:#008000; '>//    DefaultArgumentAttribute </span>
<span style='color:#008000; '>//        - allows omition of the "/name".</span>
<span style='color:#008000; '>//        - This attribute is allowed on only one field in the argument class.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    So for the wc.exe program we want this:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    using System;</span>
<span style='color:#008000; '>//    using Utilities;</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    class WCArguments</span>
<span style='color:#008000; '>//    {</span>
<span style='color:#008000; '>//        [Argument(ArgumentType.AtMostOnce, HelpText="Count number of lines in the input text.")]</span>
<span style='color:#008000; '>//        public bool lines;</span>
<span style='color:#008000; '>//        [Argument(ArgumentType.AtMostOnce, HelpText="Count number of words in the input text.")]</span>
<span style='color:#008000; '>//        public bool words;</span>
<span style='color:#008000; '>//        [Argument(ArgumentType.AtMostOnce, HelpText="Count number of chars in the input text.")]</span>
<span style='color:#008000; '>//        public bool chars;</span>
<span style='color:#008000; '>//        [DefaultArgument(ArgumentType.MultipleUnique, HelpText="Input files to count.")]</span>
<span style='color:#008000; '>//        public string[] files;</span>
<span style='color:#008000; '>//    }</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    class WC</span>
<span style='color:#008000; '>//    {</span>
<span style='color:#008000; '>//        static void Main(string[] args)</span>
<span style='color:#008000; '>//        {</span>
<span style='color:#008000; '>//            WCArguments parsedArgs = new WCArguments();</span>
<span style='color:#008000; '>//            if (CommandLine.ParseArgumentsWithUsage(args, parsedArgs))</span>
<span style='color:#008000; '>//            {</span>
<span style='color:#008000; '>//            //     insert application code here</span>
<span style='color:#008000; '>//            }</span>
<span style='color:#008000; '>//        }</span>
<span style='color:#008000; '>//    }</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    So now we have the command line we want:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//        wc.exe /lines foo bar</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    This will set lines to true and will set files to an array containing the </span>
<span style='color:#008000; '>//    strings "foo" and "bar".</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    The new usage message becomes:</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//        wc.exe -x</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Unrecognized command line argument '-x'</span>
<span style='color:#008000; '>//    /lines[+|-]  Count number of lines in the input text. (short form /l)</span>
<span style='color:#008000; '>//    /words[+|-]  Count number of words in the input text. (short form /w)</span>
<span style='color:#008000; '>//    /chars[+|-]  Count number of chars in the input text. (short form /c)</span>
<span style='color:#008000; '>//    @&lt;file>      Read response file for more options</span>
<span style='color:#008000; '>//    &lt;files>      Input files to count. (short form /f)</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    If you want more control over how error messages are reported, how /help is </span>
<span style='color:#008000; '>//    dealt with, etc you can instantiate the CommandLine.Parser class.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Cheers,</span>
<span style='color:#008000; '>//    Peter Hallam</span>
<span style='color:#008000; '>//    C# Compiler Developer</span>
<span style='color:#008000; '>//    Microsoft Corp.</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    Release Notes</span>
<span style='color:#008000; '>//    -------------</span>
<span style='color:#008000; '>//</span>
<span style='color:#008000; '>//    10/02/2002 Initial Release</span>
<span style='color:#008000; '>//    10/14/2002 </span><span style='color:#ffffff; background:#808000; '>Bug Fix</span>
<span style='color:#008000; '>//    01/08/2003 </span><span style='color:#ffffff; background:#808000; '>Bug Fix in @ include files</span>
<span style='color:#008000; '>//    10/23/2004 Added user specified help text, formatting of help text to </span>
<span style='color:#008000; '>//            screen width. Added ParseHelp for /?.</span>
<span style='color:#008000; '>//    11/23/2004 Added support for default values.</span>
<span style='color:#008000; '>//    02/23/2005 </span><span style='color:#ffffff; background:#808000; '>Fix bug with short name and default arguments.</span>
<span style='color:#008000; '>//////////////////////////////////////////////////////////////////////////////</span>
<span style='color:#0000ff; font-weight:bold; '>namespace</span> CommandLine
<span style='color:#0000ff; '>{</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>Diagnostics<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>Reflection<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>Collections<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>IO<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>Text<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; font-weight:bold; '>using</span> System<span style='color:#0000ff; '>.</span>Runtime<span style='color:#0000ff; '>.</span>InteropServices<span style='color:#0000ff; '>;</span>

    <span style='color:#008000; '>/// &lt;summary></span>
    <span style='color:#008000; '>/// Used to control parsing of command line arguments.</span>
    <span style='color:#008000; '>/// &lt;/summary></span>
    <span style='color:#0000ff; '>[</span>Flags<span style='color:#0000ff; '>]</span>    
    <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>enum</span> ArgumentType
    <span style='color:#0000ff; '>{</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Indicates that this field is required. An error will be displayed</span>
        <span style='color:#008000; '>/// if it is not present when parsing arguments.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        Required    <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0x01</span><span style='color:#0000ff; '>,</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Only valid in conjunction with Multiple.</span>
        <span style='color:#008000; '>/// Duplicate values will result in an error.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        Unique      <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0x02</span><span style='color:#0000ff; '>,</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Inidicates that the argument may be specified more than once.</span>
        <span style='color:#008000; '>/// Only valid if the argument is a collection</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        Multiple    <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0x04</span><span style='color:#0000ff; '>,</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The default type for non-collection arguments.</span>
        <span style='color:#008000; '>/// The argument is not required, but an error will be reported if it is specified more than once.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        AtMostOnce  <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0x00</span><span style='color:#0000ff; '>,</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// For non-collection arguments, when the argument is specified more than</span>
        <span style='color:#008000; '>/// once no error is reported and the value of the argument is the last</span>
        <span style='color:#008000; '>/// value which occurs in the argument list.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        LastOccurenceWins <span style='color:#0000ff; '>=</span> Multiple<span style='color:#0000ff; '>,</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The default type for collection arguments.</span>
        <span style='color:#008000; '>/// The argument is permitted to occur multiple times, but duplicate </span>
        <span style='color:#008000; '>/// values will cause an error to be reported.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        MultipleUnique  <span style='color:#0000ff; '>=</span> Multiple | Unique<span style='color:#0000ff; '>,</span>
    <span style='color:#0000ff; '>}</span>
    
    <span style='color:#008000; '>/// &lt;summary></span>
    <span style='color:#008000; '>/// Allows control of command line parsing.</span>
    <span style='color:#008000; '>/// Attach this attribute to instance fields of types used</span>
    <span style='color:#008000; '>/// as the destination of command line argument parsing.</span>
    <span style='color:#008000; '>/// &lt;/summary></span>
    <span style='color:#0000ff; '>[</span>AttributeUsage<span style='color:#0000ff; '>(</span>AttributeTargets<span style='color:#0000ff; '>.</span>Field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span>
    <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>class</span> ArgumentAttribute <span style='color:#0000ff; '>:</span> Attribute
    <span style='color:#0000ff; '>{</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Allows control of command line parsing.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="type"> Specifies the error checking to be done on the argument. &lt;/param></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> ArgumentAttribute<span style='color:#0000ff; '>(</span>ArgumentType type<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>type <span style='color:#0000ff; '>=</span> type<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The error checking to be done on the argument.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> ArgumentType Type
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>type<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns true if the argument did not have an explicit short name specified.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> DefaultShortName    <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span> <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The short name of the argument.</span>
        <span style='color:#008000; '>/// Set to null means use the default short name if it does not</span>
        <span style='color:#008000; '>/// conflict with any other parameter name.</span>
        <span style='color:#008000; '>/// Set to String.Empty for no short name.</span>
        <span style='color:#008000; '>/// This property should not be set for DefaultArgumentAttributes.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> ShortName
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>set</span> <span style='color:#0000ff; '>{</span> Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>value <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span> <span style='color:#0000ff; font-weight:bold; '>is</span> DefaultArgumentAttribute<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName <span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns true if the argument did not have an explicit long name specified.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> DefaultLongName     <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span> <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The long name of the argument.</span>
        <span style='color:#008000; '>/// Set to null means use the default long name.</span>
        <span style='color:#008000; '>/// The long name for every argument must be unique.</span>
        <span style='color:#008000; '>/// It is an error to specify a long name of String.Empty.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> LongName
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>DefaultLongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>set</span> <span style='color:#0000ff; '>{</span> Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>value <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName <span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The default value of the argument.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>object</span> DefaultValue
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>set</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue <span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns true if the argument has a default value.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasDefaultValue     <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span> <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns true if the argument has help text specified.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasHelpText         <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>helpText<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span> <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The help text for the argument.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> HelpText
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>helpText<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>set</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>helpText <span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> shortName<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> longName<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> helpText<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>object</span> defaultValue<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> ArgumentType type<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; '>}</span>

    <span style='color:#008000; '>/// &lt;summary></span>
    <span style='color:#008000; '>/// Indicates that this argument is the default argument.</span>
    <span style='color:#008000; '>/// '/' or '-' prefix only the argument value is specified.</span>
    <span style='color:#008000; '>/// The ShortName property should not be set for DefaultArgumentAttribute</span>
    <span style='color:#008000; '>/// instances. The LongName property is used for usage text only and</span>
    <span style='color:#008000; '>/// does not affect the usage of the argument.</span>
    <span style='color:#008000; '>/// &lt;/summary></span>
    <span style='color:#0000ff; '>[</span>AttributeUsage<span style='color:#0000ff; '>(</span>AttributeTargets<span style='color:#0000ff; '>.</span>Field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span>
    <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>class</span> DefaultArgumentAttribute <span style='color:#0000ff; '>:</span> ArgumentAttribute
    <span style='color:#0000ff; '>{</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Indicates that this argument is the default argument.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="type"> Specifies the error checking to be done on the argument. &lt;/param></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> DefaultArgumentAttribute<span style='color:#0000ff; '>(</span>ArgumentType type<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>:</span> <span style='color:#0000ff; font-weight:bold; '>base</span> <span style='color:#0000ff; '>(</span>type<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
        <span style='color:#0000ff; '>}</span>
    <span style='color:#0000ff; '>}</span>

    <span style='color:#008000; '>/// &lt;summary></span>
    <span style='color:#008000; '>/// A delegate used in error reporting.</span>
    <span style='color:#008000; '>/// &lt;/summary></span>
    <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>delegate</span> <span style='color:#0000ff; font-weight:bold; '>void</span> ErrorReporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> message<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

    <span style='color:#008000; '>/// &lt;summary></span>
    <span style='color:#008000; '>/// Parser for command line arguments.</span>
    <span style='color:#008000; '>///</span>
    <span style='color:#008000; '>/// The parser specification is infered from the instance fields of the object</span>
    <span style='color:#008000; '>/// specified as the destination of the parse.</span>
    <span style='color:#008000; '>/// Valid argument types are: int, uint, string, bool, enums</span>
    <span style='color:#008000; '>/// Also argument types of Array of the above types are also valid.</span>
    <span style='color:#008000; '>/// </span>
    <span style='color:#008000; '>/// Error checking options can be controlled by adding a ArgumentAttribute</span>
    <span style='color:#008000; '>/// to the instance fields of the destination object.</span>
    <span style='color:#008000; '>///</span>
    <span style='color:#008000; '>/// At most one field may be marked with the DefaultArgumentAttribute</span>
    <span style='color:#008000; '>/// indicating that arguments without a '-' or '/' prefix will be parsed as that argument.</span>
    <span style='color:#008000; '>///</span>
    <span style='color:#008000; '>/// If not specified then the parser will infer default options for parsing each</span>
    <span style='color:#008000; '>/// instance field. The default long name of the argument is the field name. The</span>
    <span style='color:#008000; '>/// default short name is the first character of the long name. Long names and explicitly</span>
    <span style='color:#008000; '>/// specified short names must be unique. Default short names will be used provided that</span>
    <span style='color:#008000; '>/// the default short name does not conflict with a long name or an explicitly</span>
    <span style='color:#008000; '>/// specified short name.</span>
    <span style='color:#008000; '>///</span>
    <span style='color:#008000; '>/// Arguments which are array types are collection arguments. Collection</span>
    <span style='color:#008000; '>/// arguments can be specified multiple times.</span>
    <span style='color:#008000; '>/// &lt;/summary></span>
    <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>sealed</span> <span style='color:#0000ff; font-weight:bold; '>class</span> Parser
    <span style='color:#0000ff; '>{</span>
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// The System Defined new line string.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>string</span> NewLine <span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>\r\n</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>;</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Don't ever call this.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> Parser<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Parses Command Line Arguments. Displays usage message to Console.Out</span>
        <span style='color:#008000; '>/// if /?, /help or invalid arguments are encounterd.</span>
        <span style='color:#008000; '>/// Errors are output on Console.Error.</span>
        <span style='color:#008000; '>/// Use ArgumentAttributes to control parsing behaviour.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="arguments"> The actual arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="destination"> The resulting parsed arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> true if no errors were detected. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseArgumentsWithUsage<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> <span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> arguments<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>Parser<span style='color:#0000ff; '>.</span>ParseHelp<span style='color:#0000ff; '>(</span>arguments<span style='color:#0000ff; '>)</span> || <span style='color:#0000ff; '>!</span>Parser<span style='color:#0000ff; '>.</span>ParseArguments<span style='color:#0000ff; '>(</span>arguments<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#008000; '>// error encountered in arguments. Display usage message</span>
                System<span style='color:#0000ff; '>.</span>Console<span style='color:#0000ff; '>.</span>Write<span style='color:#0000ff; '>(</span>Parser<span style='color:#0000ff; '>.</span>ArgumentsUsage<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>.</span>GetType<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Parses Command Line Arguments. </span>
        <span style='color:#008000; '>/// Errors are output on Console.Error.</span>
        <span style='color:#008000; '>/// Use ArgumentAttributes to control parsing behaviour.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="arguments"> The actual arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="destination"> The resulting parsed arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> true if no errors were detected. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseArguments<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> <span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> arguments<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> Parser<span style='color:#0000ff; '>.</span>ParseArguments<span style='color:#0000ff; '>(</span>arguments<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ErrorReporter<span style='color:#0000ff; '>(</span>Console<span style='color:#0000ff; '>.</span>Error<span style='color:#0000ff; '>.</span>WriteLine<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Parses Command Line Arguments. </span>
        <span style='color:#008000; '>/// Use ArgumentAttributes to control parsing behaviour.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="arguments"> The actual arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="destination"> The resulting parsed arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="reporter"> The destination for parse errors. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> true if no errors were detected. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseArguments<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> arguments<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>,</span> ErrorReporter reporter<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            Parser parser <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> Parser<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>.</span>GetType<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> reporter<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> parser<span style='color:#0000ff; '>.</span>Parse<span style='color:#0000ff; '>(</span>arguments<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>void</span> NullErrorReporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> message<span style='color:#0000ff; '>)</span> 
        <span style='color:#0000ff; '>{</span> 
        <span style='color:#0000ff; '>}</span> 

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>class</span> HelpArgument 
        <span style='color:#0000ff; '>{</span> 
            <span style='color:#0000ff; '>[</span>ArgumentAttribute<span style='color:#0000ff; '>(</span>ArgumentType<span style='color:#0000ff; '>.</span>AtMostOnce<span style='color:#0000ff; '>,</span> ShortName<span style='color:#0000ff; '>=</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>?</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span> 
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> help <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span> 
        <span style='color:#0000ff; '>}</span> 

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Checks if a set of arguments asks for help.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="args"> Args to check for help. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> Returns true if args contains /? or /help. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseHelp<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> args<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            Parser helpParser <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> Parser<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span>HelpArgument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ErrorReporter<span style='color:#0000ff; '>(</span>NullErrorReporter<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            HelpArgument helpArgument <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> HelpArgument<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            helpParser<span style='color:#0000ff; '>.</span>Parse<span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>,</span> helpArgument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> helpArgument<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>


        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns a Usage string for command line argument parsing.</span>
        <span style='color:#008000; '>/// Use ArgumentAttributes to control parsing behaviour.</span>
        <span style='color:#008000; '>/// Formats the output to the width of the current console window.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="argumentType"> The type of the arguments to display usage for. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> Printable string containing a user friendly description of command line arguments. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>string</span> ArgumentsUsage<span style='color:#0000ff; '>(</span>Type argumentType<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>int</span> screenWidth <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>GetConsoleWindowWidth<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>screenWidth <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                screenWidth <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>80</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> ArgumentsUsage<span style='color:#0000ff; '>(</span>argumentType<span style='color:#0000ff; '>,</span> screenWidth<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns a Usage string for command line argument parsing.</span>
        <span style='color:#008000; '>/// Use ArgumentAttributes to control parsing behaviour.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="argumentType"> The type of the arguments to display usage for. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="columns"> The number of columns to format the output to. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> Printable string containing a user friendly description of command line arguments. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>string</span> ArgumentsUsage<span style='color:#0000ff; '>(</span>Type argumentType<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>int</span> columns<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>new</span> Parser<span style='color:#0000ff; '>(</span>argumentType<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>.</span>GetUsageString<span style='color:#0000ff; '>(</span>columns<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>int</span> STD_OUTPUT_HANDLE  <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>-</span><span style='color:#800000; '>11</span><span style='color:#0000ff; '>;</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>struct</span> COORD
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 x<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 y<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>struct</span> SMALL_RECT
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 Left<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 Top<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 Right<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 Bottom<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>struct</span> CONSOLE_SCREEN_BUFFER_INFO
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> COORD dwSize<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> COORD dwCursorPosition<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> Int16 wAttributes<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> SMALL_RECT srWindow<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>internal</span> COORD dwMaximumWindowSize<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; '>[</span>DllImport<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>kernel32.dll</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> EntryPoint<span style='color:#0000ff; '>=</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>GetStdHandle</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> SetLastError<span style='color:#0000ff; '>=</span><span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>,</span> CharSet<span style='color:#0000ff; '>=</span>CharSet<span style='color:#0000ff; '>.</span>Auto<span style='color:#0000ff; '>,</span> CallingConvention<span style='color:#0000ff; '>=</span>CallingConvention<span style='color:#0000ff; '>.</span>StdCall<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>extern</span> <span style='color:#0000ff; font-weight:bold; '>int</span> GetStdHandle<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span> nStdHandle<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

        <span style='color:#0000ff; '>[</span>DllImport<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>kernel32.dll</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> EntryPoint<span style='color:#0000ff; '>=</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>GetConsoleScreenBufferInfo</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> SetLastError<span style='color:#0000ff; '>=</span><span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>,</span> CharSet<span style='color:#0000ff; '>=</span>CharSet<span style='color:#0000ff; '>.</span>Auto<span style='color:#0000ff; '>,</span> CallingConvention<span style='color:#0000ff; '>=</span>CallingConvention<span style='color:#0000ff; '>.</span>StdCall<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>extern</span> <span style='color:#0000ff; font-weight:bold; '>int</span> GetConsoleScreenBufferInfo<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span> hConsoleOutput<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>ref</span> CONSOLE_SCREEN_BUFFER_INFO lpConsoleScreenBufferInfo<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Returns the number of columns in the current console window</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;returns>Returns the number of columns in the current console window&lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>int</span> GetConsoleWindowWidth<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>int</span> screenWidth<span style='color:#0000ff; '>;</span>
            CONSOLE_SCREEN_BUFFER_INFO csbi <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> CONSOLE_SCREEN_BUFFER_INFO<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>int</span> rc<span style='color:#0000ff; '>;</span>
            rc <span style='color:#0000ff; '>=</span> GetConsoleScreenBufferInfo<span style='color:#0000ff; '>(</span>GetStdHandle<span style='color:#0000ff; '>(</span>STD_OUTPUT_HANDLE<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>ref</span> csbi<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            screenWidth <span style='color:#0000ff; '>=</span> csbi<span style='color:#0000ff; '>.</span>dwSize<span style='color:#0000ff; '>.</span>x<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> screenWidth<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Searches a StringBuilder for a character</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="text"> The text to search. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="value"> The character value to search for. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="startIndex"> The index to stat searching at. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> The index of the first occurence of value or -1 if it is not found. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>int</span> IndexOf<span style='color:#0000ff; '>(</span>StringBuilder text<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>char</span> value<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>int</span> startIndex<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>for</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span> index <span style='color:#0000ff; '>=</span> startIndex<span style='color:#0000ff; '>;</span> index <span style='color:#0000ff; '>&lt;</span> text<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>;</span> index<span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>text<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> index<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>-</span><span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Searches a StringBuilder for a character in reverse</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="text"> The text to search. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="value"> The character to search for. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="startIndex"> The index to start the search at. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns>The index of the last occurence of value in text or -1 if it is not found. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>int</span> LastIndexOf<span style='color:#0000ff; '>(</span>StringBuilder text<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>char</span> value<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>int</span> startIndex<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>for</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span> index <span style='color:#0000ff; '>=</span> Math<span style='color:#0000ff; '>.</span>Min<span style='color:#0000ff; '>(</span>startIndex<span style='color:#0000ff; '>,</span> text<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>-</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> index <span style='color:#0000ff; '>></span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span> index <span style='color:#0000ff; '>-</span><span style='color:#0000ff; '>-</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>text<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> value<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> index<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>-</span><span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
 
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>int</span> spaceBeforeParam <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>2</span><span style='color:#0000ff; '>;</span>

        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Creates a new command line argument parser.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="argumentSpecification"> The type of object to  parse. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="reporter"> The destination for parse errors. &lt;/param></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> Parser<span style='color:#0000ff; '>(</span>Type argumentSpecification<span style='color:#0000ff; '>,</span> ErrorReporter reporter<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter <span style='color:#0000ff; '>=</span> reporter<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArrayList<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>argumentMap <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> Hashtable<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>FieldInfo field <span style='color:#0000ff; font-weight:bold; '>in</span> argumentSpecification<span style='color:#0000ff; '>.</span>GetFields<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>field<span style='color:#0000ff; '>.</span>IsStatic &amp;&amp; <span style='color:#0000ff; '>!</span>field<span style='color:#0000ff; '>.</span>IsInitOnly &amp;&amp; <span style='color:#0000ff; '>!</span>field<span style='color:#0000ff; '>.</span>IsLiteral<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    ArgumentAttribute attribute <span style='color:#0000ff; '>=</span> GetAttribute<span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; font-weight:bold; '>is</span> DefaultArgumentAttribute<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> Argument<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>,</span> reporter<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>.</span>Add<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>new</span> Argument<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>,</span> reporter<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#008000; '>// add explicit names to map</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>Argument argument <span style='color:#0000ff; font-weight:bold; '>in</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>argumentMap<span style='color:#0000ff; '>.</span>ContainsKey<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>argumentMap<span style='color:#0000ff; '>[</span>argument<span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>ExplicitShortName<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>ShortName <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>argumentMap<span style='color:#0000ff; '>.</span>ContainsKey<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>argumentMap<span style='color:#0000ff; '>[</span>argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                    <span style='color:#0000ff; '>{</span>
                        argument<span style='color:#0000ff; '>.</span>ClearShortName<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#008000; '>// add implicit names which don't collide to map</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>Argument argument <span style='color:#0000ff; font-weight:bold; '>in</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>argument<span style='color:#0000ff; '>.</span>ExplicitShortName<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>ShortName <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span> &amp;&amp; <span style='color:#0000ff; '>!</span>argumentMap<span style='color:#0000ff; '>.</span>ContainsKey<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>argumentMap<span style='color:#0000ff; '>[</span>argument<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                        argument<span style='color:#0000ff; '>.</span>ClearShortName<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> ArgumentAttribute GetAttribute<span style='color:#0000ff; '>(</span>FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>object</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> attributes <span style='color:#0000ff; '>=</span> field<span style='color:#0000ff; '>.</span>GetCustomAttributes<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span>ArgumentAttribute<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>attributes<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span>ArgumentAttribute<span style='color:#0000ff; '>)</span> attributes<span style='color:#0000ff; '>[</span><span style='color:#800000; '>0</span><span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>;</span>

            Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>attributes<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>void</span> ReportUnrecognizedArgument<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> argument<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Unrecognized command line argument '{0}'</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> argument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Parses an argument list into an object</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="args">&lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="destination">&lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> true if an error occurred &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseArgumentList<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> args<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>bool</span> hadError <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>args <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> argument <span style='color:#0000ff; font-weight:bold; '>in</span> args<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>switch</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>[</span><span style='color:#800000; '>0</span><span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            <span style='color:#0000ff; font-weight:bold; '>case</span> <span style='color:#0000e6; '>'-'</span><span style='color:#0000ff; '>:</span>
                            <span style='color:#0000ff; font-weight:bold; '>case</span> <span style='color:#0000e6; '>'/'</span><span style='color:#0000ff; '>:</span>
                                <span style='color:#0000ff; font-weight:bold; '>int</span> endIndex <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>.</span>IndexOfAny<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>new</span> <span style='color:#0000ff; font-weight:bold; '>char</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>{</span><span style='color:#0000e6; '>':'</span><span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>'+'</span><span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>'-'</span><span style='color:#0000ff; '>}</span><span style='color:#0000ff; '>,</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>string</span> option <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>.</span>Substring<span style='color:#0000ff; '>(</span><span style='color:#800000; '>1</span><span style='color:#0000ff; '>,</span> endIndex <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>-</span><span style='color:#800000; '>1</span> ? argument<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>-</span> <span style='color:#800000; '>1</span> <span style='color:#0000ff; '>:</span> endIndex <span style='color:#0000ff; '>-</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>string</span> optionArgument<span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>option<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>+</span> <span style='color:#800000; '>1</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    optionArgument <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>1</span> <span style='color:#0000ff; '>+</span> option<span style='color:#0000ff; '>.</span>Length &amp;&amp; argument<span style='color:#0000ff; '>[</span><span style='color:#800000; '>1</span> <span style='color:#0000ff; '>+</span> option<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>':'</span><span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    optionArgument <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>.</span>Substring<span style='color:#0000ff; '>(</span>option<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>+</span> <span style='color:#800000; '>2</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>else</span>
                                <span style='color:#0000ff; '>{</span>
                                    optionArgument <span style='color:#0000ff; '>=</span> argument<span style='color:#0000ff; '>.</span>Substring<span style='color:#0000ff; '>(</span>option<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>+</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                
                                Argument arg <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span>Argument<span style='color:#0000ff; '>)</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>argumentMap<span style='color:#0000ff; '>[</span>option<span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>arg <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    ReportUnrecognizedArgument<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                    hadError <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>else</span>
                                <span style='color:#0000ff; '>{</span>
                                    hadError |<span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>!</span>arg<span style='color:#0000ff; '>.</span>SetValue<span style='color:#0000ff; '>(</span>optionArgument<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>break</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>case</span> <span style='color:#0000e6; '>'@'</span><span style='color:#0000ff; '>:</span>
                                <span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> nestedArguments<span style='color:#0000ff; '>;</span>
                                hadError |<span style='color:#0000ff; '>=</span> LexFileArguments<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>.</span>Substring<span style='color:#0000ff; '>(</span><span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>out</span> nestedArguments<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                hadError |<span style='color:#0000ff; '>=</span> ParseArgumentList<span style='color:#0000ff; '>(</span>nestedArguments<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>break</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>default</span><span style='color:#0000ff; '>:</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    hadError |<span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument<span style='color:#0000ff; '>.</span>SetValue<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>else</span>
                                <span style='color:#0000ff; '>{</span>
                                    ReportUnrecognizedArgument<span style='color:#0000ff; '>(</span>argument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                    hadError <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>break</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>return</span> hadError<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Parses an argument list.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;param name="args"> The arguments to parse. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;param name="destination"> The destination of the parsed arguments. &lt;/param></span>
        <span style='color:#008000; '>/// &lt;returns> true if no parse errors were encountered. &lt;/returns></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> Parse<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> args<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>bool</span> hadError <span style='color:#0000ff; '>=</span> ParseArgumentList<span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>,</span> destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

            <span style='color:#008000; '>// check for missing required arguments</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>Argument arg <span style='color:#0000ff; font-weight:bold; '>in</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                hadError |<span style='color:#0000ff; '>=</span> arg<span style='color:#0000ff; '>.</span>Finish<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                hadError |<span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument<span style='color:#0000ff; '>.</span>Finish<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>!</span>hadError<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>struct</span> ArgumentHelpStrings
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>public</span> ArgumentHelpStrings<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> syntax<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>string</span> help<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>syntax <span style='color:#0000ff; '>=</span> syntax<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>help <span style='color:#0000ff; '>=</span> help<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> syntax<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> help<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// A user firendly usage string describing the command line argument syntax.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> GetUsageString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span> screenWidth<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            ArgumentHelpStrings<span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> strings <span style='color:#0000ff; '>=</span> GetAllHelpStrings<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>int</span> maxParamLen <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>ArgumentHelpStrings helpString <span style='color:#0000ff; font-weight:bold; '>in</span> strings<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                maxParamLen <span style='color:#0000ff; '>=</span> Math<span style='color:#0000ff; '>.</span>Max<span style='color:#0000ff; '>(</span>maxParamLen<span style='color:#0000ff; '>,</span> helpString<span style='color:#0000ff; '>.</span>syntax<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>int</span> minimumNumberOfCharsForHelpText <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>10</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>int</span> minimumHelpTextColumn <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>5</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>int</span> minimumScreenWidth <span style='color:#0000ff; '>=</span> minimumHelpTextColumn <span style='color:#0000ff; '>+</span> minimumNumberOfCharsForHelpText<span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>int</span> helpTextColumn<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>int</span> idealMinimumHelpTextColumn <span style='color:#0000ff; '>=</span> maxParamLen <span style='color:#0000ff; '>+</span> spaceBeforeParam<span style='color:#0000ff; '>;</span>
            screenWidth <span style='color:#0000ff; '>=</span> Math<span style='color:#0000ff; '>.</span>Max<span style='color:#0000ff; '>(</span>screenWidth<span style='color:#0000ff; '>,</span> minimumScreenWidth<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>screenWidth <span style='color:#0000ff; '>&lt;</span> <span style='color:#0000ff; '>(</span>idealMinimumHelpTextColumn <span style='color:#0000ff; '>+</span> minimumNumberOfCharsForHelpText<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                helpTextColumn <span style='color:#0000ff; '>=</span> minimumHelpTextColumn<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>else</span>
                helpTextColumn <span style='color:#0000ff; '>=</span> idealMinimumHelpTextColumn<span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>const</span> <span style='color:#0000ff; font-weight:bold; '>string</span> newLine <span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>\n</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>;</span>
            StringBuilder builder <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> StringBuilder<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>ArgumentHelpStrings helpStrings <span style='color:#0000ff; font-weight:bold; '>in</span> strings<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#008000; '>// add syntax string</span>
                <span style='color:#0000ff; font-weight:bold; '>int</span> syntaxLength <span style='color:#0000ff; '>=</span> helpStrings<span style='color:#0000ff; '>.</span>syntax<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>;</span>
                builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>helpStrings<span style='color:#0000ff; '>.</span>syntax<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                
                <span style='color:#008000; '>// start help text on new line if syntax string is too long</span>
                <span style='color:#0000ff; font-weight:bold; '>int</span> currentColumn <span style='color:#0000ff; '>=</span> syntaxLength<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>syntaxLength <span style='color:#0000ff; '>></span><span style='color:#0000ff; '>=</span> helpTextColumn<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>newLine<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    currentColumn <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                
                <span style='color:#008000; '>// add help text broken on spaces</span>
                <span style='color:#0000ff; font-weight:bold; '>int</span> charsPerLine <span style='color:#0000ff; '>=</span> screenWidth <span style='color:#0000ff; '>-</span> helpTextColumn<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>int</span> index <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span>index <span style='color:#0000ff; '>&lt;</span> helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#008000; '>// tab to start column</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>' '</span><span style='color:#0000ff; '>,</span> helpTextColumn <span style='color:#0000ff; '>-</span> currentColumn<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    currentColumn <span style='color:#0000ff; '>=</span> helpTextColumn<span style='color:#0000ff; '>;</span>
                    
                    <span style='color:#008000; '>// find number of chars to display on this line</span>
                    <span style='color:#0000ff; font-weight:bold; '>int</span> endIndex <span style='color:#0000ff; '>=</span> index <span style='color:#0000ff; '>+</span> charsPerLine<span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>endIndex <span style='color:#0000ff; '>></span><span style='color:#0000ff; '>=</span> helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#008000; '>// rest of text fits on this line</span>
                        endIndex <span style='color:#0000ff; '>=</span> helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>Length<span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                    <span style='color:#0000ff; '>{</span>
                        endIndex <span style='color:#0000ff; '>=</span> helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>LastIndexOf<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>' '</span><span style='color:#0000ff; '>,</span> endIndex <span style='color:#0000ff; '>-</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>,</span> Math<span style='color:#0000ff; '>.</span>Min<span style='color:#0000ff; '>(</span>endIndex <span style='color:#0000ff; '>-</span> index<span style='color:#0000ff; '>,</span> charsPerLine<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>endIndex <span style='color:#0000ff; '>&lt;</span><span style='color:#0000ff; '>=</span> index<span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            <span style='color:#008000; '>// no spaces on this line, append full set of chars</span>
                            endIndex <span style='color:#0000ff; '>=</span> index <span style='color:#0000ff; '>+</span> charsPerLine<span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; '>}</span>
                    
                    <span style='color:#008000; '>// add chars</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>,</span> index<span style='color:#0000ff; '>,</span> endIndex <span style='color:#0000ff; '>-</span> index<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    index <span style='color:#0000ff; '>=</span> endIndex<span style='color:#0000ff; '>;</span>
                    
                    <span style='color:#008000; '>// do new line</span>
                    AddNewLine<span style='color:#0000ff; '>(</span>newLine<span style='color:#0000ff; '>,</span> builder<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>ref</span> currentColumn<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

                    <span style='color:#008000; '>// don't start a new line with spaces</span>
                    <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span>index <span style='color:#0000ff; '>&lt;</span> helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>Length &amp;&amp; helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>' '</span><span style='color:#0000ff; '>)</span>
                        index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>

                <span style='color:#008000; '>// add newline if there's no help text                </span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>helpStrings<span style='color:#0000ff; '>.</span>help<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>newLine<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>return</span> builder<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>void</span> AddNewLine<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> newLine<span style='color:#0000ff; '>,</span> StringBuilder builder<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>ref</span> <span style='color:#0000ff; font-weight:bold; '>int</span> currentColumn<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>newLine<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            currentColumn <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> ArgumentHelpStrings<span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> GetAllHelpStrings<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            ArgumentHelpStrings<span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> strings <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArgumentHelpStrings<span style='color:#0000ff; '>[</span>NumberOfParametersToDisplay<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>int</span> index <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>Argument arg <span style='color:#0000ff; font-weight:bold; '>in</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                strings<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> GetHelpStrings<span style='color:#0000ff; '>(</span>arg<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                index<span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            strings<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArgumentHelpStrings<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>@&lt;file></span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Read response file for more options</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
                strings<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span> GetHelpStrings<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

            <span style='color:#0000ff; font-weight:bold; '>return</span> strings<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> ArgumentHelpStrings GetHelpStrings<span style='color:#0000ff; '>(</span>Argument arg<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArgumentHelpStrings<span style='color:#0000ff; '>(</span>arg<span style='color:#0000ff; '>.</span>SyntaxHelp<span style='color:#0000ff; '>,</span> arg<span style='color:#0000ff; '>.</span>FullHelpText<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>int</span> NumberOfParametersToDisplay<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>int</span> numberOfParameters <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>arguments<span style='color:#0000ff; '>.</span>Count <span style='color:#0000ff; '>+</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>HasDefaultArgument<span style='color:#0000ff; '>)</span>
                numberOfParameters <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> numberOfParameters<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#008000; '>/// &lt;summary></span>
        <span style='color:#008000; '>/// Does this parser have a default argument.</span>
        <span style='color:#008000; '>/// &lt;/summary></span>
        <span style='color:#008000; '>/// &lt;value> Does this parser have a default argument. &lt;/value></span>
        <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasDefaultArgument
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultArgument <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> LexFileArguments<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> fileName<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>out</span> <span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span> arguments<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>string</span> args  <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
                    
            <span style='color:#0000ff; font-weight:bold; '>try</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>using</span> <span style='color:#0000ff; '>(</span>FileStream file <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> FileStream<span style='color:#0000ff; '>(</span>fileName<span style='color:#0000ff; '>,</span> FileMode<span style='color:#0000ff; '>.</span>Open<span style='color:#0000ff; '>,</span> FileAccess<span style='color:#0000ff; '>.</span>Read<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    args <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>new</span> StreamReader<span style='color:#0000ff; '>(</span>file<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>.</span>ReadToEnd<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>catch</span> <span style='color:#0000ff; '>(</span>Exception e<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Error: Can't open command line argument file '{0}' : '{1}'</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> fileName<span style='color:#0000ff; '>,</span> e<span style='color:#0000ff; '>.</span>Message<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                arguments <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>bool</span> hadError <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>                    
            ArrayList argArray <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArrayList<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            StringBuilder currentArg <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> StringBuilder<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>bool</span> inQuotes <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>int</span> index <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
            
            <span style='color:#008000; '>// while (index &lt; args.Length)</span>
            <span style='color:#0000ff; font-weight:bold; '>try</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#008000; '>// skip whitespace</span>
                    <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>char</span><span style='color:#0000ff; '>.</span>IsWhiteSpace<span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    
                    <span style='color:#008000; '>// # - comment to end of line</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>'#'</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> '\n'<span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>continue</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    
                    <span style='color:#008000; '>// do one argument</span>
                    <span style='color:#0000ff; font-weight:bold; '>do</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> '\\'<span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            <span style='color:#0000ff; font-weight:bold; '>int</span> cSlashes <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                            index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span>index <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> args<span style='color:#0000ff; '>.</span>Length &amp;&amp; args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> '\\'<span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                cSlashes <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; '>}</span>

                            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>index <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> args<span style='color:#0000ff; '>.</span>Length || args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>'"'</span><span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                currentArg<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>'\\'<span style='color:#0000ff; '>,</span> cSlashes<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; font-weight:bold; '>else</span>
                            <span style='color:#0000ff; '>{</span>
                                currentArg<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>'\\'<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; '>(</span>cSlashes <span style='color:#0000ff; '>></span><span style='color:#0000ff; '>></span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#800000; '>0</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span>cSlashes &amp; <span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    currentArg<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>'"'</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                                <span style='color:#0000ff; font-weight:bold; '>else</span>
                                <span style='color:#0000ff; '>{</span>
                                    inQuotes <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>!</span>inQuotes<span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>'"'</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            inQuotes <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>!</span>inQuotes<span style='color:#0000ff; '>;</span>
                            index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span>
                        <span style='color:#0000ff; '>{</span>
                            currentArg<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                            index <span style='color:#0000ff; '>+</span><span style='color:#0000ff; '>=</span> <span style='color:#800000; '>1</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; '>}</span> <span style='color:#0000ff; font-weight:bold; '>while</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>char</span><span style='color:#0000ff; '>.</span>IsWhiteSpace<span style='color:#0000ff; '>(</span>args<span style='color:#0000ff; '>[</span>index<span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>)</span> || inQuotes<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    argArray<span style='color:#0000ff; '>.</span>Add<span style='color:#0000ff; '>(</span>currentArg<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    currentArg<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>=</span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; font-weight:bold; '>catch</span> <span style='color:#0000ff; '>(</span>System<span style='color:#0000ff; '>.</span>IndexOutOfRangeException<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#008000; '>// got EOF </span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>inQuotes<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Error: Unbalanced '\"' in command line argument file '{0}'</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> fileName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    hadError <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>currentArg<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#008000; '>// valid argument can be terminated by EOF</span>
                    argArray<span style='color:#0000ff; '>.</span>Add<span style='color:#0000ff; '>(</span>currentArg<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            arguments <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>[</span><span style='color:#0000ff; '>]</span><span style='color:#0000ff; '>)</span> argArray<span style='color:#0000ff; '>.</span>ToArray<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>typeof</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> hadError<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>string</span> LongName<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || attribute<span style='color:#0000ff; '>.</span>DefaultLongName<span style='color:#0000ff; '>)</span> ? field<span style='color:#0000ff; '>.</span>Name <span style='color:#0000ff; '>:</span> attribute<span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>string</span> ShortName<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; font-weight:bold; '>is</span> DefaultArgumentAttribute<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>ExplicitShortName<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> LongName<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>.</span>Substring<span style='color:#0000ff; '>(</span><span style='color:#800000; '>0</span><span style='color:#0000ff; '>,</span><span style='color:#800000; '>1</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> attribute<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>string</span> HelpText<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> attribute<span style='color:#0000ff; '>.</span>HelpText<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasHelpText<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; attribute<span style='color:#0000ff; '>.</span>HasHelpText<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ExplicitShortName<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; <span style='color:#0000ff; '>!</span>attribute<span style='color:#0000ff; '>.</span>DefaultShortName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>object</span> DefaultValue<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || <span style='color:#0000ff; '>!</span>attribute<span style='color:#0000ff; '>.</span>HasDefaultValue<span style='color:#0000ff; '>)</span> ? <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>:</span> attribute<span style='color:#0000ff; '>.</span>DefaultValue<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>

        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> Type ElementType<span style='color:#0000ff; '>(</span>FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>IsCollectionType<span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>.</span>FieldType<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> field<span style='color:#0000ff; '>.</span>FieldType<span style='color:#0000ff; '>.</span>GetElementType<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> ArgumentType Flags<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>attribute <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> attribute<span style='color:#0000ff; '>.</span>Type<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>IsCollectionType<span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>.</span>FieldType<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> ArgumentType<span style='color:#0000ff; '>.</span>MultipleUnique<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> ArgumentType<span style='color:#0000ff; '>.</span>AtMostOnce<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> IsCollectionType<span style='color:#0000ff; '>(</span>Type type<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> type<span style='color:#0000ff; '>.</span>IsArray<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
            
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>static</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> IsValidElementType<span style='color:#0000ff; '>(</span>Type type<span style='color:#0000ff; '>)</span>
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>return</span> type <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; <span style='color:#0000ff; '>(</span>
                type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span><span style='color:#0000ff; '>)</span> ||
                type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>uint</span><span style='color:#0000ff; '>)</span> ||
                type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>)</span> ||
                type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span> ||
                type<span style='color:#0000ff; '>.</span>IsEnum<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; '>[</span>System<span style='color:#0000ff; '>.</span>Diagnostics<span style='color:#0000ff; '>.</span>DebuggerDisplay<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Name = {LongName}</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>]</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>class</span> Argument
        <span style='color:#0000ff; '>{</span>
            <span style='color:#0000ff; font-weight:bold; '>public</span> Argument<span style='color:#0000ff; '>(</span>ArgumentAttribute attribute<span style='color:#0000ff; '>,</span> FieldInfo field<span style='color:#0000ff; '>,</span> ErrorReporter reporter<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>explicitShortName <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>ExplicitShortName<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>hasHelpText <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>HasHelpText<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>helpText <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>HelpText<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue <span style='color:#0000ff; '>=</span> Parser<span style='color:#0000ff; '>.</span>DefaultValue<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>elementType <span style='color:#0000ff; '>=</span> ElementType<span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>flags <span style='color:#0000ff; '>=</span> Flags<span style='color:#0000ff; '>(</span>attribute<span style='color:#0000ff; '>,</span> field<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>field <span style='color:#0000ff; '>=</span> field<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>seenValue <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter <span style='color:#0000ff; '>=</span> reporter<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>isDefault <span style='color:#0000ff; '>=</span> attribute <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; attribute <span style='color:#0000ff; font-weight:bold; '>is</span> DefaultArgumentAttribute<span style='color:#0000ff; '>;</span>
                
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>IsCollection<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>collectionValues <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> ArrayList<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> &amp;&amp; <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>isDefault || <span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>ExplicitShortName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>IsCollection || AllowMultiple<span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Collection arguments must have allow multiple</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>Unique || IsCollection<span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Unique only applicable to collection arguments</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>IsValidElementType<span style='color:#0000ff; '>(</span>Type<span style='color:#0000ff; '>)</span> ||
                    IsCollectionType<span style='color:#0000ff; '>(</span>Type<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>(</span>IsCollection &amp;&amp; IsValidElementType<span style='color:#0000ff; '>(</span>elementType<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span> ||
                    <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>IsCollection &amp;&amp; elementType <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsRequired &amp;&amp; <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasDefaultValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Required arguments cannot have default value</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasDefaultValue || <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue<span style='color:#0000ff; '>.</span>GetType<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span> <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> field<span style='color:#0000ff; '>.</span>FieldType<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>,</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Type of default value must match field type</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> Finish<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>SeenValue<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsCollection<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>field<span style='color:#0000ff; '>.</span>SetValue<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>collectionValues<span style='color:#0000ff; '>.</span>ToArray<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>elementType<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasDefaultValue<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>field<span style='color:#0000ff; '>.</span>SetValue<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>DefaultValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
                
                <span style='color:#0000ff; font-weight:bold; '>return</span> ReportMissingRequiredArgument<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ReportMissingRequiredArgument<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsRequired &amp;&amp; <span style='color:#0000ff; '>!</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>SeenValue<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsDefault<span style='color:#0000ff; '>)</span>
                        reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Missing required argument '&lt;{0}>'.</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                        reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Missing required argument '/{0}'.</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>void</span> ReportDuplicateArgumentValue<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> value<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Duplicate '{0}' argument '{1}'</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>,</span> value<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> SetValue<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> value<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> destination<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>SeenValue &amp;&amp; <span style='color:#0000ff; '>!</span>AllowMultiple<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Duplicate '{0}' argument</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>seenValue <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                
                <span style='color:#0000ff; font-weight:bold; '>object</span> newValue<span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>ParseValue<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>ValueType<span style='color:#0000ff; '>,</span> value<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>out</span> newValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsCollection<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>Unique &amp;&amp; <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>collectionValues<span style='color:#0000ff; '>.</span>Contains<span style='color:#0000ff; '>(</span>newValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        ReportDuplicateArgumentValue<span style='color:#0000ff; '>(</span>value<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>collectionValues<span style='color:#0000ff; '>.</span>Add<span style='color:#0000ff; '>(</span>newValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>field<span style='color:#0000ff; '>.</span>SetValue<span style='color:#0000ff; '>(</span>destination<span style='color:#0000ff; '>,</span> newValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> Type ValueType
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsCollection ? <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>elementType <span style='color:#0000ff; '>:</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>Type<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>void</span> ReportBadArgumentValue<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> value<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>reporter<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>.</span>Format<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>'{0}' is not a valid value for the '{1}' command line option</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>,</span> value<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ParseValue<span style='color:#0000ff; '>(</span>Type type<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>string</span> stringData<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>out</span> <span style='color:#0000ff; font-weight:bold; '>object</span> value<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#008000; '>// null is only valid for bool variables</span>
                <span style='color:#008000; '>// empty string is never valid</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>(</span>stringData <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span> &amp;&amp; <span style='color:#0000ff; '>(</span>stringData <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || stringData<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>try</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            value <span style='color:#0000ff; '>=</span> stringData<span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>stringData <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span> || stringData <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>+</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                value <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>stringData <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>-</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                value <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            value <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>int</span><span style='color:#0000ff; '>.</span>Parse<span style='color:#0000ff; '>(</span>stringData<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>type <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>uint</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            value <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>int</span><span style='color:#0000ff; '>.</span>Parse<span style='color:#0000ff; '>(</span>stringData<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span>
                        <span style='color:#0000ff; '>{</span>
                            Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>type<span style='color:#0000ff; '>.</span>IsEnum<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

                            <span style='color:#0000ff; font-weight:bold; '>bool</span> valid <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span> name <span style='color:#0000ff; font-weight:bold; '>in</span> Enum<span style='color:#0000ff; '>.</span>GetNames<span style='color:#0000ff; '>(</span>type<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>name <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> stringData<span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    valid <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                                    <span style='color:#0000ff; font-weight:bold; '>break</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>valid<span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                value <span style='color:#0000ff; '>=</span> Enum<span style='color:#0000ff; '>.</span>Parse<span style='color:#0000ff; '>(</span>type<span style='color:#0000ff; '>,</span> stringData<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>catch</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#008000; '>// catch parse errors</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
                                
                ReportBadArgumentValue<span style='color:#0000ff; '>(</span>stringData<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                value <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>void</span> AppendValue<span style='color:#0000ff; '>(</span>StringBuilder builder<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>object</span> value<span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>value <span style='color:#0000ff; font-weight:bold; '>is</span> <span style='color:#0000ff; font-weight:bold; '>string</span> || value <span style='color:#0000ff; font-weight:bold; '>is</span> <span style='color:#0000ff; font-weight:bold; '>int</span> || value <span style='color:#0000ff; font-weight:bold; '>is</span> <span style='color:#0000ff; font-weight:bold; '>uint</span> || value<span style='color:#0000ff; '>.</span>GetType<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>.</span>IsEnum<span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>value<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>value <span style='color:#0000ff; font-weight:bold; '>is</span> <span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span>
                <span style='color:#0000ff; '>{</span>
                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span> value ? <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>+</span><span style='color:#0000e6; '>"</span> <span style='color:#0000ff; '>:</span> <span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>-</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; font-weight:bold; '>else</span>
                <span style='color:#0000ff; '>{</span>
                    <span style='color:#0000ff; font-weight:bold; '>bool</span> first <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>object</span> o <span style='color:#0000ff; font-weight:bold; '>in</span> <span style='color:#0000ff; '>(</span>System<span style='color:#0000ff; '>.</span>Array<span style='color:#0000ff; '>)</span> value<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>!</span>first<span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>, </span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        AppendValue<span style='color:#0000ff; '>(</span>builder<span style='color:#0000ff; '>,</span> o<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        first <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> LongName
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>longName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> ExplicitShortName
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>explicitShortName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> ShortName
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasShortName
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>void</span> ClearShortName<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span>
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>shortName <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>null</span><span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasHelpText
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>hasHelpText<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> HelpText
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>helpText<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>object</span> DefaultValue
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> HasDefaultValue
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>null</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>defaultValue<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> FullHelpText
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span>
                    StringBuilder builder <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> StringBuilder<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasHelpText<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HelpText<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasDefaultValue<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>builder<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '> </span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>Default value:'</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        AppendValue<span style='color:#0000ff; '>(</span>builder<span style='color:#0000ff; '>,</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>DefaultValue<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>'\'</span>'<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>HasShortName<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>builder<span style='color:#0000ff; '>.</span>Length <span style='color:#0000ff; '>></span> <span style='color:#800000; '>0</span><span style='color:#0000ff; '>)</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '> </span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>(short form /</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>ShortName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>)</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>return</span> builder<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>string</span> SyntaxHelp
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span>
                <span style='color:#0000ff; '>{</span>
                    StringBuilder builder <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>new</span> StringBuilder<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>IsDefault<span style='color:#0000ff; '>)</span>
                    <span style='color:#0000ff; '>{</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>&lt;</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>></span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                    <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                    <span style='color:#0000ff; '>{</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>/</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>LongName<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        Type valueType <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>ValueType<span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>valueType <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>int</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>:&lt;int></span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>valueType <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>uint</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>:&lt;uint></span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>valueType <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>bool</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>[+|-]</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span> <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>valueType <span style='color:#0000ff; '>=</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>typeof</span><span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>string</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                        <span style='color:#0000ff; '>{</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>:&lt;string></span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                        <span style='color:#0000ff; font-weight:bold; '>else</span>
                        <span style='color:#0000ff; '>{</span>
                            Debug<span style='color:#0000ff; '>.</span>Assert<span style='color:#0000ff; '>(</span>valueType<span style='color:#0000ff; '>.</span>IsEnum<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>

                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0000e6; '>:{</span><span style='color:#0000e6; '>"</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>bool</span> first <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>true</span><span style='color:#0000ff; '>;</span>
                            <span style='color:#0000ff; font-weight:bold; '>foreach</span> <span style='color:#0000ff; '>(</span>FieldInfo field <span style='color:#0000ff; font-weight:bold; '>in</span> valueType<span style='color:#0000ff; '>.</span>GetFields<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>)</span>
                            <span style='color:#0000ff; '>{</span>
                                <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>.</span>IsStatic<span style='color:#0000ff; '>)</span>
                                <span style='color:#0000ff; '>{</span>
                                    <span style='color:#0000ff; font-weight:bold; '>if</span> <span style='color:#0000ff; '>(</span>first<span style='color:#0000ff; '>)</span>
                                        first <span style='color:#0000ff; '>=</span> <span style='color:#0000ff; font-weight:bold; '>false</span><span style='color:#0000ff; '>;</span>
                                    <span style='color:#0000ff; font-weight:bold; '>else</span>
                                        builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>'|'</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                    builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span>field<span style='color:#0000ff; '>.</span>Name<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                                <span style='color:#0000ff; '>}</span>
                            <span style='color:#0000ff; '>}</span>
                            builder<span style='color:#0000ff; '>.</span>Append<span style='color:#0000ff; '>(</span><span style='color:#0000e6; '>'}'</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                        <span style='color:#0000ff; '>}</span>
                    <span style='color:#0000ff; '>}</span>
                    
                    <span style='color:#0000ff; font-weight:bold; '>return</span> builder<span style='color:#0000ff; '>.</span>ToString<span style='color:#0000ff; '>(</span><span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span>
                <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>

            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> IsRequired
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#800000; '>0</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>flags &amp; ArgumentType<span style='color:#0000ff; '>.</span>Required<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> SeenValue
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>seenValue<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> AllowMultiple
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#800000; '>0</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>flags &amp; ArgumentType<span style='color:#0000ff; '>.</span>Multiple<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> Unique
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#800000; '>0</span> <span style='color:#0000ff; '>!</span><span style='color:#0000ff; '>=</span> <span style='color:#0000ff; '>(</span><span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>flags &amp; ArgumentType<span style='color:#0000ff; '>.</span>Unique<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> Type Type
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> field<span style='color:#0000ff; '>.</span>FieldType<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> IsCollection
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> IsCollectionType<span style='color:#0000ff; '>(</span>Type<span style='color:#0000ff; '>)</span><span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>public</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> IsDefault
            <span style='color:#0000ff; '>{</span>
                <span style='color:#0000ff; font-weight:bold; '>get</span> <span style='color:#0000ff; '>{</span> <span style='color:#0000ff; font-weight:bold; '>return</span> <span style='color:#0000ff; font-weight:bold; '>this</span><span style='color:#0000ff; '>.</span>isDefault<span style='color:#0000ff; '>;</span> <span style='color:#0000ff; '>}</span>
            <span style='color:#0000ff; '>}</span>
            
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> longName<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> shortName<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>string</span> helpText<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> hasHelpText<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> explicitShortName<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>object</span> defaultValue<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> seenValue<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> FieldInfo field<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> Type elementType<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> ArgumentType flags<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> ArrayList collectionValues<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> ErrorReporter reporter<span style='color:#0000ff; '>;</span>
            <span style='color:#0000ff; font-weight:bold; '>private</span> <span style='color:#0000ff; font-weight:bold; '>bool</span> isDefault<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; '>}</span>
        
        <span style='color:#0000ff; font-weight:bold; '>private</span> ArrayList arguments<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> Hashtable argumentMap<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> Argument defaultArgument<span style='color:#0000ff; '>;</span>
        <span style='color:#0000ff; font-weight:bold; '>private</span> ErrorReporter reporter<span style='color:#0000ff; '>;</span>
    <span style='color:#0000ff; '>}</span>
<span style='color:#0000ff; '>}</span>
</pre>
<!--Created using ToHtml.com on 2018-10-25 03:22:53 UTC -->