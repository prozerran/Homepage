<pre style='color:#000020;background:#f6f8ff;'>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Collections<span style='color:#308080; '>.</span>Generic<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>IO<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Net<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Text<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Threading<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Threading<span style='color:#308080; '>.</span>Tasks<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Web<span style='color:#406080; '>;</span>

<span style='color:#200080; font-weight:bold; '>using</span> QuickFix<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> QuickFix<span style='color:#308080; '>.</span>Fields<span style='color:#406080; '>;</span>

<span style='color:#595979; '>// </span><span style='color:#5555dd; '>http://quickfixn.org/</span>
<span style='color:#595979; '>// </span><span style='color:#5555dd; '>https://www.nuget.org/packages/QuickFix.Net.NETCore.FIX42/</span>
<span style='color:#595979; '>// </span><span style='color:#5555dd; '>http://quickfixn.org/tutorial/creating-an-application</span>
<span style='color:#595979; '>// </span><span style='color:#5555dd; '>http://quickfixn.org/tutorial/example-applications</span>

<span style='color:#200080; font-weight:bold; '>namespace</span> TopNugetPackages
<span style='color:#406080; '>{</span>
    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> HttpServer <span style='color:#308080; '>:</span> IDisposable
    <span style='color:#406080; '>{</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>readonly</span> HttpListener _httpListener<span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> Thread _connectionThread<span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> Boolean _running<span style='color:#308080; '>,</span> _disposed<span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>readonly</span> SessionSettings _sessionSettings<span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> StringBuilder _sbHtmlHeader<span style='color:#406080; '>;</span>


        <span style='color:#200080; font-weight:bold; '>public</span> HttpServer<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> prefix<span style='color:#308080; '>,</span> SessionSettings settings<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>HttpListener<span style='color:#308080; '>.</span>IsSupported<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#595979; '>// Requires at least a Windows XP with Service Pack 2</span>
                <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> NotSupportedException<span style='color:#308080; '>(</span>
                    <span style='color:#800000; '>"</span><span style='color:#1060b6; '>The Http Server cannot run on this operating system.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            _httpListener <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> HttpListener<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            _httpListener<span style='color:#308080; '>.</span>Prefixes<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span>prefix<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            _sessionSettings <span style='color:#308080; '>=</span> settings<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>_httpListener<span style='color:#308080; '>.</span>IsListening<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                _httpListener<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                _running <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                <span style='color:#595979; '>// Use a thread to listen to the Http requests</span>
                _connectionThread <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Thread<span style='color:#308080; '>(</span>ConnectionThreadStart<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                _connectionThread<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>_httpListener<span style='color:#308080; '>.</span>IsListening<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                _running <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
                _httpListener<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> ConnectionThreadStart<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>while</span> <span style='color:#308080; '>(</span>_running<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    <span style='color:#595979; '>// Grab the context and pass it to the processor methods to handle it</span>
                    HttpListenerContext context <span style='color:#308080; '>=</span> _httpListener<span style='color:#308080; '>.</span>GetContext<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    HttpListenerRequest request <span style='color:#308080; '>=</span> context<span style='color:#308080; '>.</span>Request<span style='color:#406080; '>;</span>
                    HttpListenerResponse response <span style='color:#308080; '>=</span> context<span style='color:#308080; '>.</span>Response<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>string</span> responseString<span style='color:#406080; '>;</span>

                    _sbHtmlHeader <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    _sbHtmlHeader<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='/'>HOME&lt;/A>]&amp;nbsp;[&lt;A HREF='{0}'>RELOAD&lt;/A>]&lt;/CENTER>&lt;HR/>&lt;/HEADER>&lt;BODY></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                    <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>AbsolutePath<span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> ProcessRoot<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/session</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> SessionDetails<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/resetSession</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> ResetSession<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/resetSessions</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> ResetSessions<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/refreshSession</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> RefreshSession<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/refreshSessions</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> RefreshSessions<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/enableSessions</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> EnableSessions<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/disableSessions</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> DisableSessions<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span>
                            responseString <span style='color:#308080; '>=</span> ProcessRoot<span style='color:#308080; '>(</span>request<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>

                    <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> buffer <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>responseString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    response<span style='color:#308080; '>.</span>ContentLength64 <span style='color:#308080; '>=</span> buffer<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span>
                    Stream output <span style='color:#308080; '>=</span> response<span style='color:#308080; '>.</span>OutputStream<span style='color:#406080; '>;</span>
                    output<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span>buffer<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> buffer<span style='color:#308080; '>.</span>Length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    output<span style='color:#308080; '>.</span>Close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>HttpListenerException<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>HTTP server was shut down.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> DisableSessions<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>SessionID session <span style='color:#200080; font-weight:bold; '>in</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>session<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        sessionDetails<span style='color:#308080; '>.</span>Logout<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL={0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='{0}'>Sessions&lt;/A> have been disabled&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to disable all sessions ?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}?confirm=1'>YES, disable sessions&lt;/A>]&amp;nbsp;[&lt;A HREF='/'>NO, do not disable sessions&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> EnableSessions<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>SessionID session <span style='color:#200080; font-weight:bold; '>in</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>session<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        sessionDetails<span style='color:#308080; '>.</span>Logon<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL={0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='{0}'>Sessions&lt;/A> have been enabled&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to enable all sessions ?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}?confirm=1'>YES, enable sessions&lt;/A>]&amp;nbsp;[&lt;A HREF='/'>NO, do not enable sessions&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> RefreshSession<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            SessionID sessionId <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SessionID<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>beginstring</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>sendercompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>targetcompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sessionDetails <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Session not found</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>string</span> url <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/session?</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> GetParameterList<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    sessionDetails<span style='color:#308080; '>.</span>Refresh<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL=/session?{0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='/'>HOME&lt;/A>]&amp;nbsp;[&lt;A HREF='{0}'>RELOAD&lt;/A>]&lt;/CENTER>&lt;HR/>&lt;/HEAD>&lt;BODY></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='/session?{0}'>{1}&lt;/A> has been refreshed&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>url<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to refresh session &lt;A HREF='{0}'>{1}&lt;/A>?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> url<span style='color:#308080; '>,</span> sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}&amp;confirm=1'>YES, refresh session&lt;/A>]&amp;nbsp;[&lt;A HREF='{0}'>NO, do not refresh session&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> RefreshSessions<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>SessionID session <span style='color:#200080; font-weight:bold; '>in</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>session<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        sessionDetails<span style='color:#308080; '>.</span>Refresh<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL={0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='{0}'>Sessions&lt;/A> have been refreshed&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to refresh all sessions ?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}?confirm=1'>YES, refresh sessions&lt;/A>]&amp;nbsp;[&lt;A HREF='/'>NO, do not refresh sessions&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> ResetSessions<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>SessionID session <span style='color:#200080; font-weight:bold; '>in</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>session<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        sessionDetails<span style='color:#308080; '>.</span>Reset<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Reset from WebInterface</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL={0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='{0}'>Sessions&lt;/A> have been reset&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to reset all sessions ?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}?confirm=1'>YES, reset sessions&lt;/A>]&amp;nbsp;[&lt;A HREF='/'>NO, do not reset sessions&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> ResetSession<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            SessionID sessionId <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SessionID<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>beginstring</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>sendercompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>targetcompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sessionDetails <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Session not found</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>bool</span> confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>string</span> url <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>/session?</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> GetParameterList<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    confirm <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
                    sessionDetails<span style='color:#308080; '>.</span>Reset<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Reset from WebInterface</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>confirm</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>confirm<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;HEAD>&lt;META http-equiv='refresh' content=2;URL=/session?{0} />&lt;CENTER>&lt;TITLE>QuickFIX Engine Web Interface&lt;/TITLE>&lt;H1>QuickFIX Engine Web Interface&lt;/H1>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='/'>HOME&lt;/A>]&amp;nbsp;[&lt;A HREF='{0}'>RELOAD&lt;/A>]&lt;/CENTER>&lt;HR/>&lt;/HEAD>&lt;BODY></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> urlOriginalString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>&lt;A HREF='/session?{0}'>{1}&lt;/A> has been reset&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>url<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;h2>Are you sure you want to reset session &lt;A HREF='{0}'>{1}&lt;/A>?&lt;/h2>&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> url<span style='color:#308080; '>,</span> sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='{0}&amp;confirm=1'>YES, reset session&lt;/A>]&amp;nbsp;[&lt;A HREF='{0}'>NO, do not reset session&lt;/A>]&lt;/CENTER></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>


        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> ProcessRoot<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//Session count</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;b>&lt;i>{0} Sessions managed by QuickFIX&lt;/b>&lt;/i>&lt;/CENTER>&lt;HR/></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Count<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//session management links</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>&lt;A HREF='/resetSessions{0}'>RESET&lt;/A>&amp;nbsp;&lt;A HREF='/refreshSessions'>REFRESH&lt;/A>&amp;nbsp;&lt;A HREF='/enableSessions'>ENABLE&lt;/A>&amp;nbsp;&lt;A HREF='/disableSessions'>DISABLE&lt;/A>&lt;/CENTER>&lt;HR/>&lt;/HEADER>&lt;BODY></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//Start the table generation</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;table id=\"sessionlist\" style=\"border-width:1; padding:2; width:100%\"></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Session</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Type</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Enabled</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Session Time</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Logged On</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Incoming</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Outgoing</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>SessionID session <span style='color:#200080; font-weight:bold; '>in</span> _sessionSettings<span style='color:#308080; '>.</span>GetSessions<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>session<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>String<span style='color:#308080; '>.</span>Format<span style='color:#308080; '>(</span>
                    <span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\"session?BeginString={0}&amp;SenderCompID={1}&amp;TargetCompID={2}\">{0}:{1}->{2}&lt;/a></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span>
                    session<span style='color:#308080; '>.</span>BeginString<span style='color:#308080; '>,</span> session<span style='color:#308080; '>.</span>SenderCompID<span style='color:#308080; '>,</span> session<span style='color:#308080; '>.</span>TargetCompID<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>IsInitiator ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>initiator</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>acceptor</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>IsEnabled ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>yes</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>no</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>IsSessionTime ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>yes</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>no</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>IsLoggedOn ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>yes</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>no</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>NextTargetMsgSeqNum<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>sessionDetails<span style='color:#308080; '>.</span>NextSenderMsgSeqNum<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/table></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> SessionDetails<span style='color:#308080; '>(</span>HttpListenerRequest request<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            SessionID sessionId <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SessionID<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>beginstring</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>sendercompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>,</span> request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>targetcompid</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Session sessionDetails <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sessionDetails <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Session not found</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            StringBuilder sbHtmlPageBody <span style='color:#308080; '>=</span> _sbHtmlHeader<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>string</span> url <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> urlOriginalString <span style='color:#308080; '>=</span> request<span style='color:#308080; '>.</span>Url<span style='color:#308080; '>.</span>OriginalString<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>enabled</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>enabled</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    sessionDetails<span style='color:#308080; '>.</span>Logout<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>else</span>
                    sessionDetails<span style='color:#308080; '>.</span>Logon<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>Enabled</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>next incoming</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>next incoming</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sessionDetails<span style='color:#308080; '>.</span>NextTargetMsgSeqNum <span style='color:#308080; '>=</span> value <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> value<span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>next incoming</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Outgoing</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Outgoing</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sessionDetails<span style='color:#308080; '>.</span>NextSenderMsgSeqNum <span style='color:#308080; '>=</span> value <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> value<span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Outgoing</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>SendRedundantResendRequests</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>SendRedundantResendRequests <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>SendRedundantResendRequests</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>SendRedundantResendRequests</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckCompId</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>CheckCompID <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckCompId</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckCompId</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>CheckLatency <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MaxLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MaxLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sessionDetails<span style='color:#308080; '>.</span>MaxLatency <span style='color:#308080; '>=</span> value <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> value<span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>MaxLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogonTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogonTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sessionDetails<span style='color:#308080; '>.</span>LogonTimeout <span style='color:#308080; '>=</span> value <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> value<span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogonTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogoutTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogoutTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sessionDetails<span style='color:#308080; '>.</span>LogoutTimeout <span style='color:#308080; '>=</span> value <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> value<span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogoutTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>ResetOnLogon <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>ResetOnLogout <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnDisconnect</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>ResetOnDisconnect <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnDisconnect</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnDisconnect</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>RefreshOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>RefreshOnLogon <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>RefreshOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>RefreshOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MillisecondsInTimestamp</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>MillisecondsInTimeStamp <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MillisecondsInTimestamp</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>MillisecondsInTimestamp</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>PersistMessages</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                sessionDetails<span style='color:#308080; '>.</span>PersistMessages <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToBoolean<span style='color:#308080; '>(</span>request<span style='color:#308080; '>.</span>QueryString<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>PersistMessages</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                url <span style='color:#308080; '>=</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>PersistMessages</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>


            sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>{0}&lt;/CENTER>&lt;HR/></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionId<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;CENTER>[&lt;A HREF='/resetSession?{0}'>RESET&lt;/A>]&amp;nbsp;[&lt;A HREF='/refreshSession?{0}'>REFRESH&lt;/A>]&lt;/CENTER>&lt;HR/>&lt;/HEADER>&lt;BODY></span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> GetParameterList<span style='color:#308080; '>(</span>urlOriginalString<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;table id=\"session_details\" style=\"border-width:1; padding:2; width:100%\"></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Enabled</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>IsEnabled<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ConnectionType</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>IsInitiator ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>initiator</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>acceptor</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>SessionTime</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>IsSessionTime<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LoggedOn</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>IsLoggedOn<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Incoming</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>NextTargetMsgSeqNum<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Next Outgoing</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>NextSenderMsgSeqNum<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>SendRedundantResendRequests</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>SendRedundantResendRequests<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckCompId</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>CheckCompID<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>CheckLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>CheckLatency<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MaxLatency</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>MaxLatency<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogonTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>LogonTimeout<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LogoutTimeout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>LogoutTimeout<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>ResetOnLogon<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnLogout</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>ResetOnLogout<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ResetOnDisconnect</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>ResetOnDisconnect<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>RefreshOnLogon</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>RefreshOnLogon<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MillisecondsInTimestamp</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>MillisecondsInTimeStamp<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddRow<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>PersistMessages</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> sessionDetails<span style='color:#308080; '>.</span>PersistMessages<span style='color:#308080; '>,</span> url<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            sbHtmlPageBody<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/table></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sbHtmlPageBody<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> RemoveQueryStringByKey<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> url<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> key<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> uri <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Uri<span style='color:#308080; '>(</span>url<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>// this gets all the query string key value pairs as a collection</span>
            <span style='color:#200080; font-weight:bold; '>var</span> newQueryString <span style='color:#308080; '>=</span> HttpUtility<span style='color:#308080; '>.</span>ParseQueryString<span style='color:#308080; '>(</span>uri<span style='color:#308080; '>.</span>Query<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>// this removes the key if exists</span>
            newQueryString<span style='color:#308080; '>.</span>Remove<span style='color:#308080; '>(</span>key<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>// this gets the page path from root without QueryString</span>
            <span style='color:#200080; font-weight:bold; '>string</span> pagePathWithoutQueryString <span style='color:#308080; '>=</span> uri<span style='color:#308080; '>.</span>GetLeftPart<span style='color:#308080; '>(</span>UriPartial<span style='color:#308080; '>.</span>Path<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> newQueryString<span style='color:#308080; '>.</span>Count <span style='color:#308080; '>></span> <span style='color:#008c00; '>0</span>
                ? $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>{pagePathWithoutQueryString}?{newQueryString}</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>:</span> pagePathWithoutQueryString<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> GetParameterList<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> url<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> HttpUtility<span style='color:#308080; '>.</span>ParseQueryString<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> Uri<span style='color:#308080; '>(</span>url<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Query<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> AddRow<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> colName<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span> value<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> url <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> valueAsStr <span style='color:#308080; '>=</span> value ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>yes</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>no</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> innerHtml <span style='color:#308080; '>=</span> url<span style='color:#308080; '>.</span>Length <span style='color:#308080; '>></span> <span style='color:#008c00; '>0</span>
                ? $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\" {url}&amp;{colName}={!value} \">toggle&lt;/a></span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> AddRow<span style='color:#308080; '>(</span>colName<span style='color:#308080; '>,</span> valueAsStr<span style='color:#308080; '>,</span> innerHtml<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> AddRow<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> colName<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> value<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> url <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> innerHtml <span style='color:#308080; '>=</span> $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\" {url}&amp;{colName}={value - 10} \"> &lt;&lt; &lt;/a></span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span>
                               $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\" {url}&amp;{colName}={value - 1} \"> &lt; &lt;/a></span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span>
                               <span style='color:#800000; '>"</span><span style='color:#1060b6; '> | </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span>
                               $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\" {url}&amp;{colName}={value + 1} \"> > &lt;/a></span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span>
                               $<span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;a href=\" {url}&amp;{colName}={value + 10} \"> >> &lt;/a></span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> AddRow<span style='color:#308080; '>(</span>colName<span style='color:#308080; '>,</span> value<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> innerHtml<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> AddRow<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> colName<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> value<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> innerHtml <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            StringBuilder row <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            row<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            row<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>colName<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            row<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>value<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            row<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span>AddCell<span style='color:#308080; '>(</span>innerHtml<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            row<span style='color:#308080; '>.</span>Append<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/tr></span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> row<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> AddCell<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> cellContent<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span> header <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> entryType <span style='color:#308080; '>=</span> header ? <span style='color:#800000; '>"</span><span style='color:#1060b6; '>th</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>td</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> entryType <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '> align=\"left\"></span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> cellContent <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>&lt;/</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> entryType <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>></span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        ~HttpServer<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> Dispose<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Dispose<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Dispose<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            GC<span style='color:#308080; '>.</span>SuppressFinalize<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>protected</span> <span style='color:#200080; font-weight:bold; '>virtual</span> <span style='color:#200080; font-weight:bold; '>void</span> Dispose<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>bool</span> disposing<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>_disposed<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>disposing<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>_running<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>_connectionThread <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    <span style='color:#595979; '>//_connectionThread.Abort();</span>
                    _connectionThread<span style='color:#308080; '>.</span>Join<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    _connectionThread <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
            _disposed <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
    <span style='color:#406080; '>}</span>

    <span style='color:#595979; '>/// &lt;summary></span>
    <span style='color:#595979; '>/// Just a simple server that will let you connect to it and ignore any</span>
    <span style='color:#595979; '>/// application-level messages you send to it.</span>
    <span style='color:#595979; '>/// Note that this app is *NOT* a message cracker.</span>
    <span style='color:#595979; '>/// &lt;/summary></span>

    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> SimpleAcceptorApp <span style='color:#308080; '>:</span> <span style='color:#595979; '>/*QuickFix.MessageCracker,*/</span> QuickFix<span style='color:#308080; '>.</span>IApplication
    <span style='color:#406080; '>{</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>QuickFix.Application Methods</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>IN:  </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#595979; '>//Crack(message, sessionID);</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OUT: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>IN:  </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OUT:  </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnCreate<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogout<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogon<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>
    <span style='color:#406080; '>}</span>

    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> TradeClientApp <span style='color:#308080; '>:</span> QuickFix<span style='color:#308080; '>.</span>MessageCracker<span style='color:#308080; '>,</span> QuickFix<span style='color:#308080; '>.</span>IApplication
    <span style='color:#406080; '>{</span>
        Session _session <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

        <span style='color:#595979; '>// This variable is a kludge for developer test purposes.  Don't do this on a production application.</span>
        <span style='color:#200080; font-weight:bold; '>public</span> IInitiator MyInitiator <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>IApplication interface overrides</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnCreate<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            _session <span style='color:#308080; '>=</span> Session<span style='color:#308080; '>.</span>LookupSession<span style='color:#308080; '>(</span>sessionID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogon<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Logon - </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> sessionID<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogout<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Logout - </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> sessionID<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>IN:  </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Crack<span style='color:#308080; '>(</span>message<span style='color:#308080; '>,</span> sessionID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==Cracker exception==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>StackTrace<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>bool</span> possDupFlag <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>message<span style='color:#308080; '>.</span>Header<span style='color:#308080; '>.</span>IsSetField<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>Fields<span style='color:#308080; '>.</span>Tags<span style='color:#308080; '>.</span>PossDupFlag<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    possDupFlag <span style='color:#308080; '>=</span> QuickFix<span style='color:#308080; '>.</span>Fields<span style='color:#308080; '>.</span>Converters<span style='color:#308080; '>.</span>BoolConverter<span style='color:#308080; '>.</span>Convert<span style='color:#308080; '>(</span>
                        message<span style='color:#308080; '>.</span>Header<span style='color:#308080; '>.</span>GetString<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>Fields<span style='color:#308080; '>.</span>Tags<span style='color:#308080; '>.</span>PossDupFlag<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#595979; '>/// </span><span style='color:#ffffff; background:#808000; '>FIXME</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>possDupFlag<span style='color:#308080; '>)</span>
                    <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> DoNotSend<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>FieldNotFoundException<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>

            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OUT: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>


<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>MessageCracker handlers</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>ExecutionReport m<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Received execution report</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReject m<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Received order cancel reject</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>


        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Run<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>while</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>true</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>try</span>
                <span style='color:#406080; '>{</span>
                    <span style='color:#200080; font-weight:bold; '>char</span> action <span style='color:#308080; '>=</span> QueryAction<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'1'</span><span style='color:#308080; '>)</span>
                        QueryEnterOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'2'</span><span style='color:#308080; '>)</span>
                        QueryCancelOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'3'</span><span style='color:#308080; '>)</span>
                        QueryReplaceOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'4'</span><span style='color:#308080; '>)</span>
                        QueryMarketDataRequest<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'g'</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>MyInitiator<span style='color:#308080; '>.</span>IsStopped<span style='color:#308080; '>)</span>
                        <span style='color:#406080; '>{</span>
                            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Restarting initiator...</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>MyInitiator<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        <span style='color:#406080; '>}</span>
                        <span style='color:#200080; font-weight:bold; '>else</span>
                            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Already started.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'x'</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>MyInitiator<span style='color:#308080; '>.</span>IsStopped<span style='color:#308080; '>)</span>
                            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Already stopped.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>else</span>
                        <span style='color:#406080; '>{</span>
                            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Stopping initiator...</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                            <span style='color:#200080; font-weight:bold; '>this</span><span style='color:#308080; '>.</span>MyInitiator<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        <span style='color:#406080; '>}</span>
                    <span style='color:#406080; '>}</span>
                    <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'q'</span> || action <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'Q'</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>System<span style='color:#308080; '>.</span>Exception e<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Message Not Sent: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> e<span style='color:#308080; '>.</span>Message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>StackTrace: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> e<span style='color:#308080; '>.</span>StackTrace<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Program shutdown.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> SendMessage<span style='color:#308080; '>(</span>Message m<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>_session <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
                _session<span style='color:#308080; '>.</span>Send<span style='color:#308080; '>(</span>m<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#595979; '>// This probably won't ever happen.</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Can't send message: session not created.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>char</span> QueryAction<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#595979; '>// Commands 'g' and 'x' are intentionally hidden.</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>1) Enter Order\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>2) Cancel Order\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>3) Replace Order\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>4) Market data test\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>Q) Quit\n</span><span style='color:#800000; '>"</span>
                <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>Action: </span><span style='color:#800000; '>"</span>
            <span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            HashSet<span style='color:#308080; '>&lt;</span><span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>></span> validActions <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> HashSet<span style='color:#308080; '>&lt;</span><span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1,2,3,4,q,Q,g,x</span><span style='color:#800000; '>"</span><span style='color:#308080; '>.</span>Split<span style='color:#308080; '>(</span><span style='color:#1060b6; '>','</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>string</span> cmd <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>cmd<span style='color:#308080; '>.</span>Length <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>1</span> || validActions<span style='color:#308080; '>.</span>Contains<span style='color:#308080; '>(</span>cmd<span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> System<span style='color:#308080; '>.</span>Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Invalid action</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> cmd<span style='color:#308080; '>.</span>ToCharArray<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>[</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> QueryEnterOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>\nNewOrderSingle</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>NewOrderSingle m <span style='color:#308080; '>=</span> QueryNewOrderSingle44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>m <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Send order</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                m<span style='color:#308080; '>.</span>Header<span style='color:#308080; '>.</span>GetString<span style='color:#308080; '>(</span>Tags<span style='color:#308080; '>.</span>BeginString<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                SendMessage<span style='color:#308080; '>(</span>m<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> QueryCancelOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>\nOrderCancelRequest</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelRequest m <span style='color:#308080; '>=</span> QueryOrderCancelRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>m <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Cancel order</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                SendMessage<span style='color:#308080; '>(</span>m<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> QueryReplaceOrder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>\nCancelReplaceRequest</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReplaceRequest m <span style='color:#308080; '>=</span> QueryCancelReplaceRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>m <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Send replace</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                SendMessage<span style='color:#308080; '>(</span>m<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>void</span> QueryMarketDataRequest<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>\nMarketDataRequest</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest m <span style='color:#308080; '>=</span> QueryMarketDataRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>m <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Send market data request</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                SendMessage<span style='color:#308080; '>(</span>m<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>bool</span> QueryConfirm<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> query<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>query <span style='color:#308080; '>+</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>?: </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> line <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span>line<span style='color:#308080; '>[</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>]</span><span style='color:#308080; '>.</span>Equals<span style='color:#308080; '>(</span><span style='color:#1060b6; '>'y'</span><span style='color:#308080; '>)</span> || line<span style='color:#308080; '>[</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>]</span><span style='color:#308080; '>.</span>Equals<span style='color:#308080; '>(</span><span style='color:#1060b6; '>'Y'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>Message creation functions</span>
        <span style='color:#200080; font-weight:bold; '>private</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>NewOrderSingle QueryNewOrderSingle44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            QuickFix<span style='color:#308080; '>.</span>Fields<span style='color:#308080; '>.</span>OrdType ordType <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>NewOrderSingle newOrderSingle <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>NewOrderSingle<span style='color:#308080; '>(</span>
                QueryClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySymbol<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySide<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> TransactTime<span style='color:#308080; '>(</span>DateTime<span style='color:#308080; '>.</span>Now<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                ordType <span style='color:#308080; '>=</span> QueryOrdType<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            newOrderSingle<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> HandlInst<span style='color:#308080; '>(</span><span style='color:#1060b6; '>'1'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            newOrderSingle<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryOrderQty<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            newOrderSingle<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryTimeInForce<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>LIMIT || ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>STOP_LIMIT<span style='color:#308080; '>)</span>
                newOrderSingle<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryPrice<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>STOP || ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>STOP_LIMIT<span style='color:#308080; '>)</span>
                newOrderSingle<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryStopPx<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> newOrderSingle<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelRequest QueryOrderCancelRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelRequest orderCancelRequest <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelRequest<span style='color:#308080; '>(</span>
                QueryOrigClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QueryClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySymbol<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySide<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> TransactTime<span style='color:#308080; '>(</span>DateTime<span style='color:#308080; '>.</span>Now<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            orderCancelRequest<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryOrderQty<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> orderCancelRequest<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReplaceRequest QueryCancelReplaceRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReplaceRequest ocrr <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReplaceRequest<span style='color:#308080; '>(</span>
                QueryOrigClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QueryClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySymbol<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QuerySide<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> TransactTime<span style='color:#308080; '>(</span>DateTime<span style='color:#308080; '>.</span>Now<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                QueryOrdType<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            ocrr<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> HandlInst<span style='color:#308080; '>(</span><span style='color:#1060b6; '>'1'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>New price</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                ocrr<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryPrice<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>QueryConfirm<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>New quantity</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                ocrr<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>QueryOrderQty<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> ocrr<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest QueryMarketDataRequest44<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            MDReqID mdReqID <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MDReqID<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>MARKETDATAID</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            SubscriptionRequestType subType <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SubscriptionRequestType<span style='color:#308080; '>(</span>SubscriptionRequestType<span style='color:#308080; '>.</span>SNAPSHOT<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            MarketDepth marketDepth <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MarketDepth<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest<span style='color:#308080; '>.</span>NoMDEntryTypesGroup marketDataEntryGroup <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest<span style='color:#308080; '>.</span>NoMDEntryTypesGroup<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            marketDataEntryGroup<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> MDEntryType<span style='color:#308080; '>(</span>MDEntryType<span style='color:#308080; '>.</span>BID<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest<span style='color:#308080; '>.</span>NoRelatedSymGroup symbolGroup <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest<span style='color:#308080; '>.</span>NoRelatedSymGroup<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            symbolGroup<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> Symbol<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>LNUX</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest message <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>MarketDataRequest<span style='color:#308080; '>(</span>mdReqID<span style='color:#308080; '>,</span> subType<span style='color:#308080; '>,</span> marketDepth<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            message<span style='color:#308080; '>.</span>AddGroup<span style='color:#308080; '>(</span>marketDataEntryGroup<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            message<span style='color:#308080; '>.</span>AddGroup<span style='color:#308080; '>(</span>symbolGroup<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> message<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>field query private methods</span>
        <span style='color:#200080; font-weight:bold; '>private</span> ClOrdID QueryClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>ClOrdID? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> ClOrdID<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> OrigClOrdID QueryOrigClOrdID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OrigClOrdID? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> OrigClOrdID<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> Symbol QuerySymbol<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Symbol? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> Symbol<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> Side QuerySide<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1) Buy</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>2) Sell</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>3) Sell Short</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>4) Sell Short Exempt</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>5) Cross</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>6) Cross Short</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>7) Cross Short Exempt</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Side? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> s <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>char</span> c <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>' '</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>s<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>1</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>BUY<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>2</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>SELL<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>3</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>SELL_SHORT<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>4</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>SELL_SHORT_EXEMPT<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>5</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>CROSS<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>6</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> Side<span style='color:#308080; '>.</span>CROSS_SHORT<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>7</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'A'</span><span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>unsupported input</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> Side<span style='color:#308080; '>(</span>c<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> OrdType QueryOrdType<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1) Market</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>2) Limit</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>3) Stop</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>4) Stop Limit</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OrdType? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> s <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>char</span> c <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>' '</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>s<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>1</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>2</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>3</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>STOP<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>4</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> OrdType<span style='color:#308080; '>.</span>STOP_LIMIT<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>unsupported input</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdType<span style='color:#308080; '>(</span>c<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> OrderQty QueryOrderQty<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OrderQty? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> OrderQty<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToDecimal<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> TimeInForce QueryTimeInForce<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1) Day</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>2) IOC</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>3) OPG</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>4) GTC</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>5) GTX</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>TimeInForce? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> s <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>char</span> c <span style='color:#308080; '>=</span> <span style='color:#1060b6; '>' '</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>s<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>1</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> TimeInForce<span style='color:#308080; '>.</span>DAY<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>2</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> TimeInForce<span style='color:#308080; '>.</span>IMMEDIATE_OR_CANCEL<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>3</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> TimeInForce<span style='color:#308080; '>.</span>AT_THE_OPENING<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>4</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> TimeInForce<span style='color:#308080; '>.</span>GOOD_TILL_CANCEL<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>5</span><span style='color:#800000; '>"</span><span style='color:#308080; '>:</span> c <span style='color:#308080; '>=</span> TimeInForce<span style='color:#308080; '>.</span>GOOD_TILL_CROSSING<span style='color:#406080; '>;</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> Exception<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>unsupported input</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> TimeInForce<span style='color:#308080; '>(</span>c<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> Price QueryPrice<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Price? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToDecimal<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>private</span> StopPx QueryStopPx<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>Write<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>StopPx? </span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> StopPx<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToDecimal<span style='color:#308080; '>(</span>Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>
    <span style='color:#406080; '>}</span>

    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> Executor <span style='color:#308080; '>:</span> QuickFix<span style='color:#308080; '>.</span>MessageCracker<span style='color:#308080; '>,</span> QuickFix<span style='color:#308080; '>.</span>IApplication
    <span style='color:#406080; '>{</span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>readonly</span> <span style='color:#200080; font-weight:bold; '>decimal</span> DEFAULT_MARKET_PRICE <span style='color:#308080; '>=</span> <span style='color:#008c00; '>10</span><span style='color:#406080; '>;</span>

        <span style='color:#200080; font-weight:bold; '>int</span> orderID <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>int</span> execID <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>

        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>+</span><span style='color:#308080; '>+</span>orderID<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>string</span> GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>+</span><span style='color:#308080; '>+</span>execID<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#406080; '>}</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>QuickFix.Application Methods</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>IN:  </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Crack<span style='color:#308080; '>(</span>message<span style='color:#308080; '>,</span> sessionID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToApp<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>OUT: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> FromAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnCreate<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogout<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnLogon<span style='color:#308080; '>(</span>SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> ToAdmin<span style='color:#308080; '>(</span>Message message<span style='color:#308080; '>,</span> SessionID sessionID<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#595979; '>MessageCracker overloads</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecTransType<span style='color:#308080; '>(</span>ExecTransType<span style='color:#308080; '>.</span>NEW<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                symbol<span style='color:#308080; '>,</span>
                side<span style='color:#308080; '>,</span>
                orderQty<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LastShares<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecTransType<span style='color:#308080; '>(</span>ExecTransType<span style='color:#308080; '>.</span>NEW<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecType<span style='color:#308080; '>(</span>ExecType<span style='color:#308080; '>.</span>FILL<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                symbol<span style='color:#308080; '>,</span>
                side<span style='color:#308080; '>,</span>
                orderQty<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LastShares<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LeavesQty<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecTransType<span style='color:#308080; '>(</span>ExecTransType<span style='color:#308080; '>.</span>NEW<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecType<span style='color:#308080; '>(</span>ExecType<span style='color:#308080; '>.</span>FILL<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                symbol<span style='color:#308080; '>,</span>
                side<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LeavesQty<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastShares<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecType<span style='color:#308080; '>(</span>ExecType<span style='color:#308080; '>.</span>FILL<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                symbol<span style='color:#308080; '>,</span> <span style='color:#595979; '>// Shouldn't be here?</span>
                side<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LeavesQty<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>symbol<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecType<span style='color:#308080; '>(</span>ExecType<span style='color:#308080; '>.</span>FILL<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                symbol<span style='color:#308080; '>,</span> <span style='color:#595979; '>//shouldn't be here?</span>
                side<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LeavesQty<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>symbol<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>NewOrderSingle n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Symbol symbol <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Symbol<span style='color:#406080; '>;</span>
            Side side <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Side<span style='color:#406080; '>;</span>
            OrdType ordType <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrdType<span style='color:#406080; '>;</span>
            OrderQty orderQty <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>OrderQty<span style='color:#406080; '>;</span>
            Price price <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Price<span style='color:#308080; '>(</span>DEFAULT_MARKET_PRICE<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ClOrdID clOrdID <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>ClOrdID<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>switch</span> <span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>LIMIT<span style='color:#308080; '>:</span>
                    price <span style='color:#308080; '>=</span> n<span style='color:#308080; '>.</span>Price<span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>case</span> OrdType<span style='color:#308080; '>.</span>MARKET<span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>break</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>default</span><span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> IncorrectTagValue<span style='color:#308080; '>(</span>ordType<span style='color:#308080; '>.</span>Tag<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>

            QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>ExecutionReport exReport <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>ExecutionReport<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>GenOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecID<span style='color:#308080; '>(</span>GenExecID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> ExecType<span style='color:#308080; '>(</span>ExecType<span style='color:#308080; '>.</span>FILL<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>FILLED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                side<span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> LeavesQty<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span>
                <span style='color:#200080; font-weight:bold; '>new</span> CumQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>clOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>symbol<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastQty<span style='color:#308080; '>(</span>orderQty<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> LastPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            exReport<span style='color:#308080; '>.</span>Set<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> AvgPx<span style='color:#308080; '>(</span>price<span style='color:#308080; '>.</span>getValue<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>IsSetAccount<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                exReport<span style='color:#308080; '>.</span>SetField<span style='color:#308080; '>(</span>n<span style='color:#308080; '>.</span>Account<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>exReport<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>SessionNotFound ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==session not found exception!==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>News n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>OTHER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>OTHER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancels</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>



        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX40<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX41<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REPLACE_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REPLACE_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>UNKNOWN_ORDER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REPLACE_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>OTHER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelReplaceRequest msg<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> orderid <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>msg<span style='color:#308080; '>.</span>IsSetOrderID<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span> ? msg<span style='color:#308080; '>.</span>OrderID<span style='color:#308080; '>.</span>Obj <span style='color:#308080; '>:</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>unknown orderID</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
            QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelReject ocj <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>OrderCancelReject<span style='color:#308080; '>(</span>
                <span style='color:#200080; font-weight:bold; '>new</span> OrderID<span style='color:#308080; '>(</span>orderid<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>ClOrdID<span style='color:#308080; '>,</span> msg<span style='color:#308080; '>.</span>OrigClOrdID<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> OrdStatus<span style='color:#308080; '>(</span>OrdStatus<span style='color:#308080; '>.</span>REJECTED<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejResponseTo<span style='color:#308080; '>(</span>CxlRejResponseTo<span style='color:#308080; '>.</span>ORDER_CANCEL_REPLACE_REQUEST<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>CxlRejReason <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> CxlRejReason<span style='color:#308080; '>(</span>CxlRejReason<span style='color:#308080; '>.</span>OTHER<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            ocj<span style='color:#308080; '>.</span>Text <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Text<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Executor does not support order cancel/replaces</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                Session<span style='color:#308080; '>.</span>SendToTarget<span style='color:#308080; '>(</span>ocj<span style='color:#308080; '>,</span> s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>Exception ex<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>ex<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>// FIX40-41 don't have rejects</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX42<span style='color:#308080; '>.</span>BusinessMessageReject n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX43<span style='color:#308080; '>.</span>BusinessMessageReject n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX44<span style='color:#308080; '>.</span>BusinessMessageReject n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> OnMessage<span style='color:#308080; '>(</span>QuickFix<span style='color:#308080; '>.</span>FIX50<span style='color:#308080; '>.</span>BusinessMessageReject n<span style='color:#308080; '>,</span> SessionID s<span style='color:#308080; '>)</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span><span style='color:#595979; '> //MessageCracker overloads</span>
    <span style='color:#406080; '>}</span>

    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>class</span> QuickFixMainDriver <span style='color:#308080; '>:</span> ITopNugetPackages
    <span style='color:#406080; '>{</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>const</span> <span style='color:#200080; font-weight:bold; '>string</span> HttpServerPrefix <span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#1060b6; '>http://127.0.0.1:5080/</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>readonly</span> <span style='color:#200080; font-weight:bold; '>string</span> cfgPath <span style='color:#308080; '>=</span> Directory<span style='color:#308080; '>.</span>GetCurrentDirectory<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>+</span> <span style='color:#800000; '>@"</span><span style='color:#1060b6; '>\..\..\..\Resources\simpleacc.cfg</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>readonly</span> <span style='color:#200080; font-weight:bold; '>string</span> exePath <span style='color:#308080; '>=</span> Directory<span style='color:#308080; '>.</span>GetCurrentDirectory<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>+</span> <span style='color:#800000; '>@"</span><span style='color:#1060b6; '>\..\..\..\Resources\executor.cfg</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>readonly</span> <span style='color:#200080; font-weight:bold; '>string</span> trdPath <span style='color:#308080; '>=</span> Directory<span style='color:#308080; '>.</span>GetCurrentDirectory<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>+</span> <span style='color:#800000; '>@"</span><span style='color:#1060b6; '>\..\..\..\Resources\tradeclient.cfg</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>

        <span style='color:#200080; font-weight:bold; '>public</span> QuickFixMainDriver<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// SimpleAcceptor</span>
        <span style='color:#595979; '>/// </span>
        <span style='color:#595979; '>/// Server that accepts messages from clients and print them</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> SimpleAcceptor<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>This is only an example program.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>It's a simple server (e.g. Acceptor) app that will let clients (e.g. Initiators)</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>connect to it.  It will accept and display any application-level messages that it receives.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Connecting clients should set TargetCompID to 'SIMPLE' and SenderCompID to 'CLIENT1' or 'CLIENT2'.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Port is 5001.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>(see simpleacc.cfg for configuration details)</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//if (args.Length != 1)</span>
            <span style='color:#595979; '>//{</span>
            <span style='color:#595979; '>//    Console.WriteLine("usage: SimpleAcceptor CONFIG_FILENAME");</span>
            <span style='color:#595979; '>//    System.Environment.Exit(2);</span>
            <span style='color:#595979; '>//}</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                SessionSettings settings <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SessionSettings<span style='color:#308080; '>(</span>cfgPath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                IApplication app <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SimpleAcceptorApp<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                IMessageStoreFactory storeFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> FileStoreFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                ILogFactory logFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> FileLogFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                IAcceptor acceptor <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> ThreadedSocketAcceptor<span style='color:#308080; '>(</span>app<span style='color:#308080; '>,</span> storeFactory<span style='color:#308080; '>,</span> settings<span style='color:#308080; '>,</span> logFactory<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                acceptor<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>press &lt;enter> to quit</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>Read<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                acceptor<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>System<span style='color:#308080; '>.</span>Exception e<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==FATAL ERROR==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Executor</span>
        <span style='color:#595979; '>/// </span>
        <span style='color:#595979; '>/// Performs trade/order execution sent by client</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Executor<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>This is only an example program, meant to be used with the TradeClient example.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//if (args.Length != 1)</span>
            <span style='color:#595979; '>//{</span>
            <span style='color:#595979; '>//    Console.WriteLine("usage: Executor CONFIG_FILENAME");</span>
            <span style='color:#595979; '>//    System.Environment.Exit(2);</span>
            <span style='color:#595979; '>//}</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                SessionSettings settings <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SessionSettings<span style='color:#308080; '>(</span>exePath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                IApplication executorApp <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Executor<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                IMessageStoreFactory storeFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> FileStoreFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                ILogFactory logFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> FileLogFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                ThreadedSocketAcceptor acceptor <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> ThreadedSocketAcceptor<span style='color:#308080; '>(</span>executorApp<span style='color:#308080; '>,</span> storeFactory<span style='color:#308080; '>,</span> settings<span style='color:#308080; '>,</span> logFactory<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                HttpServer srv <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> HttpServer<span style='color:#308080; '>(</span>HttpServerPrefix<span style='color:#308080; '>,</span> settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                acceptor<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                srv<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>View Executor status: </span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> HttpServerPrefix<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>press &lt;enter> to quit</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>Read<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                srv<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                acceptor<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>System<span style='color:#308080; '>.</span>Exception e<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>==FATAL ERROR==</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Trade Client</span>
        <span style='color:#595979; '>/// </span>
        <span style='color:#595979; '>/// Client program that sends trade request to Executor/Server for order processing</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> TradeClient<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>This is only an example program, meant to run against the Executor or SimpleAcceptor example programs.</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>                                                    ! ! !</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>              DO NOT USE THIS ON A COMMERCIAL FIX INTERFACE!  It won't work and it's a bad idea!</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>                                                    ! ! !</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>=============</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//if (args.Length != 1)</span>
            <span style='color:#595979; '>//{</span>
            <span style='color:#595979; '>//    System.Console.WriteLine("usage: TradeClient.exe CONFIG_FILENAME");</span>
            <span style='color:#595979; '>//    System.Environment.Exit(2);</span>
            <span style='color:#595979; '>//}</span>

            <span style='color:#595979; '>//string file = args[0];</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                QuickFix<span style='color:#308080; '>.</span>SessionSettings settings <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>SessionSettings<span style='color:#308080; '>(</span>trdPath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                TradeClientApp application <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> TradeClientApp<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                QuickFix<span style='color:#308080; '>.</span>IMessageStoreFactory storeFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>FileStoreFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                QuickFix<span style='color:#308080; '>.</span>ILogFactory logFactory <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>ScreenLogFactory<span style='color:#308080; '>(</span>settings<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                QuickFix<span style='color:#308080; '>.</span>Transport<span style='color:#308080; '>.</span>SocketInitiator initiator <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> QuickFix<span style='color:#308080; '>.</span>Transport<span style='color:#308080; '>.</span>SocketInitiator<span style='color:#308080; '>(</span>application<span style='color:#308080; '>,</span> storeFactory<span style='color:#308080; '>,</span> settings<span style='color:#308080; '>,</span> logFactory<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#595979; '>// this is a developer-test kludge.  do not emulate.</span>
                application<span style='color:#308080; '>.</span>MyInitiator <span style='color:#308080; '>=</span> initiator<span style='color:#406080; '>;</span>

                initiator<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                application<span style='color:#308080; '>.</span>Run<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                initiator<span style='color:#308080; '>.</span>Stop<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#308080; '>(</span>System<span style='color:#308080; '>.</span>Exception e<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>Message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span>e<span style='color:#308080; '>.</span>StackTrace<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            Environment<span style='color:#308080; '>.</span>Exit<span style='color:#308080; '>(</span><span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>// Sample to use QuickFix</span>
        <span style='color:#595979; '>// Configure CFG files to use which version, such as 4.2</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> DoIt<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Run as Simple Server or Executor Server</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Note: TradeClient CFG must be configured correctly</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1 = Simple</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>2 = Executor</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> rd <span style='color:#308080; '>=</span> Console<span style='color:#308080; '>.</span>ReadLine<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>rd<span style='color:#308080; '>.</span>StartsWith<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>1</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Starting Simple Server</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Task<span style='color:#308080; '>.</span>Run<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> SimpleAcceptor<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#595979; '>// Executor</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Starting Executor</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                Task<span style='color:#308080; '>.</span>Run<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> Executor<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#406080; '>}</span>
            Thread<span style='color:#308080; '>.</span>Sleep<span style='color:#308080; '>(</span><span style='color:#008c00; '>3000</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>//// Trade Client</span>
            <span style='color:#595979; '>//Console.WriteLine("Starting Client");</span>
            TradeClient<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
    <span style='color:#406080; '>}</span>
<span style='color:#406080; '>}</span>
</pre>
<!--Created using ToHtml.com on 2021-08-10 09:48:54 UTC -->
