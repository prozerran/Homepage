<pre style='color:#000020;background:#f6f8ff;'>
<span style='color:#595979; '>// ==========================================================================</span>
<span style='color:#595979; '>// Author:  Yee Hsu</span>
<span style='color:#595979; '>// Date:    2013-2021</span>
<span style='color:#595979; '>//</span>
<span style='color:#595979; '>// Desc:    Some common C# utility functions</span>
<span style='color:#595979; '>// ==========================================================================</span>

<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Collections<span style='color:#308080; '>.</span>Generic<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Collections<span style='color:#308080; '>.</span>ObjectModel<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Data<span style='color:#308080; '>.</span>Common<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Diagnostics<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Globalization<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>IO<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Linq<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Net<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Net<span style='color:#308080; '>.</span>NetworkInformation<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Net<span style='color:#308080; '>.</span>Sockets<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Reflection<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Runtime<span style='color:#308080; '>.</span>InteropServices<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Runtime<span style='color:#308080; '>.</span>Serialization<span style='color:#308080; '>.</span>Formatters<span style='color:#308080; '>.</span>Binary<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Security<span style='color:#308080; '>.</span>Cryptography<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Text<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Text<span style='color:#308080; '>.</span>RegularExpressions<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Threading<span style='color:#308080; '>.</span>Tasks<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Windows<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Windows<span style='color:#308080; '>.</span>Controls<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Windows<span style='color:#308080; '>.</span>Media<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> System<span style='color:#308080; '>.</span>Windows<span style='color:#308080; '>.</span>Media<span style='color:#308080; '>.</span>Imaging<span style='color:#406080; '>;</span>

<span style='color:#200080; font-weight:bold; '>using</span> FastMember<span style='color:#406080; '>;</span>
<span style='color:#200080; font-weight:bold; '>using</span> Newtonsoft<span style='color:#308080; '>.</span>Json<span style='color:#406080; '>;</span>

<span style='color:#200080; font-weight:bold; '>namespace</span> SPTrader<span style='color:#308080; '>.</span>Common
<span style='color:#406080; '>{</span>
    <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>class</span> CommonUtil
    <span style='color:#406080; '>{</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>readonly</span> DateTime epoch <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> DateTime<span style='color:#308080; '>(</span><span style='color:#008c00; '>1970</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> DateTimeKind<span style='color:#308080; '>.</span>Utc<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime GetStartOfDay<span style='color:#308080; '>(</span>DateTime dateTime<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> DateTime<span style='color:#308080; '>(</span>dateTime<span style='color:#308080; '>.</span>Year<span style='color:#308080; '>,</span> dateTime<span style='color:#308080; '>.</span>Month<span style='color:#308080; '>,</span> dateTime<span style='color:#308080; '>.</span>Day<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime GetEndOfDay<span style='color:#308080; '>(</span>DateTime dateTime<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> DateTime<span style='color:#308080; '>(</span>dateTime<span style='color:#308080; '>.</span>Year<span style='color:#308080; '>,</span> dateTime<span style='color:#308080; '>.</span>Month<span style='color:#308080; '>,</span> dateTime<span style='color:#308080; '>.</span>Day<span style='color:#308080; '>,</span> <span style='color:#008c00; '>23</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>59</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>59</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>999</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime FromEpochTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>uint</span> epochTime<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> FromEpochTime<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>long</span><span style='color:#308080; '>)</span> epochTime<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime FromEpochTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>long</span> epochTime<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> epoch<span style='color:#308080; '>.</span>AddSeconds<span style='color:#308080; '>(</span>epochTime<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime ParseDateTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>uint</span> dt<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> format<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> DateTime<span style='color:#308080; '>.</span>ParseExact<span style='color:#308080; '>(</span>dt<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> format<span style='color:#308080; '>,</span> CultureInfo<span style='color:#308080; '>.</span>InvariantCulture<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>uint</span> ToEpochTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> DateTime date<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToUInt32<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>date<span style='color:#308080; '>.</span>ToUniversalTime<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>-</span> epoch<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>TotalSeconds<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>ulong</span> ToEpochTimeMilliseconds<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> DateTime date<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToUInt64<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>date<span style='color:#308080; '>.</span>ToUniversalTime<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>-</span> epoch<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>TotalMilliseconds<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ToJsonString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>object</span> _obj<span style='color:#308080; '>,</span> Formatting fmt <span style='color:#308080; '>=</span> Formatting<span style='color:#308080; '>.</span>None<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> json <span style='color:#308080; '>=</span> JsonConvert<span style='color:#308080; '>.</span>SerializeObject<span style='color:#308080; '>(</span>_obj<span style='color:#308080; '>,</span> fmt<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span> JsonSerializerSettings
            <span style='color:#406080; '>{</span>
                PreserveReferencesHandling <span style='color:#308080; '>=</span> PreserveReferencesHandling<span style='color:#308080; '>.</span>Objects<span style='color:#308080; '>,</span>
                ReferenceLoopHandling <span style='color:#308080; '>=</span> ReferenceLoopHandling<span style='color:#308080; '>.</span>Ignore<span style='color:#308080; '>,</span>
                NullValueHandling <span style='color:#308080; '>=</span> NullValueHandling<span style='color:#308080; '>.</span>Ignore
            <span style='color:#406080; '>}</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> json<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>uint</span> FormatDateTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> DateTime date<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> format<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToUInt32<span style='color:#308080; '>(</span>date<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>format<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ToDateTimeStr<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> DateTime date<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> format<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToDateTime<span style='color:#308080; '>(</span>date<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>format<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T FromJsonToObject<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>string</span> json<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#595979; '>//var settings = new JsonSerializerSettings</span>
            <span style='color:#595979; '>//{</span>
            <span style='color:#595979; '>//    NullValueHandling = NullValueHandling.Ignore,</span>
            <span style='color:#595979; '>//    MissingMemberHandling = MissingMemberHandling.Ignore</span>
            <span style='color:#595979; '>//};</span>
            <span style='color:#200080; font-weight:bold; '>return</span> JsonConvert<span style='color:#308080; '>.</span>DeserializeObject<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>json<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Compares two strings, set ignoreCase to true to ignore case comparison ('A' == 'a')</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>bool</span> CompareTo<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>string</span> strA<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> strB<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span> ignoreCase <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> String<span style='color:#308080; '>.</span>Compare<span style='color:#308080; '>(</span>strA<span style='color:#308080; '>,</span> strB<span style='color:#308080; '>,</span> ignoreCase<span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime? ParseDateTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> strdate<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> format<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            DateTime result<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>DateTime<span style='color:#308080; '>.</span>TryParseExact<span style='color:#308080; '>(</span>strdate<span style='color:#308080; '>,</span> format<span style='color:#308080; '>,</span> 
                CultureInfo<span style='color:#308080; '>.</span>InvariantCulture<span style='color:#308080; '>,</span>
                DateTimeStyles<span style='color:#308080; '>.</span>AssumeUniversal<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>out</span> result<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> result<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> SimpleEncrypt<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>string</span> text<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToBase64String<span style='color:#308080; '>(</span>
                ProtectedData<span style='color:#308080; '>.</span>Protect<span style='color:#308080; '>(</span>Encoding<span style='color:#308080; '>.</span>Unicode<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>text<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>,</span> DataProtectionScope<span style='color:#308080; '>.</span>CurrentUser<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> SimpleDecrypt<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>string</span> text<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Encoding<span style='color:#308080; '>.</span>Unicode<span style='color:#308080; '>.</span>GetString<span style='color:#308080; '>(</span>
                ProtectedData<span style='color:#308080; '>.</span>Unprotect<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>FromBase64String<span style='color:#308080; '>(</span>text<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>,</span> DataProtectionScope<span style='color:#308080; '>.</span>CurrentUser<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ComputeMD5<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> message<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> src <span style='color:#308080; '>=</span> ASCIIEncoding<span style='color:#308080; '>.</span>ASCII<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>message<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> hash <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MD5CryptoServiceProvider<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ComputeHash<span style='color:#308080; '>(</span>src<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> BitConverter<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>hash<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Replace<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>-</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#595979; '>//return Convert.ToBase64String(hash);</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> BitmapImage GetImageFromUrl<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> url<span style='color:#308080; '>,</span> UriKind kind<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>url <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> BitmapImage<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> Uri<span style='color:#308080; '>(</span>url<span style='color:#308080; '>,</span> kind<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>void</span> CreateAppDataFile<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> path<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#595979; '>// The folder for the roaming current user </span>
            <span style='color:#200080; font-weight:bold; '>string</span> folder <span style='color:#308080; '>=</span> Environment<span style='color:#308080; '>.</span>GetFolderPath<span style='color:#308080; '>(</span>Environment<span style='color:#308080; '>.</span>SpecialFolder<span style='color:#308080; '>.</span>ApplicationData<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>// Combine the base folder with your specific folder....</span>
            <span style='color:#200080; font-weight:bold; '>string</span> specificFolder <span style='color:#308080; '>=</span> Path<span style='color:#308080; '>.</span>Combine<span style='color:#308080; '>(</span>folder<span style='color:#308080; '>,</span> path<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#595979; '>// CreateDirectory will check if folder exists and, if not, create it.</span>
            <span style='color:#595979; '>// If folder exists then CreateDirectory will do nothing.</span>
            Directory<span style='color:#308080; '>.</span>CreateDirectory<span style='color:#308080; '>(</span>specificFolder<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> DateTime GetLinkerTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> Assembly assembly<span style='color:#308080; '>,</span> TimeZoneInfo target <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> filePath <span style='color:#308080; '>=</span> assembly<span style='color:#308080; '>.</span>Location<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>const</span> <span style='color:#200080; font-weight:bold; '>int</span> c_PeHeaderOffset <span style='color:#308080; '>=</span> <span style='color:#008c00; '>60</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>const</span> <span style='color:#200080; font-weight:bold; '>int</span> c_LinkerTimestampOffset <span style='color:#308080; '>=</span> <span style='color:#008c00; '>8</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> buffer <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#008c00; '>2048</span><span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>using</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> stream <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> FileStream<span style='color:#308080; '>(</span>filePath<span style='color:#308080; '>,</span> FileMode<span style='color:#308080; '>.</span>Open<span style='color:#308080; '>,</span> FileAccess<span style='color:#308080; '>.</span>Read<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                stream<span style='color:#308080; '>.</span>Read<span style='color:#308080; '>(</span>buffer<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>2048</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> offset <span style='color:#308080; '>=</span> BitConverter<span style='color:#308080; '>.</span>ToInt32<span style='color:#308080; '>(</span>buffer<span style='color:#308080; '>,</span> c_PeHeaderOffset<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> secondsSince1970 <span style='color:#308080; '>=</span> BitConverter<span style='color:#308080; '>.</span>ToInt32<span style='color:#308080; '>(</span>buffer<span style='color:#308080; '>,</span> offset <span style='color:#308080; '>+</span> c_LinkerTimestampOffset<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> linkTimeUtc <span style='color:#308080; '>=</span> epoch<span style='color:#308080; '>.</span>AddSeconds<span style='color:#308080; '>(</span>secondsSince1970<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> tz <span style='color:#308080; '>=</span> target ?? TimeZoneInfo<span style='color:#308080; '>.</span>Local<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> localTime <span style='color:#308080; '>=</span> TimeZoneInfo<span style='color:#308080; '>.</span>ConvertTimeFromUtc<span style='color:#308080; '>(</span>linkTimeUtc<span style='color:#308080; '>,</span> tz<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> localTime<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>void</span> ForEach<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> IEnumerable<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span> enumerable<span style='color:#308080; '>,</span> Action<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span> action<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> cur <span style='color:#200080; font-weight:bold; '>in</span> enumerable<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                action<span style='color:#308080; '>(</span>cur<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>int</span> Remove<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> ObservableCollection<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span> coll<span style='color:#308080; '>,</span> Func<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span><span style='color:#308080; '>></span> condition<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> itemsToRemove <span style='color:#308080; '>=</span> coll<span style='color:#308080; '>.</span>Where<span style='color:#308080; '>(</span>condition<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToList<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> itemToRemove <span style='color:#200080; font-weight:bold; '>in</span> itemsToRemove<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                coll<span style='color:#308080; '>.</span>Remove<span style='color:#308080; '>(</span>itemToRemove<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> itemsToRemove<span style='color:#308080; '>.</span>Count<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>// _someObservableCollection.Sort(x => x.Number, false); // Where number is an simple property (non-onject)</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>void</span> Sort<span style='color:#308080; '>&lt;</span>TSource<span style='color:#308080; '>,</span> TKey<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> ObservableCollection<span style='color:#308080; '>&lt;</span>TSource<span style='color:#308080; '>></span> source<span style='color:#308080; '>,</span> Func<span style='color:#308080; '>&lt;</span>TSource<span style='color:#308080; '>,</span> TKey<span style='color:#308080; '>></span> keySelector<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span> isAZ<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>isAZ<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                List<span style='color:#308080; '>&lt;</span>TSource<span style='color:#308080; '>></span> sortedList <span style='color:#308080; '>=</span> source<span style='color:#308080; '>.</span>OrderBy<span style='color:#308080; '>(</span>keySelector<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToList<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                source<span style='color:#308080; '>.</span>Clear<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> sortedItem <span style='color:#200080; font-weight:bold; '>in</span> sortedList<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    source<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span>sortedItem<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>else</span>
            <span style='color:#406080; '>{</span>
                List<span style='color:#308080; '>&lt;</span>TSource<span style='color:#308080; '>></span> sortedList <span style='color:#308080; '>=</span> source<span style='color:#308080; '>.</span>OrderByDescending<span style='color:#308080; '>(</span>keySelector<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToList<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                source<span style='color:#308080; '>.</span>Clear<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> sortedItem <span style='color:#200080; font-weight:bold; '>in</span> sortedList<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    source<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span>sortedItem<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>bool</span> IsInt<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>object</span> Expression<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>int</span><span style='color:#308080; '>.</span>TryParse<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>Expression<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> NumberStyles<span style='color:#308080; '>.</span>Any<span style='color:#308080; '>,</span> NumberFormatInfo<span style='color:#308080; '>.</span>InvariantInfo<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>out</span> _<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>bool</span> IsDouble<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>object</span> Expression<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>double</span><span style='color:#308080; '>.</span>TryParse<span style='color:#308080; '>(</span>Convert<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>Expression<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> NumberStyles<span style='color:#308080; '>.</span>Any<span style='color:#308080; '>,</span> NumberFormatInfo<span style='color:#308080; '>.</span>InvariantInfo<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>out</span> _<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>double</span> GetValidBestValue<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>double</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> d<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>d <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> || d<span style='color:#308080; '>.</span>Length <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> || d<span style='color:#308080; '>[</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>double</span><span style='color:#308080; '>.</span>NaN<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> d<span style='color:#308080; '>[</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>double</span> GetOptionExpiryTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>uint</span> prodExpDate<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            DateTime expCal <span style='color:#308080; '>=</span> CommonUtil<span style='color:#308080; '>.</span>FromEpochTime<span style='color:#308080; '>(</span>prodExpDate<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToLocalTime<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            DateTime expiryCal <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> DateTime<span style='color:#308080; '>(</span>expCal<span style='color:#308080; '>.</span>Year<span style='color:#308080; '>,</span> expCal<span style='color:#308080; '>.</span>Month<span style='color:#308080; '>,</span> expCal<span style='color:#308080; '>.</span>Day<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            expiryCal <span style='color:#308080; '>=</span> expiryCal<span style='color:#308080; '>.</span>AddDays<span style='color:#308080; '>(</span><span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            DateTime nowDate <span style='color:#308080; '>=</span> DateTime<span style='color:#308080; '>.</span>Now<span style='color:#406080; '>;</span>
            DateTime nowCal <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> DateTime<span style='color:#308080; '>(</span>nowDate<span style='color:#308080; '>.</span>Year<span style='color:#308080; '>,</span> nowDate<span style='color:#308080; '>.</span>Month<span style='color:#308080; '>,</span> nowDate<span style='color:#308080; '>.</span>Day<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>ulong</span> now <span style='color:#308080; '>=</span> nowCal<span style='color:#308080; '>.</span>ToEpochTimeMilliseconds<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>/</span> <span style='color:#008c00; '>1000</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>ulong</span> expiryDate <span style='color:#308080; '>=</span> expiryCal<span style='color:#308080; '>.</span>ToEpochTimeMilliseconds<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>/</span> <span style='color:#008c00; '>1000</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>ulong</span> expiryTime <span style='color:#308080; '>=</span> expiryDate <span style='color:#308080; '>-</span> now <span style='color:#308080; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>double</span> T <span style='color:#308080; '>=</span> expiryTime <span style='color:#308080; '>/</span> <span style='color:#308080; '>(</span><span style='color:#008000; '>365.0</span> <span style='color:#308080; '>*</span> <span style='color:#008c00; '>24</span> <span style='color:#308080; '>*</span> <span style='color:#008c00; '>60</span> <span style='color:#308080; '>*</span> <span style='color:#008c00; '>60</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> T<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>void</span> StartProcess<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> exepath<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> args<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            ProcessStartInfo startInfo <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> ProcessStartInfo<span style='color:#308080; '>(</span>exepath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            startInfo<span style='color:#308080; '>.</span>WindowStyle <span style='color:#308080; '>=</span> ProcessWindowStyle<span style='color:#308080; '>.</span>Normal<span style='color:#406080; '>;</span>
            startInfo<span style='color:#308080; '>.</span>Arguments <span style='color:#308080; '>=</span> args<span style='color:#406080; '>;</span>
            Process<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span>startInfo<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> async Task<span style='color:#308080; '>&lt;</span><span style='color:#200080; font-weight:bold; '>long</span><span style='color:#308080; '>></span> PerformLatencyTest<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> host<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> timeout<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> task <span style='color:#308080; '>=</span> Task<span style='color:#308080; '>.</span>Run<span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>try</span>
                <span style='color:#406080; '>{</span>
                    Ping myPing <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Ping<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    PingReply reply <span style='color:#308080; '>=</span> myPing<span style='color:#308080; '>.</span>Send<span style='color:#308080; '>(</span>host<span style='color:#308080; '>,</span> timeout<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>reply <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; reply<span style='color:#308080; '>.</span>Status <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> IPStatus<span style='color:#308080; '>.</span>Success<span style='color:#308080; '>)</span>
                        <span style='color:#200080; font-weight:bold; '>return</span> reply<span style='color:#308080; '>.</span>RoundtripTime<span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> await task<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ConvertGreekValueStr<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>double</span> value<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> pre<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>double</span><span style='color:#308080; '>.</span>IsNaN<span style='color:#308080; '>(</span>value<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>pre <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>6</span><span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Format<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>{0:0.000000}</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> value<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>else</span> <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>pre <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>4</span><span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Format<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>{0:0.0000}</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> value<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>else</span>

            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Format<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>{0:0.00}</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> value<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> BitmapImage GetImage<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> imageUri<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> bitmapImage <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> BitmapImage<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            bitmapImage<span style='color:#308080; '>.</span>BeginInit<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            bitmapImage<span style='color:#308080; '>.</span>UriSource <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Uri<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>pack://siteoforigin:,,,</span><span style='color:#800000; '>"</span> <span style='color:#308080; '>+</span> imageUri<span style='color:#308080; '>,</span> UriKind<span style='color:#308080; '>.</span>RelativeOrAbsolute<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            bitmapImage<span style='color:#308080; '>.</span>EndInit<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> bitmapImage<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T CopyObjectByMemory<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>T source<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>using</span> <span style='color:#308080; '>(</span>MemoryStream _s <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MemoryStream<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>var</span> _f <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> BinaryFormatter<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                _f<span style='color:#308080; '>.</span>Serialize<span style='color:#308080; '>(</span>_s<span style='color:#308080; '>,</span> source<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                _s<span style='color:#308080; '>.</span>Position <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span>T<span style='color:#308080; '>)</span>_f<span style='color:#308080; '>.</span>Deserialize<span style='color:#308080; '>(</span>_s<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T CloneObjectByXml<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>T source<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> _so <span style='color:#308080; '>=</span> System<span style='color:#308080; '>.</span>Windows<span style='color:#308080; '>.</span>Markup<span style='color:#308080; '>.</span>XamlWriter<span style='color:#308080; '>.</span>Save<span style='color:#308080; '>(</span>source<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> _sr <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringReader<span style='color:#308080; '>(</span>_so<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> _xr <span style='color:#308080; '>=</span> System<span style='color:#308080; '>.</span>Xml<span style='color:#308080; '>.</span>XmlReader<span style='color:#308080; '>.</span>Create<span style='color:#308080; '>(</span>_sr<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span>T<span style='color:#308080; '>)</span>System<span style='color:#308080; '>.</span>Windows<span style='color:#308080; '>.</span>Markup<span style='color:#308080; '>.</span>XamlReader<span style='color:#308080; '>.</span>Load<span style='color:#308080; '>(</span>_xr<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T CloneObjectByJson<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>T source<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> ss <span style='color:#308080; '>=</span> source<span style='color:#308080; '>.</span>ToJsonString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> FromJsonToObject<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>ss<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ToBase64<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>object</span> obj<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> json <span style='color:#308080; '>=</span> obj<span style='color:#308080; '>.</span>ToJsonString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> bytes <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>Default<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>json<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToBase64String<span style='color:#308080; '>(</span>bytes<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T FromBase64<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>string</span> base64Text<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> bytes <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>FromBase64String<span style='color:#308080; '>(</span>base64Text<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> json <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>Default<span style='color:#308080; '>.</span>GetString<span style='color:#308080; '>(</span>bytes<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> json<span style='color:#308080; '>.</span>FromJsonToObject<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>void</span> DownloadFileAsync<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> url<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> save_path<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>using</span> <span style='color:#308080; '>(</span>WebClient wc <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> WebClient<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                wc<span style='color:#308080; '>.</span>DownloadFileAsync<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> Uri<span style='color:#308080; '>(</span>url<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> save_path<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T GetChildOfType<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>DependencyObject depObj<span style='color:#308080; '>)</span> where T <span style='color:#308080; '>:</span> DependencyObject
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>depObj <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> VisualTreeHelper<span style='color:#308080; '>.</span>GetChildrenCount<span style='color:#308080; '>(</span>depObj<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>var</span> child <span style='color:#308080; '>=</span> VisualTreeHelper<span style='color:#308080; '>.</span>GetChild<span style='color:#308080; '>(</span>depObj<span style='color:#308080; '>,</span> i<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>var</span> result <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span>child <span style='color:#200080; font-weight:bold; '>as</span> T<span style='color:#308080; '>)</span> ?? GetChildOfType<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span>child<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>result <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span> <span style='color:#200080; font-weight:bold; '>return</span> result<span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> List<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span> ItemSourceToList<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> ItemCollection obj<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> iList <span style='color:#308080; '>=</span> obj<span style='color:#308080; '>.</span>SourceCollection <span style='color:#200080; font-weight:bold; '>as</span> IList<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> iList<span style='color:#308080; '>.</span>ToList<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>// use this to generate sig</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> GenerateSignature<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> timestamp<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> method<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> url<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> body<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> appSecret<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> GetHMACInHex<span style='color:#308080; '>(</span>appSecret<span style='color:#308080; '>,</span> timestamp <span style='color:#308080; '>+</span> method <span style='color:#308080; '>+</span> url <span style='color:#308080; '>+</span> body<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> GetHMACInHex<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> key<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> data<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> hmacKey <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>key<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> dataBytes <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>data<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>using</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> hmac <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> HMACSHA256<span style='color:#308080; '>(</span>hmacKey<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>var</span> sig <span style='color:#308080; '>=</span> hmac<span style='color:#308080; '>.</span>ComputeHash<span style='color:#308080; '>(</span>dataBytes<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>return</span> ByteToHexString<span style='color:#308080; '>(</span>sig<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> ByteToHexString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> bytes<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> c <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>[</span>bytes<span style='color:#308080; '>.</span>Length <span style='color:#308080; '>*</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>int</span> b<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> bytes<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                b <span style='color:#308080; '>=</span> bytes<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span> <span style='color:#308080; '>></span><span style='color:#308080; '>></span> <span style='color:#008c00; '>4</span><span style='color:#406080; '>;</span>
                c<span style='color:#308080; '>[</span>i <span style='color:#308080; '>*</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span><span style='color:#008c00; '>87</span> <span style='color:#308080; '>+</span> b <span style='color:#308080; '>+</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>b <span style='color:#308080; '>-</span> <span style='color:#008c00; '>10</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>></span><span style='color:#308080; '>></span> <span style='color:#008c00; '>31</span><span style='color:#308080; '>)</span> &amp; <span style='color:#308080; '>-</span><span style='color:#008c00; '>39</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                b <span style='color:#308080; '>=</span> bytes<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span> &amp; <span style='color:#008000; '>0xF</span><span style='color:#406080; '>;</span>
                c<span style='color:#308080; '>[</span>i <span style='color:#308080; '>*</span> <span style='color:#008c00; '>2</span> <span style='color:#308080; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span><span style='color:#008c00; '>87</span> <span style='color:#308080; '>+</span> b <span style='color:#308080; '>+</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>b <span style='color:#308080; '>-</span> <span style='color:#008c00; '>10</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>></span><span style='color:#308080; '>></span> <span style='color:#008c00; '>31</span><span style='color:#308080; '>)</span> &amp; <span style='color:#308080; '>-</span><span style='color:#008c00; '>39</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>(</span>c<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Creates the Access Sign for the API based on the request.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="timestamp">The current timestamp since 01-01-1970 epoch.&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="command">The HTTP verb of the request.&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="path">The path of the API request.&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="body">The (optional) body content.&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="apiSecret">The API secret.&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>The access sign.&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>string</span> GetAccessSign<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> timestamp<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> command<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> path<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> body<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> apiSecret<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> hmacKey <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>apiSecret<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>string</span> data <span style='color:#308080; '>=</span> timestamp <span style='color:#308080; '>+</span> command <span style='color:#308080; '>+</span> path <span style='color:#308080; '>+</span> body<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>using</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>var</span> signatureStream <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MemoryStream<span style='color:#308080; '>(</span>Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>data<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>new</span> HMACSHA256<span style='color:#308080; '>(</span>hmacKey<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ComputeHash<span style='color:#308080; '>(</span>signatureStream<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Aggregate<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#308080; '>(</span>sb<span style='color:#308080; '>,</span> b<span style='color:#308080; '>)</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> sb<span style='color:#308080; '>.</span>AppendFormat<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>{0:x2}</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> b<span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> sb <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> sb<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> TcpState GetState<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> TcpClient tcpClient<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>var</span> foo <span style='color:#308080; '>=</span> IPGlobalProperties<span style='color:#308080; '>.</span>GetIPGlobalProperties<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
              <span style='color:#308080; '>.</span>GetActiveTcpConnections<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
              <span style='color:#308080; '>.</span>SingleOrDefault<span style='color:#308080; '>(</span>x <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> x<span style='color:#308080; '>.</span>LocalEndPoint<span style='color:#308080; '>.</span>Equals<span style='color:#308080; '>(</span>tcpClient<span style='color:#308080; '>.</span>Client<span style='color:#308080; '>.</span>LocalEndPoint<span style='color:#308080; '>)</span>
                                 &amp;&amp; x<span style='color:#308080; '>.</span>RemoteEndPoint<span style='color:#308080; '>.</span>Equals<span style='color:#308080; '>(</span>tcpClient<span style='color:#308080; '>.</span>Client<span style='color:#308080; '>.</span>RemoteEndPoint<span style='color:#308080; '>)</span>
              <span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> foo <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> ? foo<span style='color:#308080; '>.</span>State <span style='color:#308080; '>:</span> TcpState<span style='color:#308080; '>.</span>Unknown<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>// DbDataReader probably need to be a child class instead</span>
        <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>static</span> T ConvertToObject<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> DbDataReader rd<span style='color:#308080; '>)</span> where T <span style='color:#308080; '>:</span> <span style='color:#200080; font-weight:bold; '>class</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>new</span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Type type <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>typeof</span><span style='color:#308080; '>(</span>T<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> accessor <span style='color:#308080; '>=</span> TypeAccessor<span style='color:#308080; '>.</span>Create<span style='color:#308080; '>(</span>type<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> members <span style='color:#308080; '>=</span> accessor<span style='color:#308080; '>.</span>GetMembers<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>var</span> t <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> T<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> rd<span style='color:#308080; '>.</span>FieldCount<span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>!</span>rd<span style='color:#308080; '>.</span>IsDBNull<span style='color:#308080; '>(</span>i<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    <span style='color:#200080; font-weight:bold; '>string</span> fieldName <span style='color:#308080; '>=</span> rd<span style='color:#308080; '>.</span>GetName<span style='color:#308080; '>(</span>i<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                    <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>members<span style='color:#308080; '>.</span>Any<span style='color:#308080; '>(</span>m <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Equals<span style='color:#308080; '>(</span>m<span style='color:#308080; '>.</span>Name<span style='color:#308080; '>,</span> fieldName<span style='color:#308080; '>,</span> StringComparison<span style='color:#308080; '>.</span>OrdinalIgnoreCase<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        accessor<span style='color:#308080; '>[</span>t<span style='color:#308080; '>,</span> fieldName<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> rd<span style='color:#308080; '>.</span>GetValue<span style='color:#308080; '>(</span>i<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> t<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Below here is OLD hex/byte/string formatter</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;typeparam name="T">&lt;/typeparam></span>
        <span style='color:#595979; '>/// &lt;param name="x">&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="y">&lt;/param></span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> Swap<span style='color:#308080; '>&lt;</span>T<span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>ref</span> T x<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>ref</span> T y<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            T t <span style='color:#308080; '>=</span> y<span style='color:#406080; '>;</span>
            y <span style='color:#308080; '>=</span> x<span style='color:#406080; '>;</span>
            x <span style='color:#308080; '>=</span> t<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Method overloading. &lt;c>ByteArrayToHexString&lt;/c></span>
        <span style='color:#595979; '>/// for 1 parameter.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="data">Data from device&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns></span>
        <span style='color:#595979; '>/// &lt;c>ByteArrayToHexString(byte[] data, int start_idx, int length, bool hyphen)&lt;/c></span>
        <span style='color:#595979; '>/// &lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ByteArrayToHexString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> data<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> ByteArrayToHexString<span style='color:#308080; '>(</span>data<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> data<span style='color:#308080; '>.</span>Length<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Converts byte array from device to hex string.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="data">Data from device&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of data from device&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="hyphen"></span>
        <span style='color:#595979; '>/// If data from device has hyphen format</span>
        <span style='color:#595979; '>/// &lt;example></span>
        <span style='color:#595979; '>/// Example: </span>
        <span style='color:#595979; '>/// &lt;c>true&lt;/c> if data is "7E-01-00-64" ; </span>
        <span style='color:#595979; '>/// &lt;c>false&lt;/c> if data is "7E010064";</span>
        <span style='color:#595979; '>/// &lt;/example></span>
        <span style='color:#595979; '>/// &lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Hex string&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ByteArrayToHexString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> data<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>bool</span> hyphen<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>hyphen<span style='color:#308080; '>)</span>
                <span style='color:#200080; font-weight:bold; '>return</span> BitConverter<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>data<span style='color:#308080; '>,</span> start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> BitConverter<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>data<span style='color:#308080; '>,</span> start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Replace<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>-</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Method overloading. &lt;c>HexStringToByteArray&lt;/c></span>
        <span style='color:#595979; '>/// for 1 parameter.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="hex">Hex string&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns></span>
        <span style='color:#595979; '>/// &lt;c>HexStringToByteArray(string hex, int start_idx, int length)&lt;/c></span>
        <span style='color:#595979; '>/// &lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> HexStringToByteArray<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> hex<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> HexStringToByteArray<span style='color:#308080; '>(</span>hex<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> hex<span style='color:#308080; '>.</span>Length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Converts Hex string to byte array</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="hex">Hex string&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>byte[]&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> HexStringToByteArray<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> hex<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> Enumerable<span style='color:#308080; '>.</span>Range<span style='color:#308080; '>(</span>start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span>
                             <span style='color:#308080; '>.</span>Where<span style='color:#308080; '>(</span>x <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> x <span style='color:#308080; '>%</span> <span style='color:#008c00; '>2</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                             <span style='color:#308080; '>.</span>Select<span style='color:#308080; '>(</span>x <span style='color:#308080; '>=</span><span style='color:#308080; '>></span> Convert<span style='color:#308080; '>.</span>ToByte<span style='color:#308080; '>(</span>hex<span style='color:#308080; '>.</span>Substring<span style='color:#308080; '>(</span>x<span style='color:#308080; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>16</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
                             <span style='color:#308080; '>.</span>ToArray<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Calculates data by XORing.</span>
        <span style='color:#595979; '>/// &lt;c>0x00 ^= byte&lt;/c></span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="data">Byte array data&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns 0x00 in exception ; Returns XORed byte&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>byte</span> CalculateXorCheckSum<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> data<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>byte</span> chksum <span style='color:#308080; '>=</span> <span style='color:#008000; '>0x00</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> start_idx<span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> length<span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    chksum ^<span style='color:#308080; '>=</span> data<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>return</span> chksum<span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#008000; '>0x00</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Calculates string data by XORing.</span>
        <span style='color:#595979; '>/// Uses &lt;see cref="CalculateXorCheckSum(byte[] data, int start_idx, int length)"/>.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="data">String data&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns empty string in exception ; Returns XORed string &lt;paramref name="data"/>&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> CalculateXorCheckSum<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> data<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> bytes <span style='color:#308080; '>=</span> Encoding<span style='color:#308080; '>.</span>UTF8<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>data<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>byte</span> b <span style='color:#308080; '>=</span> CalculateXorCheckSum<span style='color:#308080; '>(</span>bytes<span style='color:#308080; '>,</span> start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>b<span style='color:#308080; '>,</span> <span style='color:#008c00; '>16</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>PadLeft<span style='color:#308080; '>(</span><span style='color:#008c00; '>2</span><span style='color:#308080; '>,</span> <span style='color:#1060b6; '>'0'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToUpper<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> String<span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Analyses hex character as bit. Check if hex character is 0 or 1.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="cHexChar">Hex character&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="nCheckBit"></span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_1"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_2"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_3"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_4"/></span>
        <span style='color:#595979; '>/// &lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns 0 or 1&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>short</span> AnalyzeHexCharAsBit<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>char</span> cHexChar<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> nCheckBit<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                SByte digit <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToSByte<span style='color:#308080; '>(</span>cHexChar<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>16</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>    <span style='color:#595979; '>// to base 16. Sample = A</span>
                <span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> array <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>digit<span style='color:#308080; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>PadLeft<span style='color:#308080; '>(</span><span style='color:#008c00; '>4</span><span style='color:#308080; '>,</span> <span style='color:#1060b6; '>'0'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToArray<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#595979; '>// to 4bit binary. Sample = 1010</span>
                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>short</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span>array<span style='color:#308080; '>[</span>nCheckBit<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'1'</span> ? <span style='color:#008c00; '>1</span> <span style='color:#308080; '>:</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>    <span style='color:#595979; '>// check which bit value</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> FormatException<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Same as &lt;see cref="AnalyzeHexCharAsBit(char cHexChar, int nCheckBit)"/></span>
        <span style='color:#595979; '>/// but inverted. 1 is 0 and 0 is 1.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="cHexChar">Hex character&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="nCheckBit"></span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_1"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_2"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_3"/> ; </span>
        <span style='color:#595979; '>/// &lt;see cref="GeoUtil.CHECK_BIT_4"/></span>
        <span style='color:#595979; '>/// &lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns 0 or 1&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>short</span> AnalyzeHexCharAsBitInvert<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>char</span> cHexChar<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> nCheckBit<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#595979; '>// Below method written by Ahamed to Invert the result(eg: LowBat) @ 22012016</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                SByte digit <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToSByte<span style='color:#308080; '>(</span>cHexChar<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>16</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>    <span style='color:#595979; '>// to base 16. Sample = A</span>
                <span style='color:#200080; font-weight:bold; '>char</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> array <span style='color:#308080; '>=</span> Convert<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>digit<span style='color:#308080; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>PadLeft<span style='color:#308080; '>(</span><span style='color:#008c00; '>4</span><span style='color:#308080; '>,</span> <span style='color:#1060b6; '>'0'</span><span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToArray<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> <span style='color:#595979; '>// to 4bit binary. Sample = 1010</span>

                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>short</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span>array<span style='color:#308080; '>[</span>nCheckBit<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#1060b6; '>'1'</span> ? <span style='color:#008c00; '>0</span> <span style='color:#308080; '>:</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>    <span style='color:#595979; '>// check which bit value</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> FormatException<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Converts hex character to a</span>
        <span style='color:#595979; '>/// 16 base 16 bit signed integer.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="cHexChar">Hex character&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns Int16&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>short</span> GetShortHexValue<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>char</span> cHexChar<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span> Convert<span style='color:#308080; '>.</span>ToInt16<span style='color:#308080; '>(</span>cHexChar<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>16</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>throw</span> <span style='color:#200080; font-weight:bold; '>new</span> FormatException<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Encodes byte array to ASCII string.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="data">Byte array data&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns string&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> SubBytesAsString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>this</span> <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> data<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span> Encoding<span style='color:#308080; '>.</span>ASCII<span style='color:#308080; '>.</span>GetString<span style='color:#308080; '>(</span>data<span style='color:#308080; '>,</span> start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Converts string DateTime to a specific format.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="date">String DateTime to be formatted&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="src_format">Current format of string DateTime&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="target_format">Target format of string DateTime&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns string DateTime using &lt;paramref name="target_format"/> format.&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ReFormatToDateTime<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> date<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> src_format<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> target_format<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>return</span> DateTime<span style='color:#308080; '>.</span>ParseExact<span style='color:#308080; '>(</span>date<span style='color:#308080; '>,</span> src_format<span style='color:#308080; '>,</span> CultureInfo<span style='color:#308080; '>.</span>InvariantCulture<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>target_format<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Parses byte array data to UInt16 structure.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="bytes">Byte array data&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns ushort type data, converted from &lt;paramref name="bytes"/>&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>ushort</span> CalculateCrc16_CCITT_CheckSum<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> bytes<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>const</span> <span style='color:#200080; font-weight:bold; '>ushort</span> poly <span style='color:#308080; '>=</span> <span style='color:#008c00; '>4129</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>ushort</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> table <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>ushort</span><span style='color:#308080; '>[</span><span style='color:#008c00; '>256</span><span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>ushort</span> initialValue <span style='color:#308080; '>=</span> <span style='color:#008000; '>0xffff</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>ushort</span> temp<span style='color:#308080; '>,</span> a<span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>ushort</span> crc <span style='color:#308080; '>=</span> initialValue<span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> table<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span> <span style='color:#308080; '>+</span><span style='color:#308080; '>+</span>i<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    temp <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
                    a <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>ushort</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span>i <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>&lt;</span> <span style='color:#008c00; '>8</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                    <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> j <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> j <span style='color:#308080; '>&lt;</span> <span style='color:#008c00; '>8</span><span style='color:#406080; '>;</span> <span style='color:#308080; '>+</span><span style='color:#308080; '>+</span>j<span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>temp ^ a<span style='color:#308080; '>)</span> &amp; <span style='color:#008000; '>0x8000</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                            temp <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>ushort</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>temp <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>&lt;</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span> ^ poly<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                        <span style='color:#200080; font-weight:bold; '>else</span>
                            temp <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#406080; '>;</span>
                        a <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>&lt;</span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                    table<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> temp<span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> start_idx<span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> length<span style='color:#406080; '>;</span> <span style='color:#308080; '>+</span><span style='color:#308080; '>+</span>i<span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    crc <span style='color:#308080; '>=</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>ushort</span><span style='color:#308080; '>)</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>crc <span style='color:#308080; '>&lt;</span><span style='color:#308080; '>&lt;</span> <span style='color:#008c00; '>8</span><span style='color:#308080; '>)</span> ^ table<span style='color:#308080; '>[</span><span style='color:#308080; '>(</span><span style='color:#308080; '>(</span>crc <span style='color:#308080; '>></span><span style='color:#308080; '>></span> <span style='color:#008c00; '>8</span><span style='color:#308080; '>)</span> ^ <span style='color:#308080; '>(</span><span style='color:#008000; '>0xff</span> &amp; bytes<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#308080; '>)</span><span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#406080; '>}</span>
                <span style='color:#200080; font-weight:bold; '>return</span> crc<span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// Parses hex string data to a string with UInt16 structure.</span>
        <span style='color:#595979; '>/// &lt;/summary></span>
        <span style='color:#595979; '>/// &lt;param name="hex_str">Hex string data&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="start_idx">The starting position within value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;param name="length">Length of value&lt;/param></span>
        <span style='color:#595979; '>/// &lt;returns>Returns string&lt;/returns></span>
        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> CalculateCrc16_CCITT_CheckSum<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> hex_str<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> start_idx<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> length<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>byte</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> data <span style='color:#308080; '>=</span> HexStringToByteArray<span style='color:#308080; '>(</span>hex_str<span style='color:#308080; '>,</span> start_idx<span style='color:#308080; '>,</span> length<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>return</span> CalculateCrc16_CCITT_CheckSum<span style='color:#308080; '>(</span>data<span style='color:#308080; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> data<span style='color:#308080; '>.</span>Length<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>X2</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> String<span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>


        <span style='color:#595979; '>/// &lt;summary></span>
        <span style='color:#595979; '>/// FROM OLD COMMON</span>
        <span style='color:#595979; '>/// &lt;/summary></span>

        <span style='color:#595979; '>// for ini i/o</span>
        <span style='color:#308080; '>[</span>DllImport<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>kernel32</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>]</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>extern</span> <span style='color:#200080; font-weight:bold; '>long</span> WritePrivateProfileString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> section<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> key<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> val<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> filePath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

        <span style='color:#308080; '>[</span>DllImport<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>kernel32</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#308080; '>]</span>
        <span style='color:#200080; font-weight:bold; '>private</span> <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>extern</span> <span style='color:#200080; font-weight:bold; '>int</span> GetPrivateProfileString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> section<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> key<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> def<span style='color:#308080; '>,</span> StringBuilder retVal<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> size<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> filePath<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> GetCurrentDirectory<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> AppDomain<span style='color:#308080; '>.</span>CurrentDomain<span style='color:#308080; '>.</span>BaseDirectory<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ExtractStringBetween<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sString<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sLeft<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sRight<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> ExtractStringBetweenCount<span style='color:#308080; '>(</span>sString<span style='color:#308080; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>,</span> sLeft<span style='color:#308080; '>,</span> sRight<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ExtractStringBetweenCount<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sString<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> count<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sLeft<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sRight<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sString <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span> || sString <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
                    <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>int</span> nBeg <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>int</span> nEnd <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sLeft <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span> &amp;&amp; count <span style='color:#308080; '>></span> <span style='color:#008c00; '>0</span><span style='color:#308080; '>)</span>
                <span style='color:#406080; '>{</span>
                    <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> count<span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
                    <span style='color:#406080; '>{</span>
                        nBeg <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>IndexOf<span style='color:#308080; '>(</span>sLeft<span style='color:#308080; '>,</span> nBeg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                        <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>nBeg <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#308080; '>-</span><span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span>
                            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

                        nBeg <span style='color:#308080; '>+</span><span style='color:#308080; '>=</span> sLeft<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span>
                    <span style='color:#406080; '>}</span>
                <span style='color:#406080; '>}</span>

                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sRight <span style='color:#308080; '>!</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
                    nEnd <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>IndexOf<span style='color:#308080; '>(</span>sRight<span style='color:#308080; '>,</span> nBeg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>string</span> sRetString <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>Substring<span style='color:#308080; '>(</span>nBeg<span style='color:#308080; '>,</span> nEnd <span style='color:#308080; '>-</span> nBeg<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Trim<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>nBeg <span style='color:#308080; '>></span><span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span> &amp;&amp; nEnd <span style='color:#308080; '>></span><span style='color:#308080; '>=</span> nBeg<span style='color:#308080; '>)</span>
                    <span style='color:#200080; font-weight:bold; '>return</span> sRetString<span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ExtractStringBetweenReverse<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sString<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sLeft<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sRight<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>sString <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span> || sString <span style='color:#308080; '>=</span><span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span>
                    <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>int</span> nBeg <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>LastIndexOf<span style='color:#308080; '>(</span>sLeft<span style='color:#308080; '>)</span> <span style='color:#308080; '>+</span> sLeft<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>int</span> nEnd <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>IndexOf<span style='color:#308080; '>(</span>sRight<span style='color:#308080; '>,</span> nBeg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>string</span> sRetString <span style='color:#308080; '>=</span> sString<span style='color:#308080; '>.</span>Substring<span style='color:#308080; '>(</span>nBeg<span style='color:#308080; '>,</span> nEnd <span style='color:#308080; '>-</span> nBeg<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>nBeg <span style='color:#308080; '>&lt;</span> <span style='color:#008c00; '>0</span> || nEnd <span style='color:#308080; '>&lt;</span> nBeg<span style='color:#308080; '>)</span>
                    <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
                <span style='color:#200080; font-weight:bold; '>else</span>
                    <span style='color:#200080; font-weight:bold; '>return</span> sRetString<span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> GetMD5Hash<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sMessage<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Byte<span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> originalBytes<span style='color:#406080; '>;</span>
            Byte<span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> encodedBytes<span style='color:#406080; '>;</span>

            MD5 md5 <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> MD5CryptoServiceProvider<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            originalBytes <span style='color:#308080; '>=</span> ASCIIEncoding<span style='color:#308080; '>.</span>Default<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>sMessage<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            encodedBytes <span style='color:#308080; '>=</span> md5<span style='color:#308080; '>.</span>ComputeHash<span style='color:#308080; '>(</span>originalBytes<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> BitConverter<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>encodedBytes<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Replace<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>-</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> GetSha1Hash<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sMessage<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            Byte<span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> originalBytes<span style='color:#406080; '>;</span>
            Byte<span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> encodedBytes<span style='color:#406080; '>;</span>

            SHA1 sha <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> SHA1CryptoServiceProvider<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            originalBytes <span style='color:#308080; '>=</span> ASCIIEncoding<span style='color:#308080; '>.</span>Default<span style='color:#308080; '>.</span>GetBytes<span style='color:#308080; '>(</span>sMessage<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            encodedBytes <span style='color:#308080; '>=</span> sha<span style='color:#308080; '>.</span>ComputeHash<span style='color:#308080; '>(</span>originalBytes<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> BitConverter<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span>encodedBytes<span style='color:#308080; '>)</span><span style='color:#308080; '>.</span>Replace<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>-</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>null</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> DeleteFile<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sFileName<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>            <span style='color:#595979; '>// Delete the file if it exists.</span>
            <span style='color:#200080; font-weight:bold; '>if</span> <span style='color:#308080; '>(</span>File<span style='color:#308080; '>.</span>Exists<span style='color:#308080; '>(</span>sFileName<span style='color:#308080; '>)</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                File<span style='color:#308080; '>.</span>Delete<span style='color:#308080; '>(</span>sFileName<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ReadFileContents<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sFileName<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> sFileContent <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>.</span>Empty<span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                StreamReader sr<span style='color:#406080; '>;</span>

                sr <span style='color:#308080; '>=</span> File<span style='color:#308080; '>.</span>OpenText<span style='color:#308080; '>(</span>sFileName<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sFileContent <span style='color:#308080; '>=</span> sr<span style='color:#308080; '>.</span>ReadToEnd<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                sr<span style='color:#308080; '>.</span>Close<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> sFileContent<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/*</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public bool FtpReadFile(FTPInformation ftpinfo, out string sFileContent, out DateTime dtTime)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;int nTry = 3;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;sFileContent = "";</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;dtTime = DateTime.Now;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;bool bSuccess = false;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;do</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;bSuccess = Common.DownloadFile(ftpinfo);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if (bSuccess == true)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;sFileContent = Common.ReadFileContents(ftpinfo.sFile);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Common.GetFileTimeStamp(ftpinfo, out dtTime);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;break;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Thread.Sleep(3000);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;nTry--;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;} while (nTry > 0);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return bSuccess;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public bool GetFileTimeStamp(FTPInformation ftpinfo, out DateTime dtTime)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;dtTime = DateTime.Now;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;try</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FtpWebRequest request = (FtpWebRequest)FtpWebRequest.Create("ftp://" + ftpinfo.sHost + ftpinfo.sPath + ftpinfo.sFile);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Credentials = new NetworkCredential(ftpinfo.sUser, ftpinfo.sPass);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Method = WebRequestMethods.</span><span style='color:#5555dd; '>Ftp.GetDateTimestamp</span><span style='color:#595979; '>;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Timeout = 60000;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FtpWebResponse response = (FtpWebResponse)request.GetResponse();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;dtTime = response.LastModified;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;catch (Exception e)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Common.SendEmail("Exception!", e.ToString());</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return true;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public bool UploadFile(FTPInformation ftpinfo)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;try</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FileInfo fileInf = new FileInfo(ftpinfo.sFile);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;string uri = "ftp://" + ftpinfo.sHost + ftpinfo.sPath + fileInf.Name;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FtpWebRequest reqFTP;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Create FtpWebRequest object from the Uri provided</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(uri));</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Provide the WebPermission Credentials</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP.Credentials = new NetworkCredential(ftpinfo.sUser, ftpinfo.sPass);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// By default KeepAlive is true, where the control connection is not closed</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// after a command is executed.</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP.KeepAlive = false;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Specify the command to be executed.</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP.Method = WebRequestMethods.</span><span style='color:#5555dd; '>Ftp.UploadFile</span><span style='color:#595979; '>;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Specify the data transfer type.</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP.UseBinary = true;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Notify the server about the size of the uploaded file</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;reqFTP.ContentLength = fileInf.Length;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// The buffer size is set to 2kb</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;int buffLength = 2048;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;byte[] buff = new byte[buffLength];</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;int contentLen;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Opens a file stream (System.IO.FileStream) to read the file to be uploaded</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FileStream fs = fileInf.OpenRead();</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Stream to which the file to be upload is written</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Stream strm = reqFTP.GetRequestStream();</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Read from the file stream 2kb at a time</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;contentLen = fs.Read(buff, 0, buffLength);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Till Stream content ends</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;while (contentLen != 0)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Write Content from the file stream to the FTP Upload Stream</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;strm.Write(buff, 0, contentLen);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;contentLen = fs.Read(buff, 0, buffLength);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// Close the file stream and the Request Stream</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;strm.Close();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;fs.Close();</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return true;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;catch (Exception e)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Common.SendEmail("Error uploading XML file.", "");</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public bool DownloadFile(FTPInformation ftpinfo)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;try</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FtpWebRequest request = (FtpWebRequest)FtpWebRequest.Create("ftp://" + ftpinfo.sHost + ftpinfo.sPath + ftpinfo.sFile);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Credentials = new NetworkCredential(ftpinfo.sUser, ftpinfo.sPass);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Method = WebRequestMethods.</span><span style='color:#5555dd; '>Ftp.DownloadFile</span><span style='color:#595979; '>;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;request.Timeout = 60000;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FtpWebResponse response = (FtpWebResponse)request.GetResponse();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Stream rs = response.GetResponseStream();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Common.DeleteFile(ftpinfo.sFile);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;FileStream fs = new FileStream(ftpinfo.sFile, FileMode.Create);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Byte[] buffer = new Byte[2047];</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;int read = 0;</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;do</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;read = rs.Read(buffer, 0, buffer.Length);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;fs.Write(buffer, 0, read);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;} while (read != 0);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;fs.Flush();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;fs.Close();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;rs.Close();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;catch (Exception e)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Common.SendEmail("Error downloading file.", "");</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return true;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;* */</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> GetPrivateProfileString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sSection<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sKey<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>string</span> sFileName<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            StringBuilder temp <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> StringBuilder<span style='color:#308080; '>(</span><span style='color:#008c00; '>1024</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            GetPrivateProfileString<span style='color:#308080; '>(</span>sSection<span style='color:#308080; '>,</span> sKey<span style='color:#308080; '>,</span> <span style='color:#800000; '>"</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> temp<span style='color:#308080; '>,</span> <span style='color:#008c00; '>1024</span><span style='color:#308080; '>,</span> GetCurrentDirectory<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span> <span style='color:#308080; '>+</span> sFileName<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> temp<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> ConvertDateTimeToString<span style='color:#308080; '>(</span>DateTime dtTime<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> dtTime<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>d</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> GetNow_YYYYMMDD<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            DateTime dt <span style='color:#308080; '>=</span> DateTime<span style='color:#308080; '>.</span>Now<span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>return</span> dt<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>yyyyMMdd</span><span style='color:#800000; '>"</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span> MergeSplitDateToString<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> nMon<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> nDay<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span> nYear<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>return</span> String<span style='color:#308080; '>.</span>Format<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>{0}/{1}/{2}</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> nMon<span style='color:#308080; '>,</span> nDay<span style='color:#308080; '>,</span> nYear<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>int</span> GetNumericalMonth<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sMon<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>int</span> value <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
            Dictionary<span style='color:#308080; '>&lt;</span><span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span><span style='color:#308080; '>></span> dMon <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> Dictionary<span style='color:#308080; '>&lt;</span><span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>int</span><span style='color:#308080; '>></span><span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span> sMonth <span style='color:#308080; '>=</span> sMon<span style='color:#308080; '>.</span>Substring<span style='color:#308080; '>(</span><span style='color:#008c00; '>0</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Jan</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Feb</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Mar</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Apr</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>4</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>May</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>5</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Jun</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>6</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Jul</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>7</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Aug</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Sep</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>9</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Oct</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>10</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Nov</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>11</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span> dMon<span style='color:#308080; '>.</span>Add<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>Dec</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> <span style='color:#008c00; '>12</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            dMon<span style='color:#308080; '>.</span>TryGetValue<span style='color:#308080; '>(</span>sMonth<span style='color:#308080; '>,</span> <span style='color:#200080; font-weight:bold; '>out</span> value<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>return</span> value<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>void</span> DisplayStringArray<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> sArray<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>for</span> <span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>int</span> i <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span> i <span style='color:#308080; '>&lt;</span> sArray<span style='color:#308080; '>.</span>Length<span style='color:#406080; '>;</span> i<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                Console<span style='color:#308080; '>.</span>WriteLine<span style='color:#308080; '>(</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>sArray[{0}] = \"{1}\"</span><span style='color:#800000; '>"</span><span style='color:#308080; '>,</span> i<span style='color:#308080; '>,</span> sArray<span style='color:#308080; '>[</span>i<span style='color:#308080; '>]</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#595979; '>/*</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public void DisplayDefInfo(DefInformation definfo)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if (definfo != null)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Console.WriteLine("[{0}][{1}][{2}][{3}][{4}]", definfo.nUpdateId,</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;definfo.sDefDate, definfo.sDefVersion, definfo.sDefSignature, definfo.sEngineVersion);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public void DisplayUrlInfo(UrlInformation urlinfo)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if (urlinfo != null)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Console.WriteLine("url: {0}", urlinfo.sPatchLink);</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if (urlinfo.lUrlInfos != null)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;foreach (string sUrl in urlinfo.lUrlInfos)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Console.WriteLine("---: {0}", sUrl);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public void DisplayFixInfo(List&lt;FixInformation> lfinfo)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;if (lfinfo != null)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;foreach (FixInformation </span><span style='color:#ffffff; background:#808000; '>fix in lfinfo)</span><span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Console.WriteLine("\t+ [{0}][{1}]", </span><span style='color:#ffffff; background:#808000; '>fix.sFixName, fix.sUrl);</span><span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Console.WriteLine();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;static public bool SendEmail(string sSubject, string sMessage)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;try</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;// create mail message object</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;MailMessage mail = new MailMessage();</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;SmtpClient smtp = new SmtpClient("smtp.sbcglobal.net");</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;mail.From = new MailAddress("</span><span style='color:#7144c4; '>xml3-daemon@opswat.com</span><span style='color:#595979; '>");</span>
<span style='color:#595979; '></span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;foreach (string sEmail in Configuration.lEmailAddress)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;mail.To.Add(sEmail);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;mail.Subject = sSubject;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;mail.Body = sMessage;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;smtp.Send(mail);</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;catch (Exception e)</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;{</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return false;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;return true;</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;}</span>
<span style='color:#595979; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;* */</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>bool</span> ExecuteShellCommand<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> sExe<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>try</span>
            <span style='color:#406080; '>{</span>
                <span style='color:#200080; font-weight:bold; '>var</span> p <span style='color:#308080; '>=</span> Process<span style='color:#308080; '>.</span>Start<span style='color:#308080; '>(</span>sExe<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                p<span style='color:#308080; '>.</span>WaitForExit<span style='color:#308080; '>(</span><span style='color:#008c00; '>10000</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>

                <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>true</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>catch</span> <span style='color:#406080; '>{</span> <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> <span style='color:#200080; font-weight:bold; '>false</span><span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> ExtractEmails<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> str<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> RegexPattern <span style='color:#308080; '>=</span> <span style='color:#800000; '>@"</span><span style='color:#1060b6; '>\b[A-Z0-9._-]+@[A-Z0-9][A-Z0-9.-]{0,61}[A-Z0-9]\.[A-Z.]{2,6}\b</span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> matches <span style='color:#308080; '>=</span> Regex<span style='color:#308080; '>.</span>Matches<span style='color:#308080; '>(</span>str<span style='color:#308080; '>,</span> RegexPattern<span style='color:#308080; '>,</span> RegexOptions<span style='color:#308080; '>.</span>IgnoreCase<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> MatchList <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span>matches<span style='color:#308080; '>.</span>Count<span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>int</span> c <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>Match match <span style='color:#200080; font-weight:bold; '>in</span> matches<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                MatchList<span style='color:#308080; '>[</span>c<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> match<span style='color:#308080; '>.</span>ToString<span style='color:#308080; '>(</span><span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
                c<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> MatchList<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>

        <span style='color:#200080; font-weight:bold; '>static</span> <span style='color:#200080; font-weight:bold; '>public</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> ExtractURLs<span style='color:#308080; '>(</span><span style='color:#200080; font-weight:bold; '>string</span> str<span style='color:#308080; '>)</span>
        <span style='color:#406080; '>{</span>
            <span style='color:#200080; font-weight:bold; '>string</span> RegexPattern <span style='color:#308080; '>=</span> <span style='color:#800000; '>@"</span><span style='color:#1060b6; '>&lt;a.*?href=[</span><span style='color:#0f69ff; '>""</span><span style='color:#1060b6; '>'](?&lt;url>.*?)[</span><span style='color:#0f69ff; '>""</span><span style='color:#1060b6; '>'].*?>(?&lt;name>.*?)&lt;/a></span><span style='color:#800000; '>"</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>var</span> matches <span style='color:#308080; '>=</span> Regex<span style='color:#308080; '>.</span>Matches<span style='color:#308080; '>(</span>str<span style='color:#308080; '>,</span> RegexPattern<span style='color:#308080; '>,</span> RegexOptions<span style='color:#308080; '>.</span>IgnoreCase<span style='color:#308080; '>)</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span><span style='color:#308080; '>]</span> MatchList <span style='color:#308080; '>=</span> <span style='color:#200080; font-weight:bold; '>new</span> <span style='color:#200080; font-weight:bold; '>string</span><span style='color:#308080; '>[</span>matches<span style='color:#308080; '>.</span>Count<span style='color:#308080; '>]</span><span style='color:#406080; '>;</span>

            <span style='color:#200080; font-weight:bold; '>int</span> c <span style='color:#308080; '>=</span> <span style='color:#008c00; '>0</span><span style='color:#406080; '>;</span>
            <span style='color:#200080; font-weight:bold; '>foreach</span> <span style='color:#308080; '>(</span>Match match <span style='color:#200080; font-weight:bold; '>in</span> matches<span style='color:#308080; '>)</span>
            <span style='color:#406080; '>{</span>
                MatchList<span style='color:#308080; '>[</span>c<span style='color:#308080; '>]</span> <span style='color:#308080; '>=</span> match<span style='color:#308080; '>.</span>Groups<span style='color:#308080; '>[</span><span style='color:#800000; '>"</span><span style='color:#1060b6; '>url</span><span style='color:#800000; '>"</span><span style='color:#308080; '>]</span><span style='color:#308080; '>.</span>Value<span style='color:#406080; '>;</span>
                c<span style='color:#308080; '>+</span><span style='color:#308080; '>+</span><span style='color:#406080; '>;</span>
            <span style='color:#406080; '>}</span>
            <span style='color:#200080; font-weight:bold; '>return</span> MatchList<span style='color:#406080; '>;</span>
        <span style='color:#406080; '>}</span>
    <span style='color:#406080; '>}</span>
<span style='color:#406080; '>}</span>
</pre>
<!--Created using ToHtml.com on 2021-06-30 07:03:18 UTC -->